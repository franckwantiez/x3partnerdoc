<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="fr-fr" xml:lang="fr-fr" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" xmlns="http://www.w3.org/1999/xhtml" />
        <meta name="author" content="ADONIX" xmlns="http://www.w3.org/1999/xhtml" />
        <meta name="keywords" content="" xmlns="http://www.w3.org/1999/xhtml" />
        <meta name="description" content="Librairie AJAX" xmlns="http://www.w3.org/1999/xhtml" />
        <meta name="module" content="Superviseur" xmlns="http://www.w3.org/1999/xhtml" />
        <meta name="robots" content="all" xmlns="http://www.w3.org/1999/xhtml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title>Librairie AJAX</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Retour" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Passer au contenu principal</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Afficher le volet de navigation" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Champ de recherche" placeholder="Rechercher" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filtrer&#160;:</span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Filtre de recherche" title="Tous les fichiers" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">Tous les fichiers</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Rechercher" role="button" tabindex="0"><span class="invisible-label">Démarrer la recherche</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Changer de langue">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Changer de langue">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <div id="container" xmlns="http://www.w3.org/1999/xhtml">
                                                    <div id="pageHeader">
                                                        <h1 class="g1" id="LibrairieAJAX" data-magellan-target="LibrairieAJAX"><span>Librairie AJAX</span>
                                                        </h1>
                                                    </div>
                                                    <div id="supportingText">
                                                        <div class="stdBloc"><a id="MIS_20_10"></a>
                                                            <h2 class="g1" id="Introduction" data-magellan-target="Introduction">Introduction</h2>
                                                            <p>La librairie AJAX est basée sur <b>prototype.js.</b></p>
                                                            <p>Elle est constituée des fichiers suivants qui sont chargés automatiquement dans le navigateur via le token <span style="font-family: 'Courier new';"><b>&lt;script adx="ALIBJS"&gt;&lt;/script&gt;</b></span>:</p>
                                                            <h5>prototype.js</h5>
                                                            <p>Librairie prototype version 1.6.0.3</p>
                                                            <h5>XtendAjax.js</h5>
                                                            <p>Gestion des requêtes AJAX à destination du serveur XTEND</p>
                                                            <h5>XtendAjaxFlash.js</h5>
                                                            <p>Gestion des requêtes AJAX pour les composants FLASH X3</p>
                                                            <h5>XtendAjaxMsgs.js</h5>
                                                            <p>Gestion des requêtes AJAX pour l'affichage des messages utilisateur dans le navigateur</p>
                                                            <p>Via la fonction JavaScript <span style="font-family: 'Courier new';">xtdAlert(messId,p1,P2,P3,P4)</span></p>
                                                            <h5>XtendAjaxScripts.js</h5>
                                                            <p>Gestion des requêtes AJAX pour l'appel des scripts serveur</p>
                                                            <h5>XtendAjaxWsvc.js</h5>
                                                            <p>Gestion des requêtes AJAX pour l'appel des interfaces XTEND (web services X3)</p>
                                                            <h5>XtendAjaxDom.js</h5>
                                                            <p>Utilitaire pour la gestion d'un DOM XML</p>
                                                            <h5>XtendAjaxUtils.js</h5>
                                                            <p>Utilitaires divers</p>
                                                        </div>
                                                        <div class="stdBloc"><a id="MIS_30_10"></a>
                                                            <h2 class="g1" id="XTENDAJAXrequest" data-magellan-target="XTENDAJAXrequest">XTENDAJAX.request</h2>
                                                            <p />
                                                            <h4>Principe</h4>
                                                            <p>L'appel de requête AJAX est asynchrone ce qui signifie qu'après envoi de la requête HTTP vers le serveur le programme appelant n'obtient pas de réponse du serveur.</p>
                                                            <p>La réponse arrive au bout d'un 'certain temps' dont on n'a pas la maitrise.</p>
                                                            <p>C'est seulement lorsque l'objet HTTPREQUEST reçoit la réponse qu'il appelle une fonction JavaScript CallBack pour traiter le résultat.</p>
                                                            <p>En standard la fonction CallBack ne contient que la réponse HTTP comme paramètre et ne permet pas de retrouver le contexte d'appel de la requête.</p>
                                                            <p>La classe <b>XTENDAJAX.request</b> de la librairie <b>XtendAjax.js</b> surcharge la classe <b>Ajax.Request</b> de la librairie prototype dans le but d'en faciliter l'utilisation et de permettre un accès au contexte d'appel dans la fonction CallBack.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDAJAX.request=Class.create(Ajax.Request,{<br />&#160;&#160;&#160; <b>initialize</b>: function(<b>aCaller</b>,<b>url</b>,<b>aContentType</b>,<b>aReturnedType</b>,<b>params</b>)<br />&#160;&#160;&#160; {&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Traitement spécifique <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Appel de la requete Ajax de prototype.js<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $super(url,options);<br />&#160;&#160;&#160; },</span>
                                                            </p>
                                                            <h5>aCaller</h5>
                                                            <p>Objet appelant (voir § suivant)</p>
                                                            <h5>url</h5>
                                                            <p>Url d'appel du web service REST XTEND</p>
                                                            <h5>aContentType</h5>
                                                            <p>ContentType des données envoyées - null autorisé</p>
                                                            <ul>
                                                                <li>application/xml<br />-&gt; params contient une String XML</li>
                                                                <li>application/json<br />-&gt; params contient une String JSON</li>
                                                                <li>application/x-www-form-urlencoded<br />-&gt; params contient un Hash ($H prototype.js)</li>
                                                            </ul>
                                                            <h5>aReturnedType</h5>
                                                            <p>ContentType des données retournées - null autorisé</p>
                                                            <h5>params</h5>
                                                            <p>Données envoyées dans le corps de la requête - null autorisé</p>
                                                            <p><b>Toutes les classes et fonctions sont rattachée à l'objet XTENDAJAX.</b>
                                                            </p>
                                                            <h4>Objet appelant</h4>
                                                            <p>C'est l'objet qui appelle la requête et qui gère le contexte d'appel dont on aura besoin pour traiter la réponse.</p>
                                                            <p>Cet objet doit implémenter les méthodes suivantes pour traiter les différents états de la réponse:</p>
                                                            <p><span style="font-family: 'Courier new';">&#160;&#160;&#160; //------------------------------------------------<br />&#160;&#160;&#160; //Appel si HTTP statut est égal = 200<br />&#160;&#160;&#160; //response : Classe Ajax.Response<br />&#160;&#160;&#160; <b>onSuccess</b>:function(response){<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; },<br />&#160;&#160;&#160; //------------------------------------------------<br />&#160;&#160;&#160; //Appel si HTTP status est différent de 200<br />&#160;&#160;&#160; //request&#160;&#160; : Classe Ajax.Request<br />&#160;&#160;&#160; //exception : String ou&#160; classe Error<br />&#160;&#160;&#160; <b>onFailure</b>:function(request, exception){<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; },<br />&#160;&#160;&#160; //------------------------------------------------<br />&#160;&#160;&#160; //Appel sur exception JavaScript<br />&#160;&#160;&#160; //request&#160;&#160; : Classe Ajax.Request<br />&#160;&#160;&#160; <b>onException</b> :function(response,headerJSON){<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; }</span>
                                                            </p>
                                                            <p>Les fonction <b>onFailure</b> et <b>onException</b> sont facultatives.</p>
                                                            <p>Si l'objet appelant ne les implémente pas les fonctions d'affichage <b>XTENDAJAX.displayException</b> et <b>XTENDAJAX.displayFailure</b> seront appelées.</p>
                                                            <h5>Exemple</h5>
                                                            <p>L'exemple ci-dessous appel le web service REST identifié par le paramètre aURL avec les données aData et affiche la réponse.</p>
                                                            <p><span style="font-family: 'Courier new';">var wClassCaller=Class.create({<br />&#160;&#160;&#160; <b>onSuccess</b>:function(response){<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; response.xtdDisplay();<br />&#160;&#160;&#160; },<br />&#160;&#160;&#160; <b>call</b>:function(aURL,aData){<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; new XTENDAJAX.request(this,aURL,null,null,aData);<br />&#160;&#160;&#160; }<br />});<br />var wURL="http://ecfdalbopro:28980/xtend/ajax/SOLPAIE/PAIE/FDBTEST/INT/XTDLOGIN";<br />var wInput={<br />&#160;&#160;&#160; _JSONOPT:{OPTIONS:"nogroups"},<br />&#160;&#160;&#160; AXUSERCODE:"DIS001",<br />&#160;&#160;&#160; AXPWD:"adonix"<br />};<br />new wClassCaller().call(wURL,wInput);</span>
                                                            </p>
                                                            <p>Dans la pratique on utilise les classe de la classe <span style="font-family: 'Courier new';"><b>XTENDWSVC.classCallerSpg</b></span> de la librairie <span style="font-family: 'Courier new';"><b>XtendAjaxWsvc.js</b></span> qui facilitent le calcul de l'url et la manipulation des données.</p>
                                                            <h4>Objet 'response'</h4>
                                                            <p>Le paramètre <b>response</b> est instancié à partir de la classe <span style="font-family: 'Courier new';">Ajax.response</span> auquel on a ajouté les méthodes spécifiques pour manipuler la réponse du serveur XTEND (<span style="font-family: 'Courier new';">XTENDAJAX.xtdExtendResponse</span>).</p>
                                                            <p><span style="font-family: 'Courier new';">{<br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // Affiche le contenu de la réponse au format texte (XTENDAJAX.msgBox)<br />&#160;&#160;&#160; <b>xtdDisplay</b>:function(),<br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // Tableau qui contient les messages d'erreur<br />&#160;&#160;&#160;<b> xtdMsgErr:,</b><br />&#160;&#160;&#160; // Renvoie true si la réponse comporte une erreur applicative X3<br />&#160;&#160;&#160;<b> xtdHasX3Error</b>:function(),<br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // Tableau qui contient les messages warning<br />&#160;&#160;&#160; <b>xtdMsgWarning:,</b><br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // Tableau qui contient les messages d'information<br />&#160;&#160;&#160; <b>xtdMsgInfo:,</b><br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // Tableau qui contient tous les messages<br />&#160;&#160;&#160; <b>xtdMsgAll:,</b><br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // ContenType de la réponse<br />&#160;&#160;&#160; <b>xtdContentType:,</b><br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // True si ContentType=text/plain<br />&#160;&#160;&#160; <b>xtdIsText</b>:function()<b>,</b><br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // True si ContentType=text/html<br />&#160;&#160;&#160;<b> xtdIsHtml</b>:function(),<br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // True si ContentType=application/xml<br />&#160;&#160;<b>&#160; xtdIsXml</b>:function(),<br />&#160;&#160;&#160; //-------------------------------------------------<br />&#160;&#160;&#160; // True si ContentType=application/json<br />&#160;&#160;<b>&#160; xtdIsJson:</b>function(),<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; /*------------------ Réponse XML ------------------*/<br />&#160;&#160;&#160; //Evalue la réponse et renvoie un DOM XML (voir XtendAjaxDom.js)<br />&#160;&#160;&#160; <b>xtdEvalXML,</b><br />&#160;&#160;&#160; //Contient le DOM XML créé par xtdEvalXML<br />&#160;&#160;&#160; <b>xtdResponseXML:,</b><br />&#160;&#160;&#160; <br />&#160;&#160;&#160; /*------------------ Réponse JSON------------------*/<br />&#160;&#160;&#160; //Evalue la réponse et renvoie un objet JSON qui représente la réponse<br />&#160;&#160;&#160; <b>xtdEvalJSON</b>:function(),<br />&#160;&#160;&#160; //Contient l'objet JSON créé par xtdEvalJSON<br />&#160;&#160;&#160; <b>xtdResponseJSON:,</b><br />&#160;&#160;&#160; //Renvoie un Hash ($H) créé à partir d'un tableau de clés et de valeurs<br />&#160;&#160;&#160; <b>xtdHash</b>:function(aKeyArray,aValArray),<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; /*------- Réponse WEB SERVICE SOUS-PROGRAMME -------*/<br />&#160;&#160;&#160; //Evalue la réponse à un sous-programme<br />&#160;&#160;&#160; //-&gt; Ajoute les méthodes spécifiques<br />&#160;&#160;&#160; <b>xtdEvalJSONSpg</b>:function(),<br />&#160;&#160;&#160; //Renvoie la valeur du paramètre AXPAR<br />&#160;&#160;&#160; <b>AXPAR</b>:function(aCode),<br />&#160;&#160;&#160; //Renvoie la valeur du paramètre AXPAR comme un entier<br />&#160;&#160;&#160; <b>AXPARInt</b>:function(aCode,aDefValue),<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; /*------ Réponse SOUS-PROGRAMME ACCES DONNEES -------*/&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; //Evalue la réponse à un web service sous-programme accès données<br />&#160;&#160;&#160; //-&gt; Ajoute les méthodes spécifiques<br />&#160;&#160;&#160; <b>xtdEvalJSONSpgAccess</b>:function(),<br />&#160;&#160;&#160; //Nombre de records demandés<br />&#160;&#160;&#160; <b>askedRecords</b>:function(),<br />&#160;&#160;&#160; //Nombre total de records<br />&#160;&#160;&#160; <b>totalRecords</b>:function(),<br />&#160;&#160;&#160; //Nombre records renvoyés<br />&#160;&#160;&#160; <b>returnedRecords</b>:function(),<br />&#160;&#160;&#160; //Rang (1-N) du premier record<br />&#160;&#160;&#160; <b>startRank</b>:function(),<br />&#160;&#160;&#160; //True si il existe des records suivants - False si pagination terminée<br />&#160;&#160;&#160; <b>hasNext</b>:function(),<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; /*--------- Réponse WEB SERVICE OBJET X3 ----------*/<br />&#160;&#160;&#160; //Evalue la réponse à un web service objet X3<br />&#160;&#160;&#160; //-&gt; Ajoute les méthodes spécifiques<br />&#160;&#160;&#160; <b>xtdEvalJSONObject</b>:function(),<br />&#160;&#160;&#160; //Groupe technique ADXTEC<br />&#160;&#160;&#160; <b>adxADXTEC</b>:function(aField),<br />&#160;&#160;&#160; //Timestamp de l'objet X3<br />&#160;&#160;&#160; <b>adxTimeStamp</b>:function(),<br />&#160;&#160;&#160; //UserCode X3 qui a modifié l'objet en dernier<br />&#160;&#160;&#160; <b>adxUser</b>:function(),<br />}</span>
                                                            </p>
                                                        </div>
                                                        <div class="stdBloc"><a id="MIS_40_10"></a>
                                                            <h2 class="g1" id="Webservicesinterface" data-magellan-target="Webservicesinterface">Web services interface</h2>
                                                            <p />
                                                            <h4>Introduction</h4>
                                                            <p>La librairie <b>XtendAjaxWsvc.js</b> met à disposition du développeur un ensemble de classe pour faciliter l'appel des <a href="GESAY_ADV_REST.htm">web services REST</a> d'XTEND de type <a href="GESAYI.htm">interface</a>.</p>
                                                            <p style="MARGIN: 0cm 0cm 0pt;"><span style="COLOR: black;">La requête AJAX déclenche l'exécution d'un web service identifié par la fiche interface et traite directement le résultat. Le serveur XTEND ne fait qu'appeler le <a href="GESAY_GEN_WSVC.htm">web service X3</a> et renvoyer la réponse.</span>
                                                            </p>
                                                            <p>Toutes les classes et fonctions sont rattachée à l'objet <b>XTENDWSVC</b></p>
                                                            <h4>Utilitaires</h4>
                                                            <p><span style="font-family: 'Courier new';">/*----------------- TESTS -----------------*/<br />//Appel l'interface aInterfaceId avec les données aXmlData<br />// Affiche le résultat<br /><b>testSpgXML:</b>function(aInterfaceId,aXmlData),<br />//---------------------------------------------<br />//Appel l'interface aInterfaceId avec les données aJSONData<br />// Affiche le résultat<br /><b>testSpgJSON:</b>function(aInterfaceId,aJSONData),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*----------------- CALL STATIQUE -----------------*/<br />//Appel l'interface sous-programme aInterfaceId avec les données aData<br />//Les fonctions CallBack statiques sont passées en paramètre <br /><b>runSpg</b>:function(aInterfaceId,aData,onSuccess,onFailure),<br />//---------------------------------------------<br />//Idem runSpg avec des données JSON en retour<br /><b>runSpgJSON</b>:function(aInterfaceId,aData,onSuccess,onFailure),<br />//---------------------------------------------<br />//Idem runSpg avec des données XML en retour<br /><b>runSpgXML</b>:function(aInterfaceId,aData,onSuccess,onFailure),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*----------------- PARAMETRES D'APPEL -----------------*/<br />//Renvoie un objet paramètre de base XTENDWSVC.classParam<br />//aJSONOptions : options JSON (facultatif)<br /><b>newParam</b>:function (aJSONOptions),<br />//---------------------------------------------<br />//Renvoie un objet paramètre pour l'appel d'un web service objet X3<br />//Classe XTENDWSVC.newParamXtdObject<br />//aTimeStampX3 : le timestamp X3 de l'objet (facultatif)<br /><b>newParamXtdObject</b>:function (aTimeStampX3,aJSONOptions),<br />//---------------------------------------------<br />//Renvoie un objet paramètre pour l'appel d'un web service sous-programme<br />//Classe XTENDWSVC.classParamXtdSpg<br /><b>newParamXtdSpg</b>:function (aJSONOptions),<br />//---------------------------------------------<br />//Renvoie un objet paramètre pour l'appel d'un sous-programme 'accès données'<br />//Classe XTENDWSVC.classParamXtdSpgAccess<br />//aNbLines : nombre maximum de records demandés<br />//aStartAt : rang du 1er record<br /><b>newParamXtdSpgAccess</b>:function (aNbLines,aStartAt,aJSONOptions),<br />//---------------------------------------------<br />//Renvoie un objet paramètre pour l'appel d'une liste gauche objet X3<br />//Classe Hash (tableau clé/valeur)<br />//aNbLinesReturned : nombre lignes demandés<br /><b>newParamQuery</b>:function(aNbLinesReturned,aJSONOPtions),<br />//---------------------------------------------<br />//Renvoie un objet paramètre de type clé<br />//Classe Hash (tableau clé/valeur)<br /><b>newParamRead</b>:function(aJSONOPtions),<br />//---------------------------------------------<br />//Vérifie que aHash est bien un paramètre pour un query<br />//Présence de la clé "_COUNT" qui contient le nombre de lignes demandées<br /><b>checkQueryParam</b>:function(aHash,aReturnedCount),</span>
                                                            </p>
                                                            <h4>Classes paramètres</h4>
                                                            <h5>XTENDWSVC.classParam</h5>
                                                            <p>Classe de base des paramètres.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classParam=Class.create({<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //aJSONOptions : Options JSON <br />&#160;&#160;&#160; <b>initialize</b>: function(aJSONOptions),<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //Renvoie les options JSON<br />&#160;&#160;&#160; <b>options</b>:function(),<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //Ajoute un paramètre aCode avec la valeur aCode<br />&#160;&#160;&#160; <b>add</b>:function(aCode,aValue),<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //Renvoie la valeur du paramètre aCode<br />&#160;&#160;&#160; <b>get</b>:function(aCode)<br />)}</span>
                                                            </p>
                                                            <h5>XTENDWSVC.classParamXtdSpg</h5>
                                                            <p>Classe de paramètre d'appel d'un web service sous-programme qui hérite de XTENDWSVC.classParam.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classParamXtdSpg=Class.create(XTENDWSVC.classParam,{<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //aJSONOptions : Options JSON <br />&#160;&#160;&#160; <b>initialize</b>: function(OptionsJSON),<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //Ajout d'un parametre AXPAR<br />&#160;&#160;&#160; <b>addAXPAR</b>:function(aCode,aValue)&#160;&#160;&#160;&#160; <br />});</span>
                                                            </p>
                                                            <h5>XTENDWSVC.classParamXtdSpgAccess</h5>
                                                            <p>Classe de paramètre d'appel d'un web service sous-programme de type 'Accès données' qui hérite de XTENDWSVC.classParamXtdSpgAccess.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classParamXtdSpgAccess=Class.create(XTENDWSVC.classParamXtdSpg,{<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //aJSONOptions : Options JSON<br />&#160;&#160;&#160; //aNbLines : nombre maximum de records demandés<br />&#160;&#160;&#160; //aStartAt : rang du 1er record<br />&#160;&#160;&#160; //Met à jour les paramètres '$REC_STARTAT','$TOTAL_COUNT','$RET_COUNT','$HAS_NEXT'<br />&#160;&#160;&#160; <b>initialize</b>: function(aNbLines,aStartAt,aJSONOptions),<br />});</span>
                                                            </p>
                                                            <h5>XTENDWSVC.classParamObject</h5>
                                                            <p>Classe de paramètre d'appel d'un web service objet X3 qui hérite de XTENDWSVC.classParam.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classParamObject=Class.create(XTENDWSVC.classParam,{<br />&#160;&#160;&#160; /---------------------------------------<br />&#160;&#160;&#160; //aJSONOptions : Options JSON<br />&#160;&#160;&#160; //aTimeStampX3 : String - TimeStamp de l'objet X3 (peut être null ou vide)<br />&#160;&#160;&#160; //Ajoute le paramètre WW_MODSTAMP dans le groupe ADXTEC avec la valeur&#160; aTimeStamp<br />&#160;&#160;&#160; <b>initialize</b>: function(aTimeStampX3,aJSONOptions),<br />});</span>
                                                            </p>
                                                            <h4>Classe XTENDWSVC.classJsonOpt</h4>
                                                            <p>Classe qui représente les options JSON.</p>
                                                            <p><span style="font-family: 'Courier new';">//---------------------------------------<br />//Active l'option noGroups<br /><b>noGroups</b>:function(),<br />//---------------------------------------<br />//Active l'option noRows<br /><b>noRows</b>:function(),<br />//---------------------------------------<br />//Active l'option noLabels<br /><b>noLabels</b>:function(),<br />//---------------------------------------<br />//Active l'option noClobs<br /><b>noClobs</b>:function(),<br />/---------------------------------------<br />//Met à jour la liste des groupes à exclure<br />//aValue : String or Array of string<br /><b>excludeGrp</b>:function(aValue),<br />//---------------------------------------<br />//Met à jour la liste des groupes à inclure<br /><b>includeGrp</b>:function(aValue),<br />//---------------------------------------<br />//Met à jour la liste des champs à exclure<br /><b>excludeFld</b>:function(aValue),<br />//---------------------------------------<br />//Met à jour la liste des champs à inclure<br /><b>includeFld</b>:function(aValue),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*------------- EXEMPLE -------------*/<br />var wOpts=new XTENDWSVC.classJsonOpt().noGroups().includeFld(["SOHNUM""ITMREF","QTY"]);</span>
                                                            </p>
                                                            <h4>Classe XTENDWSVC.classCaller</h4>
                                                            <p>Il s'agit de la classe de base utilisée pour appeler un web service REST.</p>
                                                            <p><b>Par défaut cette classe ne permet pas de poster plusieurs requête simultanément et bloque les tentative d'appels multiples.</b>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*---------------- METHODES PRINCIPALES ----------------*/<br />//Constructeur<br />//aInterfaceId : ID de l'interface XTEND<br />//Facultatif&#160;&#160; : on peut passer les&#160; fonctions CallBack statiques en paramètre<br />//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; si non implémentée dans la classe<br />//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; -&gt; aInterfaceId,onSuccess,onFailure,onException<br /><b>initialize</b>:function(aInterfaceId),<br />//-------------------------------------------------------<br />//Vérifie si appel en cours et déclenche l'envoi de la requête<br />//aUrl&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Url du service<br />//aData&#160;&#160;&#160;&#160;&#160;&#160; : Données<br />//aContenType : ContentType<br /><b>exec</b>:function(aUrl,aData ,aContenType), </span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*-------- METHODE CALLBACK A SURCHARGER OBLIGATOIREMENT ----------*/<br />// HTTP STATUS=200<br />// !! La méthode filles doit appeler $super(response) pour positionner <br />//&#160;&#160;&#160; l'indicateur d'appel à false<br /><b>onSuccess</b>:function(response),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*--------- METHODE CALLBACK A SURCHARGER EVENTUELLEMENT ----------*/<br />// EXCEPTION JAVASCRIPT<br />//Par défaut cette méthode affiche l'exception<br />// !! La méthode filles doit appeler $super(request,exception,true) <br />//&#160;&#160;&#160; pour positionner l'indicateur d'appel&#160; à false sans afficher le résultat<br /><b>onException</b>:function(request,exception,aIsOverriden),<br />//-------------------------------------------------------<br />// HTTP STATUS!=200<br />//Par défaut cette méthode affiche la cause de l'erreur<br />// !! La méthode filles doit appeler $super(request,headerJSON,true) <br />//&#160;&#160;&#160; pour positionner l'indicateur d'appel à false sans afficher le résultat<br /><b>onFailure</b>:function(response,headerJSON,aIsOverriden),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*--------------------- FORMATS --------------------*/<br />//Fixe application/json comme type de données en retour<br />//Type par défaut<br /><b>setReturnJSON</b>:function(),<br />//-------------------------------------------------------<br />//Fixe application/xml comme type de données en retour<br /><b>setReturnXML</b>:function(),<br />//-------------------------------------------------------<br />//True si données XML en retour<br /><b>returnXML</b>:function(),<br />//-------------------------------------------------------<br />//True si données JSON en retour<br /><b>returnJSON</b>:function(),</span>
                                                            </p>
                                                            <p>
                                                                <br /><span style="font-family: 'Courier new';">/*--------------------- DIVERS ---------------------*/<br />//poste effectivement la requête vers le serveur si pas d'appel en cours<br /><b>sendRequest</b>:function(aUrl,aDataObject,aContenType)<br />//-------------------------------------------------------<br />//Renvoie l'id de l'interface<br /><b>getId</b>:function(),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*------------- GESTION APPELS MULTIPLES -------------*/<br />//A surcharger si on veut débloquer les appels multiples<br />//aBusy : True si appel en cours<br />//Renvoie true pour autoriser l'appel du web service<br /><b>doSendRequest</b>:function(aBusy),<br />//-------------------------------------------------------<br />//Met à jour l'indicateur d'occupation<br /><b>setBusy</b>:function(aYes),<br />//-------------------------------------------------------<br />//True si appel en cours<br />isBusy:function(),</span>
                                                            </p>
                                                            <h4>Classe XTENDWSVC.classCallerSpg</h4>
                                                            <p>Il s'agit de la classe de base utilisée pour appeler un web service REST sous-programme.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classCallerSpg=Class.create(XTENDWSVC.classCaller,{<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Constructeur<br />&#160;&#160;&#160; <b>initialize</b>:function(aInterfaceId),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Exécute la requête avec les données aData<br />&#160;&#160;&#160; //Valeur autorisée pour aData<br />&#160;&#160;&#160; // -null ou undefined -&gt; this.exec()<br />&#160;&#160;&#160; // -String -&gt; this.exec(aString,'text/plain') <br />&#160;&#160;&#160; // -Hash&#160;&#160; -&gt; this.runFORMENCODED(aData) <br />&#160;&#160;&#160; // -Autre&#160; -&gt; this.runJSON(Object.toJSON(aData)) <br />&#160;&#160;&#160; <b>run</b>:function(aData), <br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Exécute la requête avec les données XML aXML<br />&#160;&#160;&#160; <b>runXML</b>:function(aXML),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Exécute la requête avec les données JSON aJSON<br />&#160;&#160;&#160; // JSON : String JSON ou objet JavaScript (classe paramètre)<br />&#160;&#160;&#160; <b>runJSON</b>:function(aJSON),&#160;&#160;&#160; <br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Exécute la requête avec le tableau de clés/valeurs aHash<br />&#160;&#160;&#160; //aHash représente le contenu d'un formulaire &lt;form&gt;<br />&#160;&#160;&#160; <b>runFORMENCODED</b>:function(aHash),<br />});</span>
                                                            </p>
                                                            <h5>Exemple</h5>
                                                            <p>L'exemple ci-dessous appel l'interface XTDLOGIN du site courant et affiche la réponse.</p>
                                                            <p><b>Call Sous-Programme</b> </p>
                                                            <p><span style="font-family: 'Courier new';">var wClassCaller=Class.create(XTENDWSVC.classCallerSpg,{<br />&#160;&#160; //Constructeur facultatif si pas dautres paramètres que aInterfaceId<br />&#160;&#160; <b>initialize</b>:function($super,aInterfaceId){<br />&#160;&#160;&#160;&#160;&#160; $super(aInterfaceId);<br />&#160;&#160; },<br />&#160;&#160; //Méthode obligatoire pour traiter la réponse<br />&#160;&#160; <b>onSuccess</b>:function(response){<br />&#160;&#160;&#160;&#160;&#160; response.xtdDisplay();<br />&#160;&#160; }<br />});<br />var wJSONOpts=new XTENDWSVC.classJsonOpt().noGroups();<br />var wParams=new XTENDWSVC.classParamXtdSpg(wJSONOpts);<br />wParams.add("AXUSERCODE","DIS001");<br />wParams.add("AXPWD","adonix");<br />new wClassCaller("XTDLOGIN").run(wParams);</span>
                                                            </p>
                                                            <p><b>Résultat</b>
                                                            </p>
                                                            <p>URL :<br /><span style="font-family: 'Courier new';">http://ecfdalbopro:28980/xtend/ajax/SOLPAIE/PAIE/FDBTEST/INT/XTDLOGIN</span></p>
                                                            <p>Content-Type :<br /><span style="font-family: 'Courier new';">application/json;charset=utf-8</span></p>
                                                            <p>X3 INFORMATION MESSAGES :<br /><span style="font-family: 'Courier new';">Vous êtes bien connectés avec le code utilisateur DIS001</span></p>
                                                            <p><span style="font-family: 'Courier new';">{<br />"AXUSERCODE":"DIS001",<br />"AXPWD":"adonix",<br />"AXUSERPROF":"B2B",<br />"AX3SOL":["SOLPAIE","X3V5","XTENDV2"],<br />"AX3FLDR":["PAIE","X3TESTV5","DEMOFRA"],<br />"AX3LANG":["FRA","FRA","FRA"],<br />"AX3USER":["XTEND","JPJ1","OG"],<br />"AX3PWD":["adonix","",""],<br />"AXLOGCOD":["NAME","FIRSTNAME","EMAIL","PHONE"],<br />"AXLOGVAL":["DAL BO","Frédéric","</span><span style="font-family: 'Courier new';">frdal@sage.com","00102030405</span><span style="font-family: 'Courier new';">"],<br />"SHIPADR1":["Sage Lyon new","Sage MGE","Sage PARIS"],<br />"SHIPCITY":["LYON","Echirolles","PARIS"],<br />"SHIPZIP":["69443","38130","75834"]<br />}</span>
                                                            </p>
                                                            <h4>Classe XTENDWSVC.classCallerObject</h4>
                                                            <p>Il s'agit de la classe de base utilisée pour appeler un web service REST objet X3.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDWSVC.classCallerObject=Class.create(XTENDWSVC.classCaller,{<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Constructeur<br />&#160;&#160;&#160; <b>initialize</b>:function(aInterfaceId),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Méthode save<br />&#160;&#160;&#160; //aData : Données au format JSON ou XML<br />&#160;&#160;&#160; <b>actCreate</b>:function(aData),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Méthode&#160; Read<br />&#160;&#160;&#160; //aHashKeys : Hash qui contient les clés de l'objet<br />&#160;&#160;&#160; <b>actRead</b>:function(aHashKeys),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Méthode&#160; Delete<br />&#160;&#160;&#160; //aHashKeys : Hash qui contient les clés de l'objet<br />&#160;&#160;&#160; <b>actDelete</b>:function(aHashKeys),&#160;&#160;<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Méthode&#160; Modify<br />&#160;&#160;&#160; //aHashKeys : Hash qui contient les clés de l'objet<br />&#160;&#160;&#160; //aData&#160;&#160;&#160;&#160; : Données au format JSON ou XML<br />&#160;&#160;&#160; <b>actUpdate</b>:function(aHashKeys,aData),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Action de code aCode<br />&#160;&#160;&#160; //aCode&#160;&#160;&#160;&#160; : Code de l'action<br />&#160;&#160;&#160; //aHashKeys : Hash qui contient les clés de l'objet<br />&#160;&#160;&#160; <b>actOtherKey</b>:function(aCode,aHashKeys),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Action de code aCode<br />&#160;&#160;&#160; //aCode&#160;&#160;&#160;&#160; : Code de l'action<br />&#160;&#160;&#160; //aData&#160;&#160;&#160;&#160; : Données au format JSON ou XML<br />&#160;&#160;&#160; <b>actOtherData</b>:function(aCode,aData),<br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Action query liste gauche<br />&#160;&#160;&#160; //aHashKeys&#160;&#160;&#160;&#160;&#160; : Hash qui contient les clés pour la sélection<br />&#160;&#160;&#160; //aReturnedCount : Optionnel - Nombre de lignes demandées<br />&#160;&#160;&#160; <b>actQuery</b>:function(aHashKeys,aReturnedCount),<br />});</span>
                                                            </p>
                                                            <h5>Exemple</h5>
                                                            <p>L'exemple ci-dessous appel l'interface objet X3 OBJAYZ (objet AYZ) du site courant en création et affiche la réponse.</p>
                                                            <p><b>Call Objet</b> </p>
                                                            <p><span style="font-family: 'Courier new';">var wClassCaller=Class.create(XTENDWSVC.classCallerObject,{<br />&#160; <b>onSuccess</b>:function(response){<br />&#160;&#160;&#160; response.xtdDisplay();<br />&#160; }<br />});<br />var wJSONOpts=new XTENDWSVC.classJsonOpt().noGroups();<br />var wParams=new XTENDWSVC.classParamObject(null,wJSONOpts);<br />wParams.add("TTL","Titre du formulaire");<br />wParams.add("MAICOD","</span><span style="font-family: 'Courier new';">frdal@sage.com</span><span style="font-family: 'Courier new';">");<br />wParams.add("CMT","Commentaire");<br />new wClassCaller("OBJAYZ").actCreate(wParams);</span>
                                                            </p>
                                                            <p><b>Résultat</b>
                                                            </p>
                                                            <p>URL :<br /><span style="font-family: 'Courier new';">http://ecfdalbopro:28980/xtend/ajax/SOLPAIE/PAIE/FDBTEST/INT/OBJAYZ/S</span></p>
                                                            <p>Content-Type :<br /><span style="font-family: 'Courier new';">application/json;charset=utf-8</span></p>
                                                            <p>X3 INFORMATION MESSAGES :<br /><span style="font-family: 'Courier new';">Formulaire créé</span></p>
                                                            <p><span style="font-family: 'Courier new';">{<br />"FRMCOD":"0902000005",<br />"FCYCOD":"FDBTEST",<br />"ZFCYCOD":"Site de test fdalbo",<br />"TYP":"OTH",<br />"ZTYP":"Divers",<br />"STATUT":"1",<br />"STATUT_LBL":"A traiter",<br />"TTL":"Titre du formulaire",<br />"MAICOD":"</span><span style="font-family: 'Courier new';">frdal@sage.com</span><span style="font-family: 'Courier new';">",<br />"CREDAT":"20090227",<br />"CREHEURE":"184431",<br />"CMT":"Commentaire",<br />"PARCOD":[],<br />"PARVAL":[],<br />"WW_MODSTAMP":"000000000000",<br />"WW_MODUSER":""<br />}</span>
                                                            </p>
                                                            <p /><span style="font-family: 'Courier New';"></span>
                                                        </div>
                                                        <div class="stdBloc"><a id="MIS_50_10"></a>
                                                            <h2 class="g1" id="Webservicesscript" data-magellan-target="Webservicesscript">Web services script</h2>
                                                            <p />
                                                            <h4>Introduction</h4>
                                                            <p>La librairie <b>XtendAjaxScripts.js</b> met à disposition du développeur un ensemble de classe pour faciliter l'appel des web services REST de type <a href="GESAY_ADV_SCRIPTING.htm">script serveur</a>.</p>
                                                            <p>Le script qui s'exécute sur le serveur XTEND accède au contexte de la session via l'interface <b>IXtdAjaxScriptContext</b>.</p>
                                                            <h4>Classe XTENDSCRIPTS.classCaller</h4>
                                                            <p>Il s'agit de la classe de base utilisée pour appeler un web service script serveur.</p>
                                                            <p>Cette classe fonctionne suivant le même principe que les web services interface mais les paramètres qui sont passés au script serveur sont libres.</p>
                                                            <p>Ils sont lus via la fonction <b>XTD_CTX.getHttpBody</b> et le contenu est interprété par le script lui même.</p>
                                                            <p>De même, le format de la réponse renvoyée est libre.</p>
                                                            <p>C'est la fonction print qui écrit directement les données (String) dans un buffer qui sera renvoyé vers le client.</p>
                                                            <p>La fonction <b>XTD_CTX.setHttpContenType</b> permet de gérer le ContentType de la réponse.</p>
                                                            <p>Par exemple, le script peut renvoyer du HTML qui sera inséré dynamiquement dans la page .</p>
                                                            <h5>Méthodes</h5>
                                                            <p><span style="font-family: 'Courier new';">/*---------------- METHODES PRINCIPALES ----------------*/<br />//Constructeur<br />//aScriptId : Chemin relatiif du scripts par rapport à la racine des scripts<br />//Facultatif&#160;&#160; : on peut passer les&#160; fonctions CallBack statiques en paramètre<br />//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; si non implémentée dans la classe<br />//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; -&gt; aScriptId,onSuccess,onFailure,onException<br /><b>initialize</b>:function(aScriptId), <br />//-------------------------------------------------------<br />//Exécute les script avec aParams comme paramètre<br />//Le contenu de aParams est libre est dépend du script appelé<br /><b>run</b>:function(aParams),&#160; </span>
                                                            </p>
                                                            <p>
                                                                <br /><span style="font-family: 'Courier new';">/*-------- METHODE CALLBACK A SURCHARGER OBLIGATOIREMENT ----------*/<br />// HTTP STATUS=200<br />// !! La méthode filles doit appeler $super(response) pour positionner <br />//&#160;&#160;&#160; l'indicateur d'appel à false<br /><b>onSuccess</b>:function(response),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*--------- METHODE CALLBACK A SURCHARGER EVENTUELLEMENT ----------*/<br />// EXCEPTION JAVASCRIPT<br />//Par défaut cette méthode affiche l'exception<br />// !! La méthode filles doit appeler $super(request,exception,true) <br />//&#160;&#160;&#160; pour positionner l'indicateur d'appel&#160; à false sans afficher le résultat<br /><b>onException</b>:function(request,exception,aIsOverriden),<br />//-------------------------------------------------------<br />// HTTP STATUS!=200<br />//Par défaut cette méthode affiche la cause de l'erreur<br />// !! La méthode filles doit appeler $super(request,headerJSON,true) <br />//&#160;&#160;&#160; pour positionner l'indicateur d'appel à false sans afficher le résultat<br /><b>onFailure</b>:function(response,headerJSON,aIsOverriden),</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">/*------------- GESTION APPELS MULTIPLES -------------*/<br />//A surcharger si on veut débloquer les appels multiples<br />//aBusy : True si appel en cours<br />//Renvoie true pour autoriser l'appel du web service<br /><b>doSendRequest</b>:function(aBusy),<br />//-------------------------------------------------------<br />//Met à jour l'indicateur d'occupation<br /><b>setBusy</b>:function(aYes),<br />//-------------------------------------------------------<br />//True si appel en cours<br /><i>isBusy</i>:function()</span>
                                                            </p>
                                                            <h4>Class XTENDSCRIPTS.classUpdater</h4>
                                                            <p>Cette classe permet de mettre à jour un élément du DOM HTML (div, span...) à réception de la réponse du web service si celui-ci renvoie une réponse<span style="font-family: 'Courier new';"> HTML text/html</span>.</p>
                                                            <p><span style="font-family: 'Courier new';">XTENDSCRIPTS.classUpdater=Class.create(XTENDSCRIPTS.classCaller,{</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; //Constructeur<br />&#160;&#160;&#160; //aScriptId&#160;&#160;&#160; : Path du script serveur<br />&#160;&#160;&#160; //aUpdateId&#160;&#160;&#160; : ID de l'element du DOM à'mettre à jour<br />&#160;&#160;&#160; //aClearBefore : True pour effacer le contenu de aUpdateId avant envoi de la requête<br />&#160;&#160;&#160; <b>initialize</b>: function(aScriptId,aUpdateId,aClearBefore),<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; //-------------------------------------------------------<br />&#160;&#160;&#160; // Exécute le script avec aParams comme paramètre<br />&#160;&#160;&#160; <b>run</b>:function(aParams),<br />});</span>&#160;&#160;&#160;&#160; </p>
                                                            <h5>Exemple</h5>
                                                            <p>Appel d'un script qui lit 2 paramètre P1 et P2 et renvoie le contenu des paramètres sous forme d'un contenu HTML.</p>
                                                            <p><b>Script</b>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//Include de la librairie utilitaires<br />#include "libs\xtdWsvc.js"</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//Lecture des données envoyées par le client<br />// -&gt; Dans cet exemple il s'agit de données JSON<br />// -&gt; String au format : {P1:"ValeurP1",P2:"ValeurP2"}<br />//La fonction Eval crée un objet JavaScrit à partir de la String <br />var wInput=eval('('+XTD_CTX.getHttpBody()+')');</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//Objet utilitaire pour construire la réponse HTML<br />var wHtml=new XTENDWSVC.classHTMLBuffer;</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//On renvoie un HTML qui contient les paramètres écrits en gras<br />wHtml.append("&lt;b&gt;P1=").append(wInput.P1).append("&lt;/b&gt;&lt;br&gt;");<br />wHtml.append("&lt;b&gt;P2=").append(wInput.P2).append("&lt;/b&gt;&lt;br&gt;");</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//Ecriture de la réponse<br />print(wHtml.html());</span>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">//Mise à jour du ContenType<br />XTD_CTX.setHttpContenType("text/html");</span>
                                                            </p>
                                                            <p><b>Appel à partir de la page HTML</b>
                                                            </p>
                                                            <p><span style="font-family: 'Courier new';">&lt;Script&gt;<br />&#160; function callAjaxScript(aP1,aP2){<br />&#160;&#160;&#160; //Paramètres<br />&#160;&#160;&#160; var wParams={P1:aP1,P2:aP2};<br />&#160;&#160;&#160; //ajaxTest3.js est le path du scripts<br />&#160;&#160;&#160; //idReponseScript est l'id de la div qui affiche le résultat HTML<br />&#160;&#160;&#160; //true pour effacer le contenu de la div avant appel du script<br />&#160;&#160;&#160; new XTENDSCRIPTS.classUpdater("ajaxTest3.js","idReponseScript",true).run(wParams);<br />&#160; }<br />&lt;/script&gt;<br />&lt;!--Bouton pour déclencher l'appel--&gt;<br />&lt;input type="button" value="callAjaxScript" onClick="javascript:callAjaxScript('Hello','world');"&gt;&lt;br&gt;<br />&lt;!--div pour afficher le résultat--&gt;<br />&lt;div id="idReponseScript"&gt;&lt;/div&gt;</span>
                                                            </p>
                                                            <p><b>Résultat de la réquête</b>
                                                            </p>
                                                            <p><b></b>
                                                            </p>
                                                            <p>
                                                                <img src="../Resources/Images/GESAY_ADV_AJAX_1.jpg" alt="GESAY_ADV_AJAX_1.jpg" keeps="true" realloc="GESAY_ADV_AJAX_1.jpg" />
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#LibrairieAJAX">Librairie AJAX</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Introduction">Introduction</a>
                                                        </li>
                                                        <li><a href="#XTENDAJAXrequest">XTENDAJAX.request</a>
                                                        </li>
                                                        <li><a href="#Webservicesinterface">Web services interface</a>
                                                        </li>
                                                        <li><a href="#Webservicesscript">Web services script</a>
                                                        </li>
                                                    </ul>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">23 janvier 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>