<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="fr-fr" xml:lang="fr-fr" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="How to crud 3 levels" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> How to crud 3 levels
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/TableStyles/NormalRows.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript">/*<![CDATA[*/


function onload(){
	window.focus();
	window[window.history.pushState ? "onpopstate" : "onhashchange"] = function(event){ windows.focus(); };
}


/*]]>*/</script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Retour" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Passer au contenu principal</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Afficher le volet de navigation" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Champ de recherche" placeholder="Rechercher" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filtrer&#160;:</span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Filtre de recherche" title="Tous les fichiers" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">Tous les fichiers</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Rechercher" role="button" tabindex="0"><span class="invisible-label">Démarrer la recherche</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Changer de langue">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Changer de langue">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="Howtocrud3levels" data-magellan-target="Howtocrud3levels"> How to crud 3 levels
</h1>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#requirements">Requirements</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#database">Database</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#classes">Classes created</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#representation">Representation</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#scripts">Scripts used</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2"><a href="#valdel">Validation and deletion</a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <p><strong>This example explains how to create a persistent entity based on a header, lines and sub-lines, and how to manage the CRUD related operations. <br />Some data types, which are references to other Sage X3 tables are used. <br />The naming rules are used for vertical elements (names starting with 'Y'). <br />A customized development made for a unique customer should be coded with 'Z'.</strong>
                                                </p>
                                                <h1 id="Descriptionofrequirements" data-magellan-target="Descriptionofrequirements"><a id="requirements">Description of requirements</a>
                                                </h1>
                                                <p>The following requirements need to be managed:</p>
                                                <ul>
                                                    <li>A specific sales order entity identified by a sales order number and including a customer, sales rep, date, and total.</li>
                                                    <li>Lines including an item reference and a price. The sequence in which the line appears in the sales order is important. It means that the user can insert lines between two existing lines.</li>
                                                    <li>Every line has a sub-detail including a unit, a quantity, and a unit price. The sequence of the sub-lines for a giving line is irrelevant.</li>
                                                </ul>
                                                <p>The unit price is entered at the sub-detail level, cumulated on the line, and finally at the header level. In the user interface, the user displays the cumulated price when a modification has been sent to the server. As it is done, the line price must not be modified; it is recomputed by cumulating the sub-lines.</p>
                                                <h1 id="Databasestructure" data-magellan-target="Databasestructure"><a id="database">Database structure</a>
                                                </h1>
                                                <p>The database structure used for the persistence of the entity is as follows:</p>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Table</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Description</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Column</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Data type</th>
                                                        <th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td rowspan="7" class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERH [YOH]</td>
                                                        <td rowspan="7" class="TableStyle-NormalRows-BodyE-Column1-Body1">Specific sales order</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">A 10 (character string)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Sales order number</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YBPC</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">BPC (customer code)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Order customer</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YREP</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">REP (sales rep code)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Order sales rep</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDDAT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Date</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Sales order date</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YTOTAL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">DCB 9.2(Decimal)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Total amount of the order</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YCUR</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">CUR (currency code)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Order currency</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YSTATUS</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Local menu (6520)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Order status</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td rowspan="5" class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDERLINE [YOD]</td>
                                                        <td rowspan="5" class="TableStyle-NormalRows-BodyE-Column1-Body2">Sales order detail</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOD (sales order reference)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Order number</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">C 4(short integer)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Line order number (for join)</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YSORT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">L 8(long integer)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Line order number (order in which the lines appear on the 
document)</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YITM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">ITM (item reference)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Ordered item</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">DCB 9.2 (decimal)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Line price</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td rowspan="6" class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERSUBLIN [YOL]</td>
                                                        <td rowspan="6" class="TableStyle-NormalRows-BodyE-Column1-Body1">Sales order line sub-detail</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD (line order reference)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Order number</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">C 4 (short integer)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Order Line number</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDSL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">C 4 (short integer)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Order sub-line number</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YUNIT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">UOM (unit of measure)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unit for quantity</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YQTY</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">QTY (quantity)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Sub-line quantity</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YUNITPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">DCB 9.2 (Decimal)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unit price for sub-line</td>
                                                    </tr>
                                                </table>
                                                <p>Every table also has the usual technical columns (CREDATTIM, UPDDATTIM, CREUSR, UPDUSR, AUUID).</p>
                                                <p>The indexes needed on the tables are as follows:</p>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Table</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Description</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Index</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Definition</th>
                                                        <th class="TableStyle-NormalRows-BodyD-Column1-Body2">Description</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td rowspan="4" class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERH [YOH]</td>
                                                        <td rowspan="4" class="TableStyle-NormalRows-BodyE-Column1-Body1">Specific sales order</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH0</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM (no duplicates)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Main index used to access the sales order by its reference</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH1</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YBPC+YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Index per customer</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH2</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YREP+YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Index per sales rep</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH1</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDDAT+YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Index per date</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERLINE [YOD]</td>
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body1">Sales order detail</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD0</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM+YORDL (no duplicates)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Main index used to access the sales order line</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH1</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDNUM+YSORT</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Index used to display lines in the right order</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERSUBLIN [YOL]</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Sales order sub-line</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD0</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM+YORDL+YORDSL (no duplicates)</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Main index used to access the sales order sub-line</td>
                                                    </tr>
                                                </table>
                                                <p>The local menu 6520 used has two values: Entered and Validated.</p>
                                                <h1 id="Descriptionofthecreatedclasses" data-magellan-target="Descriptionofthecreatedclasses"><a id="classes">Description of the created classes </a>
                                                </h1>
                                                <p>Three classes are needed:</p>
                                                <ul>
                                                    <li>'YORDERSUBLIN' is a basic class including all the columns of the 'YORDSUBLIN' table. A specific script called 'YORDSUBLIN_CSPE' contains the code that handles the event linked to the sub-lines.</li>
                                                    <li>'YORDERLINE' is a basic class including all columns of the 'YORDERLINE' table plus a property called 'YOL'. This property is a member of a collection called 'YOL' and is associated with the 'YORDERSUBLIN' class. A specific script called 'YORDERLINE_CSPE' contains the code that handles the event linked to the sub-lines. A method called 'YLINEPRICE' computes the price of a line by cumulating the quantity multiplied by unit price on all the sub-lines.</li>
                                                    <li>'YORDER' is a persistent class including all the columns of the 'YORDER' table plus a property called 'YOD'. This property is a member of a collection called 'YOD' and is associated with the 'YORDERLINE' class. A specific script called 'YORDER_CSPE' contains the code that handles the event linked to the sub-lines.</li>
                                                </ul>
                                                <p>The 'YORDER' persistent class also has the following characteristics:</p>
                                                <ul>
                                                    <li>The main index used is 'YOH0'.</li>
                                                    <li>All the CRUD methods are supported by the class. </li>
                                                    <li>A method called 'YTOTAMOUNT' has been added in the method tab.</li>
                                                </ul>
                                                <p>The <em>Mapping</em> tab includes the following join description grid:</p>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Reference</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Class</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Reference table</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Origin table</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Main index</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Sorting index</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Type</th>
                                                        <th class="TableStyle-NormalRows-BodyD-Column1-Body2">Join expression</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERLINE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDERLINE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDER</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD0</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOD1</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">1,n</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">[F:YOH]YORDNUM</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOD.YOL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDERSUBLIN</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDERSUBLIN</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDERLINE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOL0</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">1,n</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">[F:YOD]YORDNUM;[F:YOD]YORDL</td>
                                                    </tr>
                                                </table>
                                                <ul>
                                                    <li>Reading, Creation, Modification, and Deletion check boxes are selected for both detail lines in the <em>Mapping</em> tab. Because the child classes are <em>basic</em>, the CRUD code for these lines will be generated at 'YORDER' level.</li>
                                                </ul>
                                                <h1 id="DescriptionoftheYORDERrepresentation" data-magellan-target="DescriptionoftheYORDERrepresentation"><a id="representation">Description of the 'YORDER' representation</a>
                                                </h1>
                                                <p>This is the representation used for the CRUD management of the 'YORDER' class. It has the following characteristics:</p>
                                                <ul>
                                                    <li>Associated class: 'YORDER' with the 'YOH' instance code.</li>
                                                    <li>Behaviors available: Creation, Modification, Deletion, Reporting Excel, Reporting Word, and Mail merge Word.</li>
                                                    <li>No collection is declared, the collections used are inherited from the class.</li>
                                                    <li>The associated script is called 'YORDER_RSPE'.</li>
                                                    <li>No dedicated property is defined, only the properties of the class will be necessary.</li>
                                                    <li>No dedicated method is defined, only the methods of the class will be necessary.</li>
                                                </ul>
                                                <p>The sections and blocks are organized as follows:</p>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <th colspan="3" class="TableStyle-NormalRows-BodyE-Column1-Body2">Section definition</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <th colspan="4" class="TableStyle-NormalRows-BodyD-Column1-Body2">Blocks definition</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Code</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Description</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Order</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1" />
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Code</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Description</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body1">Section</th>
                                                        <th class="TableStyle-NormalRows-BodyD-Column1-Body1">Order</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2">YHEAD</td>
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2">Header</td>
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2">10</td>
                                                        <td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YMAIN</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Main info</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YHEAD</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">10</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YSTAT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Status</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YHEAD</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">20</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YLINES</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Lines</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">20</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YLINES</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Lines</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YLINES</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">30</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YFOOT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Footer</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">30</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YFOOT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Footer</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YFOOT</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">40</td>
                                                    </tr>
                                                </table>
                                                <p>The following properties are available in the representation:</p>
                                                <table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Alias</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Property</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Collection</th>
                                                        <th class="TableStyle-NormalRows-BodyE-Column1-Body2">Description</th>
                                                        <th class="TableStyle-NormalRows-BodyD-Column1-Body2">Facets</th>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YORDNUM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Order Number</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">All</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YBPC</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YBPC</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Customer</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Query, Detail, Edit, Lookup</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YREP</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YREP</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Sales rep</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Query, Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDDAT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YORDDAT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Order Date</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Query, Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YCUR</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YCUR</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Currency</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YSTATUS</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YSTATUS</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Status</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Detail, Edit (Not inputted)</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YITM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD.YITM</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Item Ref</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YOD.YPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YOD</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Line Price</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YUNIT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD.YOL.YUNIT</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD.YOL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Unit</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YQTY</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YOD.YOL.YQTY</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YOD.YOL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Quantitu</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body1">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YUNITPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD.YOL.YUNITPRICE</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">YOH.YOD.YOL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body1">Unit Price</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body1">Detail, Edit</td>
                                                    </tr>
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YTOTAL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">YOH.YTOTAL</td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2" />
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2">Order total</td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2">Detail, Edit (not inputted)</td>
                                                    </tr>
                                                </table>
                                                <p>The script associated with the representation is called 'YORDER_RSTD'.</p>
                                                <h1 id="Thedifferentscriptsused" data-magellan-target="Thedifferentscriptsused"><a id="scripts">The different scripts used</a>
                                                </h1>
                                                <p>All scripts are starting with '$METHODS' or '$PROPERTIES' label. To know the exact context, the following variables need to be checked:</p>
                                                <ul>
                                                    <li>'ACTION' gives the event being caught. For example, "ADDLINE_AFTER" is executed when a line is added in a collection.</li>
                                                    <li>'CURPRO' gives the name of the property when the event is called by '$PROPERTIES' and hence associated to a rule (CONTROL, INIT, PROPAGATE).</li>
                                                    <li>'CURPTH' gives the level of the instance compared to the level where the code is attached. 'CURPTH' is used only for methods (always empty for rules). If 'CURPTH' is empty for a method, the code associated with a class is called for an instance of this class. If 'CURPTH' is not empty, it describes the path starting from this instance. For example:
<ul><li>If the code related to the sub-line is called in the script associated with the sub-line, then 'CURPTH' is empty.</li><li>If the code related to the sub-line is called in the script associated with the line, then 'CURPTH' equals "YOL".</li><li>If the code related to the sub-line is called in the script associated with the header, then 'CURPTH' equals "YOD.YOL".</li><li>If the code related to the sub-line is called in the script associated with the representation, then 'CURPTH' equals "YOH.YOD.YOL".</li></ul></li>
                                                </ul>
                                                <p>The scripts used on every class or representation have the following pattern:</p><pre xml:space="preserve"><code>$METHODS
 Case CURPTH
   When "" : # Methods called for the instance of the class associated with the script
     Case ACTION
         ... here are the methods
     Endcase
   When ... : # Methods called for child instances of the class associated with the script 
     Case ACTION
         ... here are the methods
     Endcase
Endcase
Return
$PROPERTIES
  Case CURPRO
    When ... : # The property is defined here
      Case ACTION
         # Here ACTION can have the values CONTROL, INIT, PROPAGATE...
      Endcase
  Endcase
Return</code></pre>
                                                <br />In the following example code, we will skip these lines and mention where the code is written.
<h2 id="Atsublinelevel" data-magellan-target="Atsublinelevel">At sub-line level</h2><p>This script associated with 'YORDSUBLIN' is used at the sub-line level to manage the events, control, and default values only. By default, this script defined as specific is called 'YORDERSUBLIN_CSPE'.</p><p>As nothing is required, there is no action to be done in this script.</p><p>If the properties in the sub-lines have to be filled, no code is necessary, the <em>Mandatory</em> check box will be activated in the class definition.</p><h2 id="Atlinelevel" data-magellan-target="Atlinelevel">At line level</h2><p>This script associated with 'YORDLINE' is called 'YORDLINE_CSPE'. The only code written is used when a line is modified to propagate to the sub-lines some of the modifications that have been done.</p><p>Two things happen:</p><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th class="TableStyle-NormalRows-BodyE-Column1-Body2">Event</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">ACTION value</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">CURPTH</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">CURPRO</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">"this" value</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Actions to be done</th></tr><td rowspan="2">When a sub-line is added to a line</td><td rowspan="2">ADD_LINE_AFTER</td><td rowspan="2">""</td><td rowspan="2">"YOL"</td><td rowspan="2">YORDELINE instance</td><td>1. Propagate YORDNUM and YORDL from line to the sub-line</td><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">2. Compute YORDSL with a new value greater than the existing line values</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2">When a key property (YORDNUM or YORDL) is modified in the line</td><td rowspan="2" class="TableStyle-NormalRows-BodyE-Column1-Body2">"PROPAGATE"</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">""</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">"YORDNUM"</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDELINE instance</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">1. Propagate YORDNUM on all the sub-lines</td></tr><td>""</td><td>"YORDL"</td><td>YORDELINE instance</td><td>2. Propagate YORDL on all the sub-lines</td></table>
The first case gives the corresponding code (after the '$METHOD' label):<pre xml:space="preserve"><code>$METHODS
 Case CURPTH
   When "YOL"
     Case ACTION
       When "ADDLINE_AFTER" : # A line has been added
         this.YORDNUM = this.APARENT.YORDNUM : # "this" is the sub-line, this.APARENT is the line
         this.YORDL   = this.APARENT.YORDL
         # To assign YORDSL to a new value, compute the maximum of the YORDSL property
         #  for all the YOL child instance of the line, and add 1 to the result
         this.YORDSL  = 1+max(this.APARENT.YOL(1..maxtab(this.APARENT.YOL)).YORDSL)
     Endcase
 Endcase
Return</code></pre>
The second case gives the corresponding code (after the $PROPERTIES label):<pre xml:space="preserve"><code>$PROPERTIES
Case CURPTH
  When "" : # We are here on the properties of the instance associated with the current class (line)
    Case CURPRO
      When "YORDNUM" : # Order number at line level
        Case ACTION
          When "PROPAGATE" : # The value has been modified
               Local Integer I
               # Loop on all existing sub-lines of the line : "this" is the line modified
               For I=1 To maxtab(this.YOL)
                 If this.YOL(I)&lt;&gt;null : this.YOL(I).YORDNUM=this.YORDNUM : Endif
               Next I
        Endcase
      When "YORDL" : # Line number at line level
        Case ACTION
          When "PROPAGATE" : # The value has been modified
               Local Integer I
               # Loop on all existing sub-lines of the line : "this" is the line modified
               For I=1 To maxtab(this.YOL)
                 If this.YOL(I)&lt;&gt;null : this.YOL(I).YORDL=this.YORDL : Endif
               Next I
        Endcase
    Endcase
Endcase
Return</code></pre><h2 id="Atheaderlevel" data-magellan-target="Atheaderlevel">At header level</h2><p>This script associated with YORDER is called YORDER_CSPE. There is more code to write because several cases need to be managed:</p><ul><li>Implement the method that computes the total price (global method of the YORDER class).</li><li>Call this method just before the persistence is done in the database. This might happen in two cases: when the order is created or when it is modified.</li><li>When a line is added, the line index properties are to be assigned. This is a bit complex because a sorting order on the lines need to be managed.</li><li>When the order number is modified, the value to the lines is to be propagated.</li></ul><p>On properties, the propagation code is the following:</p><pre xml:space="preserve"><code>$PROPERTIES
  Case CURPRO
    When "YORDNUM"
      Case ACTION
        When "PROPAGATE"
          # Loop on all the lines present to assign YORDNUM
          # The propagation rule present in YORDLINE_CSPE script will update the sub-line values
          Local Integer I
          For I=1 To maxtab(this.YOD)
            If this.YOD(I)&lt;&gt;null : this.YOD(I).YORDNUM=this.YORDNUM : Endif
          Next I
      Endcase
  Endcase
Return</code></pre><br />On methods, the code is the following:<pre xml:space="preserve"><code>$METHODS
 Case CURPTH
   When "" : # Method on the order class
     Case ACTION
       When "YTOTAMOUNT" : # Total amount computation : ARET_VALUE returns the result, I is a loop variable
           Local Integer I
             ARET_VALUE=0
             # Loop done on all the YOD values if the pointer is not null and if the line is not marked as deleted
             For I=1 To maxtab(this.YOD)
               If this.YOD(I)&lt;&gt;null
                 If find (this.YOD(I).ASTALIN,[V]CST_ADEL, [V]CST_ANEWDEL)=0
                   this.YOD(I).YPRICE=fmet this.YOD(I).LINEPRICE
                   ARET_VALUE+=this.YOD(I).YPRICE
                 Endif
               Endif
             Next I
       # When an insertion or an update method is called, call the previous computation method before database persistence
       When "AINSERT_CONTROL_BEFORE", "AUPDATE_CONTROL_BEFORE"
             this.YTOTAL= fmet this.YTOTAMOUNT
     Endcase
   When "YOD" : # method on the line
      Case ACTION
       When "LINEPRICE" : # Total line computation : ARET_VALUE returns the result, I is a loop variable
           Local Integer I
             ARET_VALUE=0
             # Loop done on all the YOL values if the pointer is not null and if the line is not marked as deleted
             For I=1 To maxtab(this.YOL)
               If this.YOL(I)&lt;&gt;null
                 If find (this.YOL(I).ASTALIN,[V]CST_ADEL, [V]CST_ANEWDEL)=0
                   ARET_VALUE+=this.YOL(I).YUNITPRICE*this.YOL(I).YQTY
                 Endif
               Endif
             Next I
         When "ADDLINE_AFTER" : # A line is added
            Gosub ADD_LINE_YOD : # We need to manage the numbering of the line added
      Endcase
Endcase
Return</code></pre><br />The last part of the code is now the 'ADD_LINE_YOD' sub-program. This code assigns two properties on the YOD collection:
<ul><li>The 'YORDL' property is managed as the 'YORDSL' on the sub-line : an assignment is done with a number greater than the other values of the collection.</li><li>The 'YSORT' property is managed by taking into consideration the display order of the lines. To avoid having to rewrite all the lines when a line is inserted, the 'YSORT' property is filled with multiples of 100. When a line is inserted, a dichotomy rule is used to assign it.</li><li>The 'ASORT' property that is automatically added in the collections and managed by the supervisor handles the index in the table for 1 to the number of lines.</li></ul><p>For example, we start with an empty order. Lines A, B, and C are added first. Then line D is inserted between A and B, line E is inserted between lines B and C, line F is inserted between A and D, line G is inserted before A, and line H is added at the end. The final result will be the following, as it appears on the page when all updates have been done:</p><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th class="TableStyle-NormalRows-BodyE-Column1-Body2">line inserted</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">AORDER property</th><th class="TableStyle-NormalRows-BodyE-Column1-Body2">YORDSL value</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">YSORT value</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">G</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">1</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">7</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">50</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">A</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">2</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">1</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">100</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">F</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">3</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">6</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">125</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">D</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">4</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">4</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">150</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">B</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">5</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">2</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">200</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">E</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">6</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">5</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">250</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">C</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">7</td><td class="TableStyle-NormalRows-BodyE-Column1-Body1">3</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">300</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">H</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">8</td><td class="TableStyle-NormalRows-BodyE-Column1-Body2">8</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">400</td></tr></table><p>As you can see, 'YORDSL' gives the input order, 'AORDER' handles the index for displaying the lines, and 'YSORT' allows you to sort the lines without having to reassign other number lines when a limited number of insertions have been done.</p>
The following algorithm manages this operation:<pre xml:space="preserve"><code>$ADD_LINE_YOD
# Increment value for dichotomy algorithm
  Local Integer MY_STEP
  MY_STEP = 100
# Manage key identifiers
  this.YORDNUM  = this.APARENT.YORDNUM
  this.YORDL    = 1 + max(this.APARENT.YOD(1..maxtab(this.APARENT.YOD)).YORDL)
# Manage the SORT property
  Local Integer I, BEF_LINE, AFT_LINE, OFFSET_LINE : # Positions in collection (they have a 0 value here)
# Where are the previous and next lines ? Loop on YOD values
# "this" is here the current line, we need to loop on the YOD in the header instance (APARENT)
  For I = 1 To maxtab(this.APARENT.YOD)
    If this.APARENT.YOD(I) &lt;&gt; null
      If this.APARENT.YOD(I).AORDER = this.AORDER - 1
        BEF_LINE=I
      Elsif this.APARENT.YOD(I).AORDER = this.AORDER + 1
        AFT_LINE=I
      Endif
    Endif
  Next I
Local Integer BEF_LINE_SORT, AFT_LINE_SORT: # Positions in the sort order
# If the new line is not added at the end of the collection
  If AFT_LINE &lt;&gt; 0
    # Assign the SORT properties (BEF_LINE_SORT is 0 if insertion at the beginning of the collection)
    AFT_LINE_SORT = this.APARENT.YOD(AFT_LINE).YSORT
    If BEF_LINE &lt;&gt; 0 : BEF_LINE_SORT = this.APARENT.YOD(BEF_LINE).YSORT : Endif
    # If there is enough space then we insert using a dichotomy method
    If BEF_LINE_SORT &lt;= AFT_LINE_SORT - 2
      this.YSORT = int((BEF_LINE_SORT + AFT_LINE_SORT)/2)
    Else
      # If not enough space, we reassign the SORT property of all lines from the new inserted line
      For I=1 To maxtab(this.APARENT.YOD)
        If this.APARENT.YOD(I) &lt;&gt; null
          OFFSET_LINE=this.APARENT.YOD(I).AORDER-this.AORDER
          If OFFSET_LINE&gt;=0
            # Assign the SORT property          
            this.APARENT.YOD(I).YSORT = BEF_LINE_SORT + MY_STEP + (OFFSET_LINE * MY_STEP)
          Endif
        Endif
      Next I
    Endif
  # If the new inserted line is at the last position in the array
  Else #If AFT_LINE = 0
    # If a previous line exist, we know the last value used, otherwise it is 0
    If BEF_LINE &lt;&gt; 0 : BEF_LINE_SORT = this.APARENT.YOD(BEF_LINE).YSORT : Endif
    # Assign the SORT property
    this.SORT = BEF_LINE_SORT + MY_STEP
  Endif
Return</code></pre><h2 id="Atrepresentationlevel" data-magellan-target="Atrepresentationlevel">At representation level</h2><p>At representation level, the only code that has been added is the one that triggers a computation of the total every time a unit price is modified or a line is added. This code does not have to be inserted in the class code; otherwise, when running in service mode, the computation is repeated several times.</p><p>There is no guarantee that the total price will be displayed every time a modification is made on the price due to a bad web connection, especially with mobile devices, or data sent by group. Every time an exchange is made between the client and the server, the client returns the modifications made on prices since the last time, and the server sends back the computed total price accordingly.</p><p>The implemented code executes the following rules:</p><ul><li>When a modification is done on the lines instance (insertion and deletion), the price is recomputed.</li><li>When a modification is done on the sub-lines instance (insertion and deletion), the price is recomputed.</li><li>When an update is done on the price or quantity in a sub-line instance, the price is recomputed.</li></ul>
The computation of the price is done by calling the 'YTOAMOUNT' method on the order header instance, which provides the following code:<pre xml:space="preserve"><code>$METHODS
  Case CURPTH
    When "YOH.YOD" : # Here we are at the line level, "this" is the line, "this.APARENT" is the header
      Case ACTION
        When "PROPAGATE"
          this.APARENT.YTOTAL= fmet this.APARENT.YTOTAMOUNT
      Endcase
    When "YOH.YOD.YOL" : # Here we are at the sub-line level, "this" is the sub-line, "this.APARENT.APARENT" is the header
      Case ACTION
        When "PROPAGATE"
          this.APARENT.APARENT.YTOTAL= fmet this.APARENT.APARENT.YTOTAMOUNT
      Endcase
  Endcase
Return
$PROPERTIES
  Case CURPRO
    When "YOH.YOD.YPRICE"
      Case ACTION
        When "PROPAGATE"
          this.APARENT.YTOTAL= fmet this.APARENT.YTOTAMOUNT
      Endcase
    When "YOH.YOD.YOL.YQTY", "YOH.YOD.YOL.YUNITPRICE"
      Case ACTION
        When "PROPAGATE"
          this.APARENT.APARENT.YTOTAL= fmet this.APARENT.APARENT.YTOTAMOUNT
      Endcase
  Endcase
Return</code></pre><h1 id="Validationanddeletionmanagement" data-magellan-target="Validationanddeletionmanagement"><a id="valdel">Validation and deletion management</a></h1><p>In a second step of this development, a validation operation has been added. Being an operation, it is considered as stateless. When the event is caught, 'this.YORDNUM' (the key) is filled but the instance is not. A complex operation needs to perform an 'AREAD' method first. In this case, the only operation to perform is to update the 'YSTATUS' value to 2 if it is not already done. If it is already the case, a warning is returned.</p><p>An important point is that for the moment, using error handling classes and methods is useless in an operation context because the instance in which the operation runs is volatile and will disappear with the corresponding 'AERROR' child class. The only solution is to return a single status, which is done through the 'ARET_VALUE' parameter.</p><p>The code of the operation has been defined in the 'YORDER_CSPE' script, just after the '$METHODS' label. If 'CURPTH' is empty, the code should be added after the lines managing the "AINSERT_CONTROL_BEFORE" and "AUPDATE_CONTROL_BEFORE" methods. </p><p>The code is as follows:</p><pre xml:space="preserve"><code>       When "YVALIDATE"
            Local File YORDER
            # Execute the update transaction
            Trbegin [YOH]
            Update [YOH] Where YORDNUM=[L]YORDNUM and YSTATUS=1 With YSTATUS=2
            Commit
            # If no record updated, it can be because the order does not exist or because already validated
            If adxuprec=0
              Read [YOH]YOH0=[L]YORDNUM
              # Send a warning status if order already validated, and error status if order doesn't exist
              If fstat=[V]CST_AOK
                ARET_VALUE=[V]CST_AWARNING
              Else
                ARET_VALUE=[V]CST_AERROR
              Endif
            Endif
     Endcase</code></pre><br />When a deletion is requested, the system also controls that the 'YSTATUS' is not equal to 2; otherwise, the deletion is rejected. This will be added in sequence to the previous lines. When 'CURPTH' is empty it is also done at the header level in the '$METHODS' section.
<p>The code is the following:</p><pre xml:space="preserve"><code>       # The order can only be deleted if YSTATUS is 1
       When "ADELETE_BEFORE"
            If this.YSTATUS&lt;&gt;1
              VAL_OK=fmet this.ASETERROR('','Order validated ',[V]CST_AERROR)
            Endif</code></pre><br /></div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#Howtocrud3levels"> How to crud 3 levels
</a>
                                                    </li>
                                                    <li><a href="#Descriptionofrequirements">Description of requirements</a>
                                                    </li>
                                                    <li><a href="#Databasestructure">Database structure</a>
                                                    </li>
                                                    <li><a href="#Descriptionofthecreatedclasses">Description of the created classes </a>
                                                    </li>
                                                    <li><a href="#DescriptionoftheYORDERrepresentation">Description of the 'YORDER' representation</a>
                                                    </li>
                                                    <li><a href="#Thedifferentscriptsused">The different scripts used</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Atsublinelevel">At sub-line level</a>
                                                        </li>
                                                        <li><a href="#Atlinelevel">At line level</a>
                                                        </li>
                                                        <li><a href="#Atheaderlevel">At header level</a>
                                                        </li>
                                                        <li><a href="#Atrepresentationlevel">At representation level</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Validationanddeletionmanagement">Validation and deletion management</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">26 février 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>