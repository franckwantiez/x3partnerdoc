<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="fr-fr" xml:lang="fr-fr" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="For" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> For
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/TableStyles/NormalRows.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript">/*<![CDATA[*/


function onload(){
	window.focus();
	window[window.history.pushState ? "onpopstate" : "onhashchange"] = function(event){ windows.focus(); };
}


/*]]>*/</script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Retour" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Passer au contenu principal</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Afficher le volet de navigation" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Compte</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Paramètres</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Déconnexion</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Champ de recherche" placeholder="Rechercher" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filtrer&#160;:</span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Filtre de recherche" title="Tous les fichiers" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">Tous les fichiers</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Rechercher" role="button" tabindex="0"><span class="invisible-label">Démarrer la recherche</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Changer de langue">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Changer de langue">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="For" data-magellan-target="For"> For
</h1>
                                                <p><code>For</code> is used to perform loops in two cases:<br />* Read loops on database tables or joins.<br />* Loops on index values or on a list of values.</p>
                                                <h1 id="Syntax" data-magellan-target="Syntax">Syntax</h1><pre xml:space="preserve"><code>(1)   For INDEX_VARIABLE = FIRST_VALUE To LAST_VALUE  STEP_CLAUSE
       ...
      Next INDEX_VARIABLE
(2)   For LIST_VARIABLE = LIST_OF_VALUES
       ...
      Next LIST_VARIABLE
(3)   For KEY_DESC HINT_CLAUSE FROM_TO_CLAUSE WHERE_CLAUSE WITH_CLAUSE
       ...
      Next
(4)   For (VARIA_LIST) From DATAB_TYPE Sql SQL_STATEMENT As  [CLASS]
      Next</code></pre>
                                                <h2 id="Syntax1" data-magellan-target="Syntax1">Syntax 1:</h2>
                                                <ul>
                                                    <li><code>INDEX_VARIABLE</code> is a numeric value that will take its first value with the result of <code>FIRST_VALUE</code> and then vary by steps given by the <code>STEP_CLAUSE</code> (1 if no <code>STEP_CLAUSE</code> exists) until <code>END_VALUE</code> has been exceeded (the execution will continue after <a href="4gl_next.html">Next</a>).</li>
                                                    <li><code>FIRST_VALUE</code> and <code>END_VALUE</code> are numeric expressions that give the beginning and the end of the loop.</li>
                                                    <li><code>STEP_CLAUSE</code> is an optional clause that gives the step value of the loop, with the following syntax: <a href="4gl_step.html">Step</a><code>STEP_VALUE</code>, where <code>STEP_VALUE</code> is a numeric expression that gives the value that increment the index variable at every loop.</li>
                                                </ul>
                                                <h2 id="Syntax2" data-magellan-target="Syntax2">Syntax 2:</h2>
                                                <ul>
                                                    <li><code>LIST_VARIABLE</code> is a variable that will successively take every loop all the values given in <code>LIST_OF_VALUES</code>.</li>
                                                </ul>
                                                <h2 id="Syntax3" data-magellan-target="Syntax3">Syntax 3:</h2>
                                                <ul>
                                                    <li><code>KEY_DESC</code> is a key description from a table or join, with the following syntax:
<ul><li>[<code>ABBREV</code>]<code>KEY_NAME</code></li><li><code>KEY_NAME</code></li><li>[<code>ABBREV</code>]<code>KEY_NAME</code>(<code>GROUPING_LEVEL</code>)</li><li><code>KEY_NAME</code>(<code>GROUPING_LEVEL</code>)</li><li>[<code>ABBREV</code>]</li><li>[<code>ABBREV</code>]<a href="4gl_reckey.html">reckey</a></li><li><a href="4gl_reckey.html">reckey</a></li></ul></li>
                                                    <li><code>ABBREV</code> is the abbreviation of the table or the link in which the loop is performed (by default, the default table as indicated by <a href="4gl_file.html">File</a> or <a href="4gl_default.html">Default</a><a href="4gl_file.html">File</a>).</li>
                                                    <li><code>KEY_NAME</code> is the name of a key defined in the dictionary for the table, or given by an <a href="4gl_order-by.html">Order By</a> syntax. By default, it is the default key as defined by <a href="4gl_currind.html">currind</a>.</li>
                                                    <li><code>GROUPING_LEVEL</code> is the number of key components used in the loop. Every loop will take a different key value if you consider the number of elements given by <code>GROUPING_LEVEL</code>. By default, the loop will be done on every selected line of the database.</li>
                                                    <li>When the <a href="4gl_reckey.html">reckey</a> keyword is used, no FROM_TO_CLAUSE is allowed.</li>
                                                    <li><code>HINT_CLAUSE</code> is an optional clause that defines a hint sent to the database. If this clause is ommitted, the engine acts as if the <a href="4gl_with.html">With</a><a href="4gl_nohint.html">Nohint</a> had been sent. For more information, see <a href="4gl_hint.html">Hint</a>.</li>
                                                    <li><code>FROM_TO_CLAUSE</code> gives a key range for a loop on a table, with the following syntax : <a href="4gl_from.html">From</a><code>KEY_VALUE</code><a href="4gl_to.html">To</a><code>KEY_VALUE</code>.</li>
                                                    <li><code>KEY_VALUE</code> is a list of at least one expression, separated by semicolons, that defines a value for the different segments of the key.</li>
                                                    <li><code>WHERE_CLAUSE</code> is an optional clause with the following syntax: <a href="4gl_where.html">Where</a><code>FILTER_EXPRESSION</code>, Where <code>FILTER_EXPRESSION</code> is an expression that filters the lines in the database. For more information, see <a href="4gl_where.html">Where</a>.</li>
                                                    <li><code>WITH_CLAUSE</code> is an optional clause that can have one of the two following syntaxes:
<ul><li><a href="4gl_with.html">With</a><a href="4gl_lock.html">Lock</a></li><li><a href="4gl_with.html">With</a><a href="4gl_stability.html">Stability</a></li></ul></li>
                                                </ul>
                                                <h2 id="Syntax4" data-magellan-target="Syntax4">Syntax 4</h2>
                                                <p>This is declared in the <a href="4gl_system.html">following document</a>.</p>
                                                <h1 id="Examples" data-magellan-target="Examples">Examples</h1><pre xml:space="preserve"><code># Example 1: loop on a value with step 1
   Local Integer I,J
   For I=1 To 10
     J+=I
   Next I
   # At this point, I=11, and J=55
# Example 2: loop on a decimal value
  Local Decimal NUMBER
  Local Integer LOOP_COUNT
  For NUMBER=pi To 10 Step pi
    LOOP_COUNT+=1
  Next NUMBER
  # At this point, NUMBER is equal to 4*pi (the first value that exceeds 10) and LOOP_COUNT is equal to 3
# Example 3: descending loop
  Local Integer DOWN, LOOP_COUNT
  For DOWN=20 To 0 Step -4
    LOOP_COUNT+=1
  Next DOWN
  # At this point, DOWN is equal to -4 and LOOP_COUNT is equal to 6
# Example 4: Loop that will never be executed
  Local Integer I, STARTING_POINT,LOOP_COUNT
  Gosub SET_STARTING_POINT
  For I=STARTING_POINT To STARTING_POINT+3 Step -1
    LOOP_COUNT+=1
  Next I
  # At this point, LOOP_COUNT is equal to 0: as the range is ascending and the step descending no loop will be performed
# Example 5: Compute the planning for the first, third and fourth weeks of every month except June and July
  Local Char IMONTH(20)
  Local Integer IWEEK
  For IMONTH="January","February","March","April","May","September","October","November","December"
    For IWEEK=1,3,4
      Call GET_PLANNING(IWEEK,IMONTH)
    Next IWEEK
  Next IMONTH
# Example 6: Perform a loop for all the customers using the default key
  Local File CUSTOMERS [CUST]
  For [CUST]
    Call SEND_GREETINGS_MAIL([CUST]CUSTOMER)
  Next
# Example 7: Perform a loop for all the newly created customers using the default key 
  Local File CUSTOMERS [CUST]
  For [CUST] Where CRDATTIM&gt;=format$("4Y[-]MM[-]DD",date$-10)+"T00:00:00Z"
    Call SEND_GREETINGS_MAIL([CUST]CUSTOMER)
  Next
# Example 8: Perform a loop for all the customer having a category between 3 and 5
  Local File CUSTOMERS [CUST] Order By Key CATEG=CATEGORY;CUSTOMER
  For [CUST]CATEG From 3 To 5
    Call SEND_ADVERTISING_MAIL([CUST]CUSTOMER)
  Next
# Example 9: Perform a loop for all the customer having a category between 3 and 5
#            Send them a letter depending on the country
  Local File CUSTOMERS [CUST] Where find(COUNTRY,"FRANCE","GERMANY","ITALY")&lt;&gt;0
&amp;                             Order By Key CATEG=CATEGORY;COUNTRY;CUSTOMER
  For [CUST]CATEG(1) From 3 To 5
    # We will enter in this loop for every distinct value of CATEG
    For [CUST]CATEG(2)
      # We will enter in this loop for a given CATEG value for every distinct value of COUNTRY 
      MODEL=string$(COUNTRY="FRANCE","FRENCH")+string$(COUNTRY="GERMANY","GERMAN")+string$(COUNTRY="ITALY","ITALIAN")
      For [CUST]CATEG
        # This loop is performed for every customer for the CATEG and COUNTRY selected in the nesting loops.
        CALL SEND_MAIL(MODEL,[CUST]CUSTOMER)
      Next
    Next
  Next
# Example 10 : Update in a loop with lock with 2 conditions, one given by evalue(CONDITION), the other by  evalue(CONDITION1)
# Attention, this locks the whole set of data given by the first CONDITION until the commit or rollback is performed
  Trbegin MYTABLE [MYT]
  For [MYT] Where evalue(CONDITION) With Lock
    If evalue(CONDITION1) : Gosub UPDATE_MYT : Rewrite [MYT]
    Break (fstat&lt;&gt;0)
  Next
  If fstat : Rollback : Else : Commit : Endif
# Example 11: Perform a loop on all the lines of a table with no constraint on the reading order
  For [MYT]reckey Where evalue(CONDITION)
    ...
  Next</code></pre>
                                                <h1 id="Description" data-magellan-target="Description">Description</h1>
                                                <p><code>For</code> .. <code>Next</code> instructions define loops that can be nested, either on variables (syntax 1 and 2), or on database tables or joins (syntax 3).</p>
                                                <p><strong>The loop will terminate and the execution will continue after the <a href="4gl_next.html">Next</a> instruction in the following cases:</strong>
                                                    <br />* If a <a href="4gl_break.html">Break</a> is found in the loop. <a href="4gl_break.html">Break</a><em>N</em> allows to quit <em>N</em> nested <code>For</code>-<code>Next</code>, <code>Repeat</code>-<code>Until</code>, <code>While</code>-<code>Wend</code> loops.<br />* If the loop variable took a value out of the limits given by <code>FIRST_VALUE</code> and <code>LAST_VALUE</code> in syntax 1.<br />* If all the values found in the list have been successfully used in the loop execution (syntax 3).<br />* If all the lines satisfying the conditions and in the key range have been reached in the loop (syntax 3). The key range is defined when <code>For</code> are nested on successive partial keys to create breaks on these levels.<br />* In the <code>For</code><code>With</code><code>Lock</code> syntax, encountering a locked line does not end the loop, but <a href="4gl_fstat.html">fstat</a> will be set to 1 after the corresponding <code>Next</code> execution.</p>
                                                <p><strong>The final state after the <code>Next</code> is:</strong>
                                                    <br />* The value of <code>INDEX_VARIABLE</code>, <code>VALUE_VARIABLE</code>, or the current record if a break was executed.<br />* The first value that is strictly greater or smaller than <code>LAST_VALUE</code> in syntax 1 (depending if the loop is ascending or descending).<br />* The last value in <code>LIST_OF_VALUES</code> for syntax 2.<br />* The last line read in the table or the join for syntax 3.</p>
                                                <p><strong>When the <code>For</code> instruction is executed, the following operations are performed:</strong>
                                                    <br />* <strong>In syntax 1,</strong><code>FIRST_VALUE</code>, <code>LAST_VALUE</code> and <code>STEP_VALUE</code> are evaluated:<br /> * If <code>STEP_VALUE</code> is 0, an error is displayed.<br /> * If (<code>LAST_VALUE</code>-<code>FIRST_VALUE</code>)*<code>STEP_VALUE</code> is negative, the loop is not executed, but <code>INDEX_VARIABLE</code> is assigned with <code>FIRST_VALUE</code>.<br /> * <code>INDEX_VARIABLE</code> is assigned with <code>FIRST_VALUE</code> and the loop is executed:<br />* <strong>In syntax 2,</strong><code>VALUE_VARIABLE</code> is assigned with the first value found in <code>LIST_OF_VALUES</code>.<br />* <strong>In syntax 3:</strong><br /> * If it is the unique loop done on the table or the first level of nesting, the SQL select is executed and a fetch is done to get the first line.<br /> * On a nested <code>For</code> level (on the same table and the same index, with a breaking level <em>B</em> that is greater than the previous one), no read is done, but the breaking conditions for the next are set to the <em>B</em> first components of the key.</p>
                                                <p><strong>When the <code>Next</code> instruction is executed, the following operations are performed:</strong>
                                                    <br />* <strong>In syntax 1,</strong><code>INDEX_VARIABLE</code> is incremented by <code>STEP_VALUE</code>. If the value of <code>INDEX_VARIABLE</code> goes out of the range given by (<code>FIRST_VALUE</code>, <code>LAST_VALUE</code>), the loop ends, otherwise the loop continues.<br />* <strong>In syntax 2</strong>, if not all the values in <code>LIST_OF_VALUES</code> have been explored, the next value on the list will be assigned to <code>INDEX_VARIABLE</code> and the loop will continue, otherwise the loop ends.<br />* <strong>In syntax 3:</strong><br /> * If the <code>For</code> was done without <code>BREAKING_LEVEL</code> on the key, the next record will be fetched. If the end of the selection is reached, the loop ends, otherwise the loop will continue.<br /> * If a value <em>B</em> is given for <code>BREAKING_LEVEL</code>, lines will be fetched until at least a value of the <em>B</em> segments of the key. If the end of the selection is reached, the loop ends, otherwise the loop stops.</p>
                                                <p>If the loop continues, the execution continues with the instruction that follows the <code>For</code> instruction associated with the <code>Next</code>. If the loop stops, the execution continues with the instruction that follows the <code>Next</code> instruction.</p>
                                                <h1 id="Comments" data-magellan-target="Comments">Comments</h1>
                                                <h2 id="Forsyntax1" data-magellan-target="Forsyntax1">For syntax 1</h2>
                                                <p>The loop variable cannot be modified inside the loop. Only the <code>For</code> instruction changes its value at every step. <code>FIRST_VALUE</code>, <code>LAST_VALUE</code>, and <code>STEP_VALUE</code> are also fixed to the value given when the <code>For</code> was executed and cannot be changed.</p>
                                                <h2 id="Forsyntax3" data-magellan-target="Forsyntax3">For syntax 3</h2>
                                                <p>The keys usable in a <code>For</code> are:<br />* When a table is used:<br /> * The key defined by the <a href="4gl_order-by.html">Order By</a> if there is one.<br /> * The keys defined in the dictionary.<br />* When a join is used:<br /> * The key defined by the <a href="4gl_order-by.html">Order By</a> clause on the link or on the <a href="4gl_filter.html">Filter</a> if there is one.<br /> * The key defined in the last <a href="4gl_order-by.html">Order By</a> clause on the main table of the <a href="4gl_link.html">Link</a>.<br /> * The keys defined in the dictionary for the main table of the <a href="4gl_link.html">Link</a>.</p>
                                                <p>In a <code>For</code> loop where a <code>BREAKING_LEVEL</code> is given, the [G]<a href="4gl_currlen.html">currlen</a> variable is set with the <code>BREAKING_LEVEL</code> value.</p>
                                                <p>If the abbreviation or the key is omitted:<br />* The default file is used as defined by <a href="4gl_default.html">Default</a><a href="4gl_file.html">File</a>, or <a href="4gl_file.html">File</a>.<br />* The default key is used:<br /> * The last key used if another access was previously done.<br /> * The key defined in the last <a href="4gl_order-by.html">Order By</a> clause if there is one.<br /> * The first key by default.</p>
                                                <p>At the end of the loop, [S]<a href="4gl_fstat.html">fstat</a> is set to 0 except if the end of the cursor was reached. [S]fstat will have a value set to 4.</p>
                                                <p>When the <code>For</code>...<code>With Lock</code> syntax, the behavior might differ depending on the database:<br />* <strong>With oracle,</strong> the whole selection is locked immediately.<br />* <strong>With SQL server,</strong> the lines are locked successively and a locking issue will happen only when a locked line is encountered.<br />When a locking issue happens, new read attempts will be done after a waiting time until the lock is released. The use of <code>For</code>...<code>With Lock</code> is discouraged.</p>
                                                <p>The <code>WHERE_CLAUSE</code> and the <code>FROM_TO_CLAUSE</code> can only be used in the first <code>For</code> of the nested <code>For</code> on different breaking levels of a key. For example:</p><pre xml:space="preserve"><code># Case that will not work
  Local File CUSTOMERS [CUST] Order By Key CATEG=CATEGORY;COUNTRY;CUSTOMER
  For [CUST]CATEG(1) From 3 To 5 : # Allowed because it is the first level of the nesting
    For [CUST]CATEG(2) Where find (COUNTRY,"FRANCE","USA")&lt;&gt;0 : # Syntax not allowed
      For [CUST]CATEG
       ...
      Next
    Next
  Next
# The right implementatipn
  Local File CUSTOMERS [CUST] Order By Key CATEG=CATEGORY;COUNTRY;CUSTOMER
&amp;                             Where find (COUNTRY,"FRANCE","USA")&lt;&gt;0 : # The filter is set first
  For [CUST]CATEG(1) From 3 To 5 : # Allowed because it is the first level of the nesting
    For [CUST]CATEG(2)
      For [CUST]CATEG
       ...
      Next
    Next
  Next</code></pre>
                                                <br />When <code>For</code> is nested on a table and a key, the breaking levels indicated must be in increasing order. There is no constraint on the fact that they are consecutive. If no final <code>For</code> loop without breaking order exists, the lowest level of read will be grouped. For example, this is allowed:<pre xml:space="preserve"><code>  Local File MYTABLE [MYT] Order By Key MYKEY=A;B;C;D;E;F
  # Loop on all distinct values of (A,B)
  For [MYT]KEY(2)
    # Loop on all distinct values of (C,D) for a given value of (A,B)
    For [MYT]KEY(4)
      ...
    Next
  Next</code></pre><br />There is a difference between Oracle and SQL server in the <code>For</code> loop when lines are inserted between the range of the <code>For</code> during its execution:<br />* <strong>With Oracle,</strong> the lines will not be visible.<br />* <strong>With SQL server,</strong> the lines will be visible, except if the clause <a href="4gl_with.html">With</a><a href="4gl_stability.html">Stability</a> dedicated to this situation is used (this makes the execution slower).
<h1 id="Associatederrors" data-magellan-target="Associatederrors">Associated errors</h1><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th class="TableStyle-NormalRows-BodyE-Column1-Body2">Error code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Description</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">7</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Class does not exist (syntax 3).</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">10</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">FIRST_VALUE, LAST_VALUE or STEP_VALUE are not numeric (syntax 1).</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">10</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">A value on the LIST_OF_VALUE is not consistent with the LIST_VARIABLE data type (syntax 2).</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">32</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Bad nesting order of breaking levels (syntax 3).</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">41</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The STEP_VALUE is 0 (syntax 1).</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">43</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">No more locks available (syntax 3).</td></tr></table><h1 id="Seealso" data-magellan-target="Seealso">See also</h1><p><a href="4gl_to.html">To</a>, <a href="4gl_step.html">Step</a>, <a href="4gl_next-loop.html">Next</a>, <a href="4gl_order-by.html">Order By</a>, <a href="4gl_reckey.html">reckey</a>, <a href="4gl_where.html">Where</a>, <a href="4gl_with.html">With</a>, <a href="4gl_lock.html">Lock</a>, <a href="4gl_stability.html">Stability</a>, <a href="4gl_from.html">From</a>, <a href="4gl_system.html">System</a>, <a href="4gl_hint.html">Hint</a>, <a href="4gl_nohint.html">Nohint</a>, <a href="4gl_break.html">Break</a>.</p><br /></div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#For"> For
</a>
                                                    </li>
                                                    <li><a href="#Syntax">Syntax</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Syntax1">Syntax 1:</a>
                                                        </li>
                                                        <li><a href="#Syntax2">Syntax 2:</a>
                                                        </li>
                                                        <li><a href="#Syntax3">Syntax 3:</a>
                                                        </li>
                                                        <li><a href="#Syntax4">Syntax 4</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Examples">Examples</a>
                                                    </li>
                                                    <li><a href="#Description">Description</a>
                                                    </li>
                                                    <li><a href="#Comments">Comments</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Forsyntax1">For syntax 1</a>
                                                        </li>
                                                        <li><a href="#Forsyntax3">For syntax 3</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Associatederrors">Associated errors</a>
                                                    </li>
                                                    <li><a href="#Seealso">See also</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">26 février 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>