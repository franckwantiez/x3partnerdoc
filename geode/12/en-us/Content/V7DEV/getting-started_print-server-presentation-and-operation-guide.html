<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="Print Server Presentation and Operation Guide" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> Print Server Presentation and Operation Guide
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/Images/doc.css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript"><![CDATA[


function onload(){
	window.focus();
	window[window.history.pushState ? "onpopstate" : "onhashchange"] = function(event){ windows.focus(); };
}


]]></script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Change language">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="PrintServerPresentationandOperationGuide" data-magellan-target="PrintServerPresentationandOperationGuide"> Print Server Presentation and Operation Guide
</h1>
                                                <!-- Public -->
                                                <p>The SAFE X3 print server processes the print requests coming from the different entities of one or more SAFE X3 solutions in a concurrent manner. Depending on global system availability, each print request saved at the server level is addressed in a dedicated print process. The entity that has submitted a request can ask the print server to either recover its current status, modify certain attributes, or delete it at any moment. </p>
                                                <p>The following table shows the different sections of this document: </p>
                                                <table bgcolor="white">
                                                    <tr>
                                                        <td><a href="#installation/unistallation">Installation / Uninstallation</a>
                                                        </td>
                                                        <td><a href="#configuration">Configuration</a>
                                                        </td>
                                                        <td><a href="#server%20startup/stop">Server startup / stop</a>
                                                        </td>
                                                        <td><a href="#monitoring">Monitoring</a>
                                                        </td>
                                                        <td><a href="#technical%20architecture">Technical architecture</a>
                                                        </td>
                                                        <td><a href="#printer%20management">Printer management and error lists</a>
                                                        </td>
                                                        <td><a href="#printer%20support%20and%20troubleshooting">Support and troubleshooting</a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <div style="page-break-after: always;">
                                                </div>
                                                <h1 id="InstallationUninstallation" data-magellan-target="InstallationUninstallation"><a id="installation/unistallation">Installation / Uninstallation</a>
                                                </h1>
                                                <h2 id="Prerequisites" data-magellan-target="Prerequisites">Prerequisites</h2>
                                                <p>Before starting the installation of a print server, check the <a href="prerequisites_print-server-on-windows.html">configuration requirements</a>.</p>
                                                <h2 id="Installation" data-magellan-target="Installation">Installation</h2>
                                                <p>The installation program allows you to place the executable files, libraries, and other resources necessary for the correct execution of the print server in the folder of your choosing. The following tree structure is then created in the installation folder:</p>
                                                <ul>
                                                    <li><b>Root</b> folder: Contains all the server binary codes.</li>
                                                    <li><b>Config</b> folder: <br />
  Contains a set of XML files : adxeditionserverconfig.xml, adxeditionserversolutions.xml and AdxOdbcConfig.xml. 
These Xml files are automatically updated and maintained by the the Administration Console. <br />
These files are used:
<ul><li>During server startup (startup parameters). </li><li>Upon automatic creation of the ODBC data sources (external descriptions of the ODBC pilots).</li><li>During the implementation cycle (description parameters for the SAFE X3 solutions attached to the server).</li></ul></li>
                                                    <li><b>Data</b> folder: Contains all the internal server cache files. It stores, among others, the "Crystal Report" reports coming from the SAFE X3 applications attached to the server.</li>
                                                    <li><b>Log</b> folder: Contains:
 <ul><li>The activity log and the exception log ("*.log").</li><li>The recovery files used after an unexpected server shutdown ("*.bin").</li><li>The report for the server shutdown ("_AdxSrvShutdown_Inf.htm").</li></ul></li>
                                                    <li><b>Lan</b> folder: Contains the localization files. If required, these files are updated during patch list installation.</li>
                                                    <li><b>Temp</b> folder: Collects the temporary files. It must be emptied regularly, depending on its volume.<br /><b>Caution:</b> The server has to be stopped when emptying the folder.</li>
                                                    <li><b>Redist</b> folder: Contains setups of components used by the PrintServer, like Microsft ODBC SQL, Oracle InstantClient, Oracle sqlplus, Microsoft .Net Framework or Microsoft Visual C++ Redistribuable.</li>
                                                    <li><b>Tools</b> folder: Contains the server administration components driven by the SAFE X3 administration console, as well as the associated utilities.</li>
                                                </ul>
                                                <h2 id="Uninstallation" data-magellan-target="Uninstallation">Uninstallation</h2>
                                                <p>Before uninstalling the print server, you first need to unpublish the SAFE X3 solutions attached to the print server by using the SAFE X3 administration console. You can then go to the control panel and click <b>Add/Remove programs</b>.</p>
                                                <div style="page-break-after: always;">
                                                </div>
                                                <h1 id="Configuration" data-magellan-target="Configuration"><a id="configuration">Configuration</a>
                                                </h1>
                                                <p>Like the other Server components of an X3 solution, the print server is configured using the Administration Console. Users should not manually modify the configuration files produced and updated by the administration console. </p>
                                                <p>For more information, refer to the Administration Console documentation.</p>
                                                <h2 id="Startupsetup" data-magellan-target="Startupsetup">Startup setup</h2>
                                                <p>These parameters allow the configuration of the technical execution environment of the print server. They are stored in the <i>adxeditionserverconfig.xml</i> file in the <b>Config</b> folder. They include:</p>
                                                <ul>
```
CODECODE CODExml
    <general odbcuserdsn="0" adxsolprf="DEFAULT" lang="ENG" log="0" port="1890" restartrpts="1" prefixname="Safe_X3_SE_V2" prefixtitle="Safe_X3_SrvEdt_V2_EDT_" description="Sage X3 PrintServer" user="" pwd="" hostname="" installpath="C:\Sage\SafeX3\PRTSRV" />
```
 <li><b>"lang" / Operating language code</b>: Language used by the server to display messages. The server can print multilanguage reports regardless of this language code.</li><li><b>"port" / TCP/IP listening port number</b>: Port number the print server uses to listen to incoming connections.</li><li><b>"restartrpts" / Setup of "Recovery" mode</b>: Used to set the default management policy for the "Recovery" mode when the server quits unexpectedly. For more details on the "Recovery" mode, refer to <a href="#recovery-status">Server startup / stop</a>.</li><li><b>"OdbcUserDSN"</b> : Create ODBC Datasource System / User while configuring the PrintServer. Default: 0 = System DSN. 1 = User DSN.<br />
Available from PrintServer 2.25 <br /></li>
```
CODECODE CODExml
<jobs max="200" purgetime="300" vpalloc="40" />
```
 <li><b>Size of the printing requests stack</b>: Maximum number of requests that can be stacked by the print server. 
 This parameter must be adjusted depending on the current maximum load of the print server.</li><li><b>"vpalloc" / Shared memory size</b>: Describes how the print server uses shared memory segments to exchange data with its print processes. The maximum size of the shared memory segments must be set during server startup (you cannot dynamically extend them).<br />
If the size allocated at startup is not sufficient for the standard use context, the print server displays an error 266. In this case, you need to stop the server, modify the value of this parameter (<i>VPALLOC</i>) through the "Administration Console", and restart the server.<br />
The default value assigned to this parameter ("40") should be high enough to avoid this type of error under normal conditions of use. </li>
```
CODECODE CODExml
<processes killtime="20" max="5" min="1" maxjobsbyprocess="10" />
```
<li><b>"killtime" </b>: Life in minutes of an idle child process
Ex: if the process "2012 - AdxImpNet.exe [args]" doesn't answer for 20 minutes (20 mn= Default value), the process [2012] is killed by the PrintServer (AdxSrvImp.exe).
</li><li><a id="max-processes"></a><b>"max" / Maximum number of processes</b>: Maximum number of print processes the print server is authorized to launch in parallel. This parameter must be adjusted depending on the average number of requests to be submitted and the global availability desired for the system.<br />
When the maximum number of processes is reached, the server stacks up the new print requests in the pending request stack. These requests are then processed when one of the print processes is available.
</li><li><b>"maxjobsbyprocess"</b> : 
The maximum number of jobs that a print process can handle before committing suicide. Default value="10".
These parameter can avoid memory leaks that can cause SAP Crystal Report engine.
</li><li><a id="activity-exception"></a><b>Characteristics of the server activity and exception log files</b>: Corresponds to a series of parameters that activate and, if needed, set a size for the server activity and exception log files.<br /> 
The sizing consists in setting the number of archive volumes for the log files, and their maximum size (in bytes). Each volume is physically associated with a file stored in the <b>Log</b> subfolder of the server. When the current volume has reached its maximum size (or when the server starts), the archive volumes are swapped to free a volume. It archives the current volume in the process.</li>
```
CODECODE CODExml
<log number="3" size="2000000" />
```
</ul><b>Example adxeditionserverconfig.xml</b>: <br /><pre xml:space="preserve"><code>CODECODE CODExml

&lt;AdxSrvImp xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>" xmlns:xsd="<a href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a>"&gt;
  &lt;config cap="Default configuration" id="DEFAULT"&gt;
    &lt;general AdxSolPrf="DEFAULT" lang="ENG" log="0" port="1890" restartrpts="1" OdbcUserDSN="0" prefixname="Safe_X3_SE_V2" prefixtitle="Safe_X3_SrvEdt_V2_EDT_" description="Sage X3 PrintServer" user="FranckDep" pwd="" hostname="" installPath="" /&gt;
    &lt;jobs max="200" purgetime="150" vpalloc="40" /&gt;
    &lt;log number="3" size="2000000" /&gt;
    &lt;processes killtime="20" max="5" min="1" maxjobsbyprocess="10" /&gt;
  &lt;/config&gt;
&lt;/AdxSrvImp&gt;</code></pre><h2 id="ParametersforthedescriptionoftheattachedSAFEX3solutions" data-magellan-target="ParametersforthedescriptionoftheattachedSAFEX3solutions">Parameters for the description of the attached SAFE X3 solutions</h2><p>The print server can only process print requests coming from a SAFE X3 technology application that belongs to a published solution. The parameters used to describe the SAFE X3 solutions attached to the print server are stored in the <i>adxeditionserversolutions.xml</i> file in the <b>Config</b> subfolder. This file is updated by the SAFE X3 administration console after the publication of a solution.</p><p>The tree structure of the file describes a solution profile. This notion is reserved for future use. Currently, only the "ADMIN" profile code is used.</p><p>Each profile has 1 to <i>n</i> solutions, and each solution contains:</p><p /><ul><br /> <li>The applications associated with the solution.</li><br /> <li>The parameters for the connection to the SADFSQ file server of the solution (including the authentication mode that needs to be used).</li><br /> <li>The parameters for the connection to the database server of the solution.</li><br /></ul><h2 id="Advancedsettings" data-magellan-target="Advancedsettings">Advanced settings</h2><p>To be able to run a print server Windows service with a non-administrator user, you can add or modify the <b>REG_DWORD</b> registry entry with a suitable value:</p><ul><li>Availability: EDT.208 or higher</li><li>Description: controls the print server behavior regarding TCP port and ODBC datasource management</li><li>Subkey: <i>`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\GENERAL`</i><ul><li>Entry: AdvancedSrvOpt</li><li>Value Type: REG_DWORD, number</li><li>Valid values range: [0-3]
  <ul><li>0: The TCP port is registered in the "<i>etc/services</i>" file, and the ODBC source is created as a "System" DSN.</li><li>1: The TCP port is no longer registered in the "<i>etc/services</i>" file.</li><li>2: The ODBC source is created as a "User" DSN.</li><li>3: Combination of values 1 and 2. With this setting, the print server Windows service can be run with a non-administrator user.</li></ul><p>The default value is 0.<br /><br /><b>Caution:</b> You must create the registry sub key with value 3 <u>before</u> you configure the component through the administration console in order to allow the print server to run with a non-administrator user.</p></li><br /></ul></li><br /></ul><p>To be able to turn on debug mode for the Crystal Report <i>U212Ltext.dll</i> embedded functions, you can add or modify the <b>REG_SZ</b> registry entry with a suitable value :</p><ul><li>Availability: EDT.102 or higher</li><li>Description: Turns on/off the debug mode for the Crystal Report <i>U212Ltext.dll</i> embedded functions.</li><li>Subkey: <i>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\REPORT</i><ul><li>Entry: U2LTEXT_TraceMode</li><li>Value Type: REG_SZ, string</li><li>Valid values Range: [ON-OFF]
  <ul><li>OFF: Debug is turned off</li><li>ON: Debug is turned off, and the trace file is generated in "<i>%TEMP%\u212ltext.log</i>"</li></ul><p>The default value is OFF.</p></li><br /></ul></li><br /></ul><h1 id="Serverstartupstop" data-magellan-target="Serverstartupstop"><a id="server startup/stop">Server startup / stop</a></h1><p>A print server can be started in "Console" mode or in "Windows service" mode. The function of the server is strictly identical in both modes. The only difference is that in "Console" mode, server activity is displayed on the screen in the Windows panel.</p><p>During the first server configuration from the SAFE Administration Console, the Console automatically creates a "Windows Service", associated with the server by default. You can start and stop this service from the administration console. You can also use standard tools in the Windows system to administer and control the service.</p><p>Note that the print server startup options described below are available both in "Console" and "Windows Service" modes.</p><ul><li><a id="recovery-status"></a><b>Launch of the server in Recovery mode: "<i>/recovery:status</i>":</b><br />
In case a print server unexpectedly shuts down during processing, the stack of print requests that are pending or in progress is serialized in a binary file. The content of this file can be reviewed in the shutdown report stored in the <b>log</b> subfolder ("<i>_AdxSrvShutdown_Inf.htm</i>" file).<br />
The "Recovery" mode is used to tell the server to start loading the previously stored stack of requests before starting the listening service. The print requests that were stopped during the involuntary shutdown are automatically recovered and submitted to the print system. When this option is activated, the recovered requests are stored in the activity log of the server.
Note that this option can be used to force the "Recovery" policy set up in the administration console:
<ul><li>Set the status value to 1 to force the activation of the "Recovery" mode.</li><li>Set the status value to 0 to force the deactivation of the "Recovery" mode".</li></ul></li><li><b>Activation of the log file: "<i>/d</i>":</b><br />
This option produces a file ("<i>AdxSrvlmp_Trace.log</i>") that logs the activity of the print server and of the printing processes that are launched. This file is stored in the temporary folder of the print server.<br /> 
This option must be used in case of problems to facilitate the analysis and correction of the incidents submitted to the Sage customer care services.</li><li><b>Launch in console mode: "<i>/noservice</i>":</b><br />
This option is used to force the print server to run in "Console" mode, instead of "Windows service" mode.</li><li><a id="noodbc"></a><b>Deactivation of the control and configuration of the ODBC sources: "<i>/noodbc</i>":</b><br />
The print server uses ODBC data sources to connect to the data servers of the SAFE X3 solutions linked to it. When you launch the server with this option, it does not manage the creation, control and configuration of these data sources. As a result, the user has to create and correctly configure the ODBC data sources, based on the characteristics of the different SAFE X3 solutions attached to the server.</li><li><b>Launch using a configuration profile different from the default profile: "<i>/cfg:cdprofil</i>":</b> Reserved for future use.</li><li><b>Deletion of a previously created Windows service: "<i>/rmsvc:cdservice</i>":</b><br />
The print server automatically stops after deleting the required service.</li><li><b>Display of the print server version: "<i>/v</i>":</b><br />
Available in Console mode only.</li></ul><p>Ex: <br /></p><pre xml:space="preserve">
AdxSrvImp.exe /noservice /d /verbose /noodbc
</pre><p><img src="../Resources/Images/images_PrintServer-Service-02_640x616.png" alt="Launching PrintServer" style="width: 640;height: 616;" /><br /><br /><br /></p><h1 id="Monitoring" data-magellan-target="Monitoring"><a id="monitoring">Monitoring</a></h1><p>You can follow the server activity by consulting the activity log file, the Windows Events Viewer, or by accessing the "Print Monitor" function available in each SAFE X3 folder, even if the server has not been started with the "<i>/d</i>" log file option.</p><h2 id="Monitoringwindow" data-magellan-target="Monitoringwindow">Monitoring window</h2><p>Connect to the print monitor function (<b>PSIMP</b>) in Classic mode to display this window. Enter the name and port of the print server to display data related to the server activity.</p><p><img src="../Resources/Images/images_print_server_2017r6_640x583.jpg" alt="PSIMP function" style="width: 640;height: 583;" /><br /></p><p>From this screen, you can:</p><ul><li>View the server startup parameters (<b>Configuration</b> section)</li><li>View the current TCP/IP sessions (<b>Clients connected</b> section)</li><li>View and modify the parameters associated with the requests that are either stacked or in progress (<b>Tasks</b> section)</li></ul><h2 id="Activitylogfileandexceptionlogfile" data-magellan-target="Activitylogfileandexceptionlogfile">Activity log file and exception log file</h2><p>The activity log file records "saving", "submission", "termination", and "deletion" events related to a print request. The exception log file records all errors and anomalies detected by the server.</p><p>These log files are activated and set up by the server administration console. Note that the exception log file automatically inherits the setup of the activity log file. Refer to <a href="#activity-exception">Configuration</a> for more information.</p><h2 id="WindowsEventsViewer" data-magellan-target="WindowsEventsViewer">Windows Events Viewer</h2><p>All the information, warnings and error messages issued by the print server or one of the print processes are displayed in the Windows Events Viewer.</p><p>In case of incidents, see the Events Viewer to establish a detailed diagnosis (<i>AdxSrvImp</i> and <i>AdxImp</i> sources).</p><div style="page-break-after: always;"></div><h1 id="Technicalarchitecture" data-magellan-target="Technicalarchitecture"><a id="technical architecture">Technical architecture</a></h1><p>The diagram below shows the simplified technical architecture of the print server.</p><p><img src="../Resources/Images/images_PrintServer-processes_640x1998.png" alt="Technical architecture" style="width: 640;height: 1998;" /></p><h2 id="Principles" data-magellan-target="Principles">Principles</h2><p>The print server is a "multiprocessing" server which maintains and controls a pool of specialized processes. The production of Crystal Report reports is the only function of these processes. The server manages the preparation and formatting of all the information necessary for the correct production of printouts and the execution of the print processes.</p><p>The main logical components of the server are described below:</p><ul><li><b>TCP/IP listening service:</b> Whenever a client sets up a TCP/IP connection to the print server service, it creates a "Client Thread" dedicated to the management of the requests coming from this client. There are as many "Client Threads" as there are connected clients.</li><li><b>Technological services:</b> These services ensure the integrity of the server, and mainly control the access to shared resources. A specialized technical service also manages the creation, configuration, and control of the ODBC data sources (Oracle or SQLServer) necessary for the print processes to access the database servers of the attached SAFE X3 solutions.
For Oracle data sources, the print server supports versions 9, 10, and 11 of the Oracle Net client, and 'Wire Protocol' type ODBC Oracle drivers. The user account under which the print server is launched requires sufficient rights and privileges to create the ODBC system data sources and the Oracle Net aliases. The user can manually create the ODBC data sources by using startup option "<i>/noodbc</i>" (see <a href="#noodbc">the print server startup options</a>), if required.</li><li><b>Basic services:</b> The print server processes basic functional services. The main ones are:
<ul><li>Saving and formatting the parameters associated with a print request</li><li>Printer selection</li><li>Printer configuration</li><li>Monitoring requests in progress</li></ul></li><li><b>File transfer:</b> Managing a print request coming from a SAFE X3 application often requires to load files stored in this application (for example, the ".rpt" report file). The print server operates with SAFE X3 (SADFSQ) file servers. It establishes a TCP/IP connection with the corresponding application servers associated with it to communicate with them.</li><li><b>Print processes:</b> When the print server finishes preparing a print request, and depending on system availability, it launches a print process that manages the final production of the report. The main task of this print process is to initialize and call the Crystal Report print engine which produces the requested report. <br />
A print process then accesses the print server shared memory to determine if the server has pending print requests. If it is the case, it will process the first eligible request. If there are no eligible or pending requests, the print process ends automatically.<br />
The maximum number of concurrent print processes for a print server can be set up using the SAFE X3 administration console (refer to the <a href="#max-processes">startup parameters</a>).</li><li><b>Shared memory:</b> The print server loads several segments of shared memory to exchange information with the print processes that it is able to create (Inter-processes shared memory). Access to these segments is carried out in an exclusive manner, based on the interprocess synchronization objects of mutual exclusion type.</li></ul><div style="page-break-after: always;"></div><h1 id="Printermanagementanderrorlists" data-magellan-target="Printermanagementanderrorlists"><a id="printer management">Printer management and error lists</a></h1><p>Follow the rules below so that the print server can carry out the printing operation correctly:</p><ul><li>If the print server is started in "Windows service" mode, you need to indicate a different startup account from the "Local system" account so that the print server can access one of the printers in your organization. No printer is attached to the "Local system" Windows account.</li><li>At least one printer must be set up on the user account used to start the print server (in "Console" mode or in "Windows service" mode).</li><img src="../Resources/Images/images_PrintServer-Service-01_480x500.png" style="width: 480;height: 500;" /><br /><li>The print server can only address printers that are "visible" and "accessible" to the user account with which the server was started (in "Console" mode or in Windows service" mode).</li><li>When printing in PDF format, the parameters relating to the document size are inherited from the default paper size of the printer associated with the user account with which the server was started (in "Console" mode or in Windows service" mode).</li></ul><h2 id="Errorcodesandmessages" data-magellan-target="Errorcodesandmessages">Error codes and messages</h2><p>The message associated with an error code refers to the following:</p><ul><li>The error code</li><li>The type of message (64: information; 48: warning; 16: error)</li><li>The function the error came from</li><li>The context (in the form of a character string)</li></ul><p>The error codes generated by the print server are referenced below:</p><h2 id="Printservererrorcodes" data-magellan-target="Printservererrorcodes">Print server error codes</h2><table><tr><th width="5%">Code</th><th>Explanation</th></tr><tr><td>251</td><td>Waiting time exceeded when an attempt is made to access a shared memory segment.</td></tr><tr><td>252</td><td>An attempt to access a shared memory segment was stopped.</td></tr><tr><td>253</td><td>Failure during an attempt to access a shared memory segment.</td></tr><tr><td>254</td><td>Unable to release the synchronization object to access a shared memory segment.</td></tr><tr><td>255</td><td>Unable to write data in a shared memory segment.</td></tr><tr><td>256</td><td>Unable to read data in a shared memory segment.</td></tr><tr><td>257</td><td>Unable to delete data in a shared memory segment.</td></tr><tr><td>258</td><td>Unable to recover the reference associated with the print request number.</td></tr><tr><td>259</td><td>Too many requests in the pending request stack.</td></tr><tr><td>260</td><td>Error during the submission of a file transfer request.</td></tr><tr><td>261</td><td>The SAFE X3 solution description has not been found in the solutions description file.</td></tr><tr><td>262</td><td>The connection to the SAFE X3 file server has failed.</td></tr><tr><td>263</td><td>Unable to open the configuration file of the print server.</td></tr><tr><td>264</td><td>Error during the initialization of the print server configuration file.</td></tr><tr><td>265</td><td>Error during the analysis of the print server configuration file.</td></tr><tr><td>266</td><td>The total length of the execution parameters for the report is too large. Contact the system administrator.</td></tr><tr><td>267</td><td>Error during the storage of the execution parameters of the report. No group memory available.</td></tr><tr><td>268</td><td>Error during the reading of the execution parameters for the report.</td></tr><tr><td>269</td><td>Error during the deletion of the execution parameters for the report.</td></tr><tr><td>270</td><td>Error during the memory transfer of the execution parameters for the report.</td></tr><tr><td>271</td><td>Unable to launch a print process.</td></tr><tr><td>272</td><td>The initialization context for a print process is absent or has failed.</td></tr><tr><td>273</td><td>The print request could not be submitted (request not ready).</td></tr><tr><td>274</td><td>The print request could not be submitted (unable to activate the thread).</td></tr><tr><td>275</td><td>Error generated by the print engine.</td></tr><tr><td>276</td><td>The command line option is unknown.</td></tr><tr><td>278</td><td>Unknown error.</td></tr><tr><td>279</td><td>Error upon log file initialization.</td></tr><tr><td>280</td><td>Error upon opening the "Recovery" files.</td></tr><tr><td>281</td><td>Unable to recover a Web preview request.</td></tr><tr><td>282</td><td>Unable to recover an already faulty request.</td></tr><tr><td>283</td><td>Error upon reading the "Recovery" files.</td></tr><tr><td>284</td><td>Error upon saving a "Recovery" request.</td></tr></table><h2 id="Errorcodesinthecachemanagementmodule" data-magellan-target="Errorcodesinthecachemanagementmodule">Error codes in the cache management module</h2><table><tr><th width="5%">Code</th><th>Explanation</th></tr><tr><td>181</td><td>Root folder for the cache is not found.</td></tr><tr><td>182</td><td>"Application" folder not found.</td></tr><tr><td>183</td><td>Unable to access the registry database.</td></tr><tr><td>184</td><td>Sage X3 Warehousing server type unknown.</td></tr><tr><td>185</td><td>Transfer type not supported.</td></tr><tr><td>186</td><td>File type unknown.</td></tr><tr><td>187</td><td>Error upon access/transfer with SAFE X3 (SADFSQ) file server.</td></tr><tr><td>188</td><td>Error during the conversion of a character string in Unicode.</td></tr><tr><td>189</td><td>Error during the creation of the cache structure.</td></tr><tr><td>190</td><td>The current session of the cache manager is not initialized.</td></tr><tr><td>191</td><td>Error on opening a local file.</td></tr><tr><td>192</td><td>The file server requested does not exist.</td></tr><tr><td>193</td><td>Unable to open the local file.</td></tr><tr><td>194</td><td>Unable to open the server file.</td></tr><tr><td>196</td><td>The local file requested does not exist.</td></tr><tr><td>199</td><td>Unable to establish a connection with the distant server.</td></tr><tr><td>200</td><td>Error in the reading/writing of the file.</td></tr><tr><td>201</td><td>Unable to compare the Timestamps.</td></tr><tr><td>202</td><td>Error during the conversion of a Timestamp to the system date.</td></tr><tr><td>203</td><td>Error upon deletion of an "Archive" type folder.</td></tr><tr><td>204</td><td>Error upon restoration of an "Archive" type folder.</td></tr><tr><td>205</td><td>The server archive files could not be found.</td></tr><tr><td>239</td><td>Unknown error.</td></tr></table><h2 id="ErrorcodesfortheWindowsservicemanagementmodule" data-magellan-target="ErrorcodesfortheWindowsservicemanagementmodule">Error codes for the Windows service management module</h2><table><tr><th width="5%">Code</th><th>Explanation</th></tr><tr><td>361</td><td>Unable to open the "Service Control Manager".</td></tr><tr><td>362</td><td>Unable to open the requested service.</td></tr><tr><td>363</td><td>Unable to delete the service.</td></tr><tr><td>364</td><td>Unable to stop the service.</td></tr><tr><td>365</td><td>Unable to stop the service. Number of attempts exceeded.</td></tr><tr><td>366</td><td>Unable to start the service.</td></tr><tr><td>367</td><td>Unable to start the service. Number of attempts exceeded.</td></tr><tr><td>368</td><td>Unable to perform the operation. The service is already started or in the process of being started.</td></tr><tr><td>369</td><td>The service already exists.</td></tr><tr><td>370</td><td>Unable to create the service.</td></tr></table><h2 id="ErrorcodesoftheSAFEX3solutionsmanagementmodule" data-magellan-target="ErrorcodesoftheSAFEX3solutionsmanagementmodule">Error codes of the SAFE X3 solutions management module</h2><table><tr><th width="5%">Code</th><th>Explanation</th></tr><tr><td>231</td><td>Unable to determine the installation folder for the 'SAFE X3 Solutions' file.</td></tr><tr><td>232</td><td>Unable to open the 'SAFE X3 Solutions' file.</td></tr><tr><td>233</td><td>Unable to start the analysis of the 'SAFE X3 Solutions' file.</td></tr><tr><td>234</td><td>An error has occurred during the analysis of the "SAFE X3 solutions" file.</td></tr></table><h2 id="ErrorcodesintheODBCmanagementmodule" data-magellan-target="ErrorcodesintheODBCmanagementmodule">Error codes in the ODBC management module</h2><table><tr><th width="5%">Code</th><th>Explanation</th></tr><tr><td>311</td><td>Unable to determine the installation folder for the 'SAFE X3 ODBC Description' file.</td></tr><tr><td>312</td><td>Unable to open the 'SAFE X3 ODBC Description' file.</td></tr><tr><td>313</td><td>Unable to start the analysis of the 'SAFE X3 ODBC Description' file.</td></tr><tr><td>314</td><td>An error has occurred during the analysis of the "SAFE X3 ODBC Description" file.</td></tr><tr><td>315</td><td>The driver description has not been found in the "SAFE X3 ODBC Description' file.</td></tr><tr><td>316</td><td>Error during the deletion/creation operation for the ODBC data sources.</td></tr><tr><td>317</td><td>Error during the creation of an ODBC data source.</td></tr><tr><td>318</td><td>Error during the call to an ODBC configuration API.</td></tr><tr><td>319</td><td>Unable to open the "TnsNames.ora" file.</td></tr><tr><td>320</td><td>Unable to read the "TnsNames.ora" file.</td></tr><tr><td>321</td><td>Unable to update the "TnsNames.ora" file.</td></tr><tr><td>322</td><td>Unable to recover the installation information for the Oracle*Net client.</td></tr><tr><td>323</td><td>Unable to find the Oracle*Net "Tnsnames.ora" configuration file.</td></tr><tr><td>324</td><td>Unable to allocate a temporary file to backup the Oracle*Net "Tnsnames.ora" file.</td></tr><tr><td>325</td><td>Unexpected error during the configuration of an ODBC source.</td></tr><tr><td>326</td><td>Error during the call to a Sql ODBC API.</td></tr><tr><td>327</td><td>The connection test for the ODBC data source has failed.</td></tr><tr><td>328</td><td>The description parameters for the source have errors or are incomplete.</td></tr><tr><td>329</td><td>Unable to create the ODBC data source.</td></tr><tr><td>330</td><td>The data source specified does not exist.</td></tr></table><div style="page-break-after: always;"></div><h1 id="Supportandtroubleshooting" data-magellan-target="Supportandtroubleshooting"><a id="printer support and troubleshooting">Support and troubleshooting</a></h1><ul><li><a href="#printer-management">Printer management</a></li><li><a href="#cannot-detect-previous-installed-version-after-a-setup-crash">Cannot detect previous installed version after a setup crash</a></li><li><a href="#no-installed-printer-no-hay-impresoras-instaldas--pas-dimprimante-install%C3%A9e">No installed Printer</a></li><li><a href="#activation-of-the-log-files">Activation of the log files</a></li><li><a href="#enable-logs-in-sap-vs-studio-crystal-report">Enable logs in SAP VS Studio Crystal Report</a></li><li><a href="#font-size-reduced-when-exporting-to-pdf">Font size reduced when exporting to PDF</a></li><li><a href="#chinese-characters-not-correctly-displayed-in-pdf">Chinese characters not correctly displayed in PDF</a></li><li><a href="#special-fonts-embedded-in-pdf-documents">Special fonts embedded in PDF documents</a></li><li><a href="#user-function-libraries-u212ltextdll-and-u212ltoword">User function Libraries U212LText.dll and U212ltoword</a></li><li><a href="#parameters-sent-to-the-printserver">Parameters sent to the PrintServer</a></li></ul><h2 id="Printermanagement" data-magellan-target="Printermanagement">Printer management</h2><p>The following rules must be observed for the printServer to be able to print correctly:<br />- In case the Print server is started in "Windows Service" mode, it is absolutely necessary to specify a boot account other than the "Local System" account so that the Publisher can address one of the printers in your organization. <br /><br />By default, NO printer is attached to the "Local System" Windows account.<br />- the user account under which the PrintServer has been started <br />  (in "Console" mode or in "Windows Service" mode) must at least have a printer configured.<br />- The Print server can only send printers "visible" and "accessible" by the user account under which the server was started<br />&#160;&#160;&#160;(whether in "Console" mode or "Windows Service" mode)<br />- In case of printing with generation of a document in PDF format,<br />&#160;&#160;&#160;document size settings will be inherited from the default printer paper size associated with the user account under which the Print Server was started (whether the PrintServer is running in "Console mode" or "Windows Service" mode).</p><h2 id="Cannotdetectpreviousinstalledversionafterasetupcrash" data-magellan-target="Cannotdetectpreviousinstalledversionafterasetupcrash">Cannot detect previous installed version after a setup crash</h2><p>When a PrintServer setup crash, it sometimes cannot detect the previous version anymore.<br />We need to restore registry entries after a setup crash : <br />copy and adapt patch to your config, and put this text in a file named restore.reg for example. <br /><br />Check the contains, and Execute the file. <br /><br /> <br /></p><pre xml:space="preserve">
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Sage Safe X3 V2 Print Server]
"DisplayName"="Sage Safe X3 V2 Print Server"
"UninstallString"="\"C:\\Program Files\\Java\\jre1.8.0_77\\bin\\javaw.exe\" -jar \"D:\\Sage\\SafeX3\\PRTSRV\\uninstaller\\uninstaller.jar\""
"DisplayVersion"="EDT.226"
"Publisher"="Sage"
"DisplayIcon"="D:\\Sage\\SafeX3\\PRTSRV\\Uninstaller\\UninstallerIcon.ico"
</pre><p><br /></p><h2 id="NoinstalledPrinterNohayimpresorasinstaldasPasdimprimanteinstallée" data-magellan-target="NoinstalledPrinterNohayimpresorasinstaldasPasdimprimanteinstallée">No installed Printer/ No hay impresoras instaldas / Pas d'imprimante installée</h2><p>In case the Print Server is started in "Windows Service" mode, <br />it is essential to specify a startup account different from the "Local system" account so that the print server can address one of the printers in your organization. <br /><br />By nature, no printer is attached to the Windows account "Local System". <br /></p><p>The user account under which the PrintServer has been started (in "Console" mode or in "Windows Service" mode) <br />must at least have a printer configured. <br /></p><h2 id="Activationofthelogfiles" data-magellan-target="Activationofthelogfiles">Activation of the log files</h2><p>All errors are logged in the application log of the Windows Event Viewer, even if the Print Server trace mode has not been enabled. <br /></p><p>If we cannot reproduce the issue, the customer needs to activate traces, play the issue, and send us the traces. <br /></p><p>" /d": This option is used to produce a file that logs the activity of the print server and of the printing processes that are launched. <br />The produced file is named "AdxSrvlmp_Trace.log"; it is stored in the temporary folder of the print server. <br /><br />Log file of print processus and Wrapper CrystalReport : <code>RPT_Trace_TABCOUNTRY_CrDll_SUPERV1.log</code> <br /><br />There is on file by report. <br /></p><p>File Logs are written in directory rootPrinterDirectory\Temp <br /><br />Ex: </p><pre xml:space="preserve">
C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\AdxSrvImp_Trace.log
C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\RPT_Trace_ZTESTKO_CrDll_SBELU92.log
</pre><p>This option must be used if problems occur, to facilitate the analysis and correction of incidents submitted to the Sage customer care services.<br /></p><pre xml:space="preserve">
ex:
c:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\AdxSrvImp.exe /d
</pre><p>Ex: to modify the PrintServer service:</p><pre xml:space="preserve">
sc config "Safe_X3_SE_V2DEFAULT" binPath= "\"c:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\AdxSrvImp.exe\" /d"
[SC] ChangeServiceConfig réussite(s)
</pre><p>Or modify the arguments in Services - effective only the first time : </p><p><img src="../Resources/Images/images_PrintServer-ServiceAddTraces_360x702.png" alt="Add traces" style="width: 360;height: 702;" /><br /><br />But be careful, in this case, the debug mode will be effective only for the first time you launch the service. <br />This argument will be remove after the next restart. <br /></p><p><br /></p><p>Excerpt <code>C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\AdxSrvImp_Trace.log</code><br /></p><pre xml:space="preserve">
**** Function : SrvImpSuper_newRptJob - [3/20 12:53:52:750] ****
    - Receipt of a new print request - JobId : 1 - [Date : 3/20 12:53:52:750]
    - JobId Settings 1 :
      _FormatExport=_28
      __REPORT=_TABCOUNTRY.rpt
      __DESTINATION=_3
      __TYPDBA=_2
      __DBDATABASE=_v12026x3
      __DBUSER=_SEED
      __DBPASSWORD=***
      +X3IMP=_matrixw19sql.sagex3rd.local:1890
      __wJobID=_SEED-9945-20230320125352-28
      __WSTATION=_MATRIXW19SQL.sagex3rd.local
      __CDUSER=_ADMIN
      __ADXSOL=_V12026X3
      __APPLICATION=_SEED;matrixw19sql.sagex3rd.local;20100
      __APPRPT=_X3;matrixw19sql.sagex3rd.local;20100
      __RPTLAN=_ENG
      X3DOS=_SEED;matrixw19sql.sagex3rd.local;20100;150;ENG
      __RUNTIME=_MATRIXW19SQL.sagex3rd.local;20100
      __JOBLINKED=_
      __REQUETE=_2322986
      _PreVisuOptions=11111111111111111111
      _Orientation=_0
      _PaperSize=_1
      X3CLI=_SEED folder
      X3EDT=_Report Sage Copyright
      X3ETA=_TABCOUNTRY
      X3TIT=_Country
      X3OPE=_System Administrator
      X3USR=_ADMIN
      X3LAN=_ENG
      X3SIT1=_*
      X3SIT2=_z
      X3PRF=_ADMIN
      X3FCT=_ 
      X3SIT=_
      paysdeb=_ 
      paysfin=_zzzzzzzzzz
      impselections=_0
</pre><p>Details of parameters sent to the PrintServer: <a href="#parameters-sent-to-the-printserver">list of parameters</a><br /></p><p>Excerpt <code>C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\RPT_Trace_TABCOUNTRY_CrDll_SEED1.log</code><br /></p><pre xml:space="preserve">
     File destination: preparing Crystal Report
     Issue file: c:\Sage\SafeX3\PRTSRV\Temp\SEED-9945-20230320125352-28_
     Excel format, data only: preparing Crystal Report
     CrystalReport start process Document -  3/20/2023 12:53:54 PM
     File destination: processing by Crystal Report
     ** Stage: CrystalReport Document has been processed - Duration: 00:00:01.7220328
     ** Stage: CrystalReport Document completed - Duration: 00:00:01.7230337
     Dispose CrystalReport Document - 3/20/2023 12:53:54 PM 
     Memory current process : 74 MB / Total Memory: 10399 MB / Free Memory: 907 MB  -  3/20/2023 12:53:55 PM
     Current process CPU usage : 19.983 % CPU  /  Global CPU usage : 48.39094 % CPU 
    End of print process - 3/20/2023 12:53:55 PM
</pre><p><b>Trace mode of UFLs DLLs :</b><br /> <br />u212ltext.log is generated in <code>Temp</code> folder below the printserver install path.<br /><br />Ex: <code>c:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp</code> <br /><br />Note: <br />Dll <code>"U212LText.dll"</code> used by the PrintServer is stored in <code>"C:\Windows\crystal"</code> <br /><br />Crytal Report 2016 uses the Dll <code>"U212IText.dll"</code> located in <code>"C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86"</code> since PrintServer 2.28. <br /><br />Crytal Report 2020 uses the Dll <code>"U212IText.dll"</code> located in <code>"C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64"</code> since PrintServer 2.28. <br /></p><ul><li>Activation via key in the registry</li></ul><pre xml:space="preserve">
HKEY_LOCAL_MACHINE\SOFTWARE\Adonix\SRVIMP\0,1,5,0\REPORT\U2LTEXT_TraceMode : ON/OFF
</pre><ul><li>Print Server Activity and Error Logs: <br />
DEFAULT_activity_N.log<br />
DEFAULT_exception_N.log<br /><br /></li></ul><p>Modules.exe : CR tools which allows to see the versions of DLLs / Assemblies loaded in memory <br /><br />- Useful for checking the version of third-party components (Drivers ODBC, Drivers d’imprimante, CLR, Framework CR .Net…)<br />- Log ODBC : Usefull if SGBD error. We can obtain more details than the CRPE simple error.<br />- ProcMon.exe: Details about every running processes. Not easy to use.<br />- Debugger Post-Mortem:  <br /><br />If server crash or crash of print process <br /><br />Need to make debug symbols available, and ideally a version of the Print Server in COFF mode<br />Used to exploit a posteriori a crash dump, to locate in the code the line in error (with its stack and all the context of the registers, etc ...)<br /><br /><br /></p><ul><li>Enable logs from Sap VS Studio Crystal Report dlls: 
In certain cases, Crystal report can block the print process, and we dont know why. <br />
This logs can help us to undertand the issue. <br /><br /></li></ul><p><a name="Log SAP Studio Crystal Report"></a></p><h2 id="EnablelogsinSAPVSStudioCrystalReport" data-magellan-target="EnablelogsinSAPVSStudioCrystalReport">Enable logs in SAP VS Studio Crystal Report</h2><p><a href="https://apps.support.sap.com/sap/support/knowledge/public/en/0001470978">https://apps.support.sap.com/sap/support/knowledge/public/en/0001470978</a> <br /></p><p>For Crystal Report 2011, 2013 &amp;&amp; 2016. <br /><br />Enable Logging: save this file with the reg extension, for example, "enableLog.reg", and execute it. <br /></p><pre xml:space="preserve">
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
"Destinations"=dword:00000003
"Position"=dword:00000003
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
"Destinations"=dword:00000003
"Position"=dword:00000003
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
"Destinations"=dword:00000003
"LogErrorsOnly"=dword:00000000
"Position"=dword:00000003
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
"Destinations"=dword:00000003
"Position"=dword:00000003
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
"Destinations"=dword:00000003
"Position"=dword:00000003
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
"Destinations"=dword:00000003
"LogErrorsOnly"=dword:00000000
"Position"=dword:00000003
</pre><p>Logs are located in the User Profile TEMP directory:  <code>C:\Users\[userId]\AppData\Local\Temp</code> <br /><br />Ex: <code>C:\Users\frdepo\AppData\Local\Temp</code> <br /><br />The UserId is the account Id which is linked to the PrintServer service and which launches the Print processes.</p><p>You'll have log files like this, with ".glf" extentions.</p><pre xml:space="preserve">
AdxImpNet_bkgrnd_51664_2020_05_06_12_07_24_340_trace.glf
AdxImpNet_Diagnostics_51664_2020_05_06_12_07_23_199_trace.glf
AdxImpNet_functions_51664_2020_05_06_12_07_23_205_trace.glf
</pre><p>Disable Logging</p><pre xml:space="preserve">
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
"Destinations"=dword:00000000
"Position"=dword:00000000
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
"Destinations"=dword:00000000
"Position"=dword:00000000
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
"Destinations"=dword:00000000
"LogErrorsOnly"=dword:00000000
"Position"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
"Destinations"=dword:00000000
"Position"=dword:00000000
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
"Destinations"=dword:00000000
"Position"=dword:00000000
"LogErrorsOnly"=dword:00000000
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
"Destinations"=dword:00000000
"LogErrorsOnly"=dword:00000000
"Position"=dword:00000000
</pre><h2 id="FontsizereducedwhenexportingtoPDF" data-magellan-target="FontsizereducedwhenexportingtoPDF">Font size reduced when exporting to PDF</h2><p>When you use some specific fonts like BarCodes (BarcodeEAN13) and export a report to PDF format, the font size can be slightly reduced compared to the size that appears in the Crystal Reports designer and in printed output.<br /></p><p>The CrystalReport PDF export engine can be modified to incorporate a new algorithm that positions characters precisely to prevent truncation from ocurring while maintaining the correct font size. This algorithm can be activated and controlled by two new registry keys. <br /><br />These keys are:</p><pre xml:space="preserve">
[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Export\Pdf]
"UsePrecisePositioningForText"=dword:00000001
</pre><pre xml:space="preserve">
[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal] Reports\Export\Pdf"
TruncationAdjustment"=dword:00000002
</pre><p>The "UsePrecisePositioningForText" key turns on the new functionality when it is set to 1. When this functionality is activated, the "ForceLargerFonts" key is ignored. The "TruncationAdjustment" key controls a width calculation rounding function in the new algorithm and accepts values between 0 and 10 inclusively. The default value of 2 has been tested to sufficiently eliminate most truncation issues. If truncation is still observed, this value can be increased for added granularity. <br /></p><p><strong>Known Limitations:</strong> <br /><br />When the "UsePrecisePositioningForText" key is turned on, there are several side-effects. Exporting to PDF may take slightly longer, but no more than 10% longer. The exported PDF document will increase in size over the standard outputand Crystal Reports will consume more GDI resources during the export. <br /></p><p>See <a href="https://www.arcanadev.com/support/kb/K00000394">https://www.arcanadev.com/support/kb/K00000394</a> <br /><br /><br /><br /><br /></p><p><b>Registry Settings and Options for Crystal Reports</b> <br /><br /><a href="https://help.jeff-net.com/knowledgebase/article/registry-settings-and-options-for-crystal-reports">https://help.jeff-net.com/knowledgebase/article/registry-settings-and-options-for-crystal-reports</a></p><p><b>2165260 - List of Registry Keys used in Crystal Reports <strong>* Master KBA *</strong></b><br /><br /><a href="https://apps.support.sap.com/sap/support/knowledge/en/2165260">https://apps.support.sap.com/sap/support/knowledge/en/2165260</a><br /><br /></p><h2 id="ChinesecharactersnotcorrectlydisplayedinPDF" data-magellan-target="ChinesecharactersnotcorrectlydisplayedinPDF">Chinese characters not correctly displayed in PDF</h2><p>Chinese or arabic characters are not correctly displayed in PDF document, generated by the PrintServer. <br /><br />These characters could come from formula, and stored in localmenus, or from the database. <br /></p><p><img src="../Resources/Images/images_PrintServer-ChineseInPDF.png" /><br /></p><p>Example, field containing a formula:</p><pre xml:space="preserve">
textofchapter("SEED;matrixw19;20101",{?X3LAN},1,2)
</pre><p>See SAP Crystal Report issue :<br /><a href="https://apps.support.sap.com/sap/support/knowledge/en/1532489">https://apps.support.sap.com/sap/support/knowledge/en/1532489</a></p><p><b>Cause :</b> <br /><br />It has been observed that these fonts do not work with Crystal Reports correctly while exporting to PDF<br /><br /><b>Resolution : </b><br /><br />Use other supported fonts for Unicode and Chinese characters like 'Arial Unicode MS' or 'Minglu'<br /><br /><br /></p><p>To fix this issue, please, edit your report with Crystal Report Designer,<br />chose the field containing the Formula,<br />and change the font from "Arial" to <b>"Arial Unicode MS"</b><br /><br /></p><p><b>From Print Server 2.24 (2021.07 - 2021 R3) : </b><br />There is a new feature introduced in PrintServer 2.24, avoiding edition of all your reports and able to replace every text field using "Arial" and replacing "Arial" font by "Arial Unicode MS" automatically.<br /><br />To activate this feature, pleace edit your registry and this key :  </p><pre xml:space="preserve">
Subkey: HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\GENERAL
  - Entry: ForceUnicodeFont
  - Value Type: REG_SZ, string
Valid values Range: [0-1] or [ON - OFF] 
0: Conversion feature is turned OFF 
1: Convert all fields using "Arial" font to "Arial Unicode MS" to avoid any issues with Asian characters
The default font used for unicode is 'Arial Unicode MS',  to change this default font, create or edit this registry key 'UnicodeFont' : 
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
UnicodeFont : "Arial Unicode MS"
UnicodeFont : "GNU Unifont"
</pre><p><br /></p><p><b>ForceNonUnicodeFont: </b><br /><br />Print Server 2.25 (2022.01 - 2022 R1) <br /><br />This registry can be used to force every field to use a specific font, a Non Unicode font, like "Courier New" <br /><br />ForceNonUnicodeFont : 1/0 - Default value = 0<br /></p><pre xml:space="preserve">
Add registry parameter:
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
ForceNonUnicodeFont : 1
Add registry 'NonUnicodeFont' to specify NON UNICODE fonts to use. 
The default font used for non unicode is 'Courier New',  to change this default font.
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
NonUnicodeFont : "Courier New"
</pre><p><img src="../Resources/Images/images_PrintServer-Registry-01_640x492.png" alt="PrintServer registry" style="width: 640;height: 492;" /><br /></p><p><br /></p><div style="page-break-after: always;"></div><h2 id="SpecialfontsembeddedinPDFdocuments" data-magellan-target="SpecialfontsembeddedinPDFdocuments">Special fonts embedded in PDF documents</h2><p>If you're using non standard fonts in your reports for BarCodes, specific fonts for icons, bank checks and so on, you need to check the licence of the font, and check its properties.<br /><br />The licence determines if the font can be embedded in PDF documents or not. <br /></p><p><img src="../Resources/Images/images_PrintServer-specialFontEmbeddedPdf_360x509.png" alt="Special fonts" style="width: 360;height: 509;" /><br /></p><pre xml:space="preserve">
To verify the embedded security level of a font, review the font properties.
If the security level contains "No-embedding" permissions, then exporting to PDF will not be successful.
For the utility to allow you to view the embedded security level of a font, download the "Font properties extension" from Microsoft's web site at: www.microsoft.com/typography
True Type Fonts (TTF) has embedding permissions that determine if they can be converted into an embedded font format.
The permissions associated with the embedded security level of a font are as follows:
- No-embedding:
  This does not allow fonts to be embedded. Contact the font vendor to request a possible upgrade to an embeddable font.
- Print and preview:
  This allows fonts to be embedded. However, only within pages that remains static on the client computer. If a page allows fonts to be changed, then editable or installable fonts are required. 
  Examples of a page that allows fonts to be changed are an online Java-based word processor or an email editor.
- Editable:
  This allows fonts to be embedded using a tool such as Microsoft Web Embedding Fonts Tools (WEFT) beyond the limitations of the "Print and preview" permissions.
- Installable:
  This allows fonts to be embedded similar to the "Editable" permissions. Note that installable fonts are not installed in the visitors' fonts folder.      
</pre><p>1214944 - What font types are supported in Crystal Reports? <br /><br /><a href="https://apps.support.sap.com/sap/support/knowledge/en/1214944">https://apps.support.sap.com/sap/support/knowledge/en/1214944</a> <br /></p><p>An open-source licensed Type 1 MICR E13-B font <br /><br /><a href="https://sandeen.net/GnuMICR/">https://sandeen.net/GnuMICR/</a> <br /></p><p>Embeding full set of fonts when exporting to PDF from a Crystal Reports file  <br /><br /><a href="https://answers.sap.com/questions/11929151/embeding-full-set-of-fonts-when-exporting-to-pdf-f.html">https://answers.sap.com/questions/11929151/embeding-full-set-of-fonts-when-exporting-to-pdf-f.html</a> <br /></p><p>Free MICR font (Turn blank security paper into check stock) <br /><br /><a href="https://kenhamady.com/cru/archives/102">https://kenhamady.com/cru/archives/102</a> <br /></p><p>Font is not allowed to be embedded in document when exporting report to PDF for Crystal Designer <br /><br /><a href="https://support.idautomation.com/Barcode-Fonts/Font-is-not-allowed-to-be-embedded-in-document-when-exporting-report-to-PDF-for-Crystal-Designer/_1733">https://support.idautomation.com/Barcode-Fonts/Font-is-not-allowed-to-be-embedded-in-document-when-exporting-report-to-PDF-for-Crystal-Designer/_1733</a> <br /></p><div style="page-break-after: always;"></div><h2 id="UserfunctionLibrariesU212LTextdllandU212ltoword" data-magellan-target="UserfunctionLibrariesU212LTextdllandU212ltoword">User function Libraries U212LText.dll and U212ltoword</h2><p>Crystal Report extensions to publish proprietary functions from a SAP Crystal Report form field. <br /><br />Depending on the use case, these DLLs are loaded by Crystal Report Designer and / or CRPE .Net. <br />It is never directly loaded by the Print Server (AdxSrvImp an AdxImpNet), but called by SAP CR Engine or SAP CR Designer.<br /></p><p>Location on the Sage PrintServer station: </p><pre xml:space="preserve">
C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86
and PrintServer &lt;= 2.27. Note: C:\Windows\crystal doesn't exist since PrintServer 2.25.
C:\Windows\crystal
</pre><p><br /></p><p>PrintServer &gt;= 2.28: U212IText.dll, U212Itoword.dll <br /></p><pre xml:space="preserve">
C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64
used by SAP Crystal Reports Designer 2020
C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86
used by X3 PrintServer and SAP Crystal Reports Designer &lt; 2016
C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86
used by SAP Crystal Reports Designer 2016
Directory `C:\Windows\crystal`, containing `U212IText.dll`, `U212Itoword.dll` and `u2lbcode.dll`, is no more created and used by the PrintServer &gt;= 2.28.
</pre><h2 id="U212LTextdll" data-magellan-target="U212LTextdll">U212LText.dll</h2><p>Support for "menu-local" and "translatable text" fields. <br /><br />Applies to cache-managed resource files <br /></p><p>These specialized functions allow you to insert or perform specific calculations on data managed by the X3 information system. These functions can be incorporated into Crystal Reports intended to run in an X3 application. <br /></p><p><img width="640" src="../Resources/Images/PrintServer-U212LText_TextOfChapter.png" /><br /></p><p>Behavior of U2Ltext functions when there is no local menu description: <br /></p><p>If the local menu number or the message number passed as an argument of one of the ad hoc functions of the U2LText does not exist in the menuCdLang description file, the function no longer returns an error. <br />The function returns as default value an empty string ( "" ). <br />A warning message is nevertheless written in the trace file of the DLL.</p><p>Menus : <br />there are downloaded by the PrintServer, from the current X3 folderID (ex: SEED, ..), and stored in its filesytem <code>c:\\Sage\srvedit\Data\[Folder]_[Hostname]_[Runtime Port]\GEN\ALL\MENL</code> . <br /></p><p>Example : </p><pre xml:space="preserve">
C:\Sage\SafeX3\EDTV2\EDTSRVFRDEP\srvedit\Data\SEED_po027493_20192\GEN\ALL\MENL
</pre><p><code>dir C:\Sage\SafeX3\EDTV2\EDTSRVFRDEP\srvedit\Data\SEED_po027493_20192\GEN\ALL\MENL</code><br />:</p><pre xml:space="preserve">
menuarb
menuaus
menubra
menubri
menuchi
menueng
menufra
menuger
menuita
menupol
menupor
menus
menuspa
textraarb
textraaus
textrabra
textrabri
textrachi
textraeng
textrafra
textrager
textraita
textrapol
textrapor
textraspa
</pre><p>Excerpt menueng :</p><pre xml:space="preserve">
1
NO
No
Yes
|
2
RCMAD&gt;<!-- <LVI09XTH+-FG
Search
Create
Change
Cancel
Copy
Next
Previous
List
Validate
Print
 -->&lt; Previous
&gt; Last
X Sel
Table
# Code
Page +
Page -
End
Ex
|
3
123
Yes / No
Total / Inquiry
Object
|
4
DOH
Decimal
Octal
Hexadecimal
|
5
35
3 ½ inches
5 ¼ inches
</pre><p><code>Function 'TextForCode'</code></p><p>This function returns the label associated with the message number of a SAGE X3 field. <br />By default, the description is returned in the connection language.</p><p>Parameters : </p><ul><li>Application key :
Key of the application in the form :    <code>Folder;Server;Port;Version;Language</code></li><li>Field name :
X3 fieldname with the form « <code>{tablename.fieldname}</code> »</li><li>Message number :
Value of the message number.</li></ul><p>• Return : message label in the requested language. <br /><br />• Note: the function uses the "menus" and "menu [lang]" files as input.<br /><br />• Example :</p><pre xml:space="preserve">
TextForCode("PRODV140;prodsrv;1940;140;ENG","ACONSULT.MODULE", 8)
</pre><p><code>Function 'TranslatedTextForCode'</code><br /><br />This function returns the label associated to a message number from an X3 field, in the requested language.</p><p>Parameters :<br />- Application key ( Form: <code>Folder;Server;Port;Version;Language</code>)<br />- Language code : FRA, ENG, SPA, ITA, BRI, POR<br />- Field name<br />- Message number</p><p>Example : </p><pre xml:space="preserve">
TranslatedTextForCode("PRODV140;prodsrv ;1940;140","FRA","ACONSULT.MODE", 8)
</pre><p><code>Function 'TextOfChapter'</code><br /></p><p>Description : <br />This function returns the label associated with the message number of an X3 local menu, in the requested language.<br /></p><p>Parameters :<br />- Application key ( Form: <code>FOLDER;HOST;PORT;VERSION;LANGUAGE</code>)<br />- Language code : FRA, ENG, SPA, ITA, BRI, POR<br />- Message number</p><p>Return : label in the specified language.<br /><br />La fonction utilise en entrée le fichier "menuCdlang".</p><p>Example :</p><pre xml:space="preserve">
TextOfChapter("PRODV140;prodsrv;1940;140","FRA", 2229, 8)
</pre><p>=&gt; Entry number 8, chapter 2229<br /></p><p>Example with variables :</p><pre xml:space="preserve">
textofchapter({?X3DOS},{?X3LAN},1,3)
</pre><p>=&gt; Entry number 3, chapter 1<br /></p><p><code>Function 'X3TranslatedText'</code><br /></p><p>Description :<br />This function returns the label associated with the alphanumeric key of an application text, in the requested language<br /></p><p>Parameters :<br />- Application key ( Form: <code>Folder;Server;Port;Version;Language</code>)<br />- Language code : FRA, ENG, SPA, ITA, BRI, POR<br />- Text key : <br />Application text key in the form : <br /><br />Nom <code>table~Nom champ~Identifiant 1~Identifiant 2~</code><br />- Please note that the "~" character corresponds to the field separator. It is obligatory.</p><p>Return : text in the specified language.<br /><br />Remarque : la fonction utilise en entrée le fichier "textraCdlang".</p><p>Example :</p><pre xml:space="preserve">
X3TranslatedText ("PRODV140;prodsrv ;1940 ","SPA", "PFOOTINV~SHOAXX~50~ ~" )
</pre><p>Example: <br /><br /><img width="640" src="../Resources/Images/PrintServer-X3TranslatedText.png" alt="X3TranslatedText" /><br /><br /></p><p><strong>Debug U212LText:</strong></p><p>Registry :</p><pre xml:space="preserve">
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
PrintEngine : 0
U2LTEXT_TraceMode : OFF
U2LTOWORD_TraceMode : OFF
</pre><p><b>U212LText.dll:</b> <code>U2LTEXT_TraceMode=ON</code><br /><br />Traces U212LText disabled or activated <br /><br />U212LText.dll: support for "menu-local" and "translatable text" fields. Applies to cache-managed resource files.<br /><br />The Trace is named <code>U212ltext.log</code>.  <br /><br />This file is generally saved in temp directory "Documents &amp; Settings" of the user profile.<br /><br />Ex: <code>C:\Users\frdepo\AppData\Local\Temp\U212ltext.log</code> <br /><br /></p><p>Example traces U212ltext.log : </p><pre xml:space="preserve">
            *****************************************
            *   Sage® X3 Print Services *
            *    U212LText.dll Trace File       *
            *****************************************
==&gt; Start Fct [InitForJob] - Id [4]
    - INFORMATION : DLL Version  [EDT.2.999]
    - INFORMATION : DLL Location [C:\windows\crystal\U212LText.dll]
    - INFORMATION : Caller Module Name[Edition Server V5 (220000)]
    - INFORMATION : Caller Module Full Name[C:\Source\X3\print-server224\src\server\bin\Debug\ConsolePrintNet.exe]
    - INFORMATION : Start Time   [3/30 21:33:40:958]
    - WARNING : Unable to find Default Language in General Registry [Software\Adonix\x3\0,1,4,0\]
  </pre>
  Note that the Dll was located in C:\windows\crystal\U212LText.dll until &lt;= PrintServer 2.27 <br />
UFL Libraries `U212IText.dll` and `U212Itoword.dll` are compiled in 64 bits and copied in folder from PrintServer &gt;= 2.28: <br />
  `C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64` (used by SAP CR 2020)<br />
  32 bits UFL Libraries`U212IText.dll` and `U212Itoword.dll` are still copied in folder:<br />
  `C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86` (used by X3 PrintServer and SAP CR &lt; 2016)<br />
  and `C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86` (used by SAP CR 2016)<br />
  Directory `C:\Windows\crystal`, containing `U212IText.dll`, `U212Itoword.dll` and `u2lbcode.dll`, is no more created and used by the PrintServer &gt;= 2.28. <br />
  The PrintEngine will use UFL libraries located in `C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86`.
### U212ltoword.dll
AmountToWord: Conversion of amounts into letters (multi-language / multi-currency) relies on language / currency description files delivered
• Special features:
- the externalization of currencies for a language is carried out in a local file,
- as well as a default language and currency in a local file.
• The supported languages are:
- French
- English
- German
- Spanish
- Italian
- Portuguese
- Dutch
- Russian
- Polish
• File location : <br />
The "U212ltoword.dll" library must be placed under "C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86" of "Program Files (x86)" installation directory.<br />
The 8 text files .txt must be placed in the sub-directory `"lan"`, from the installation directory of the PrintServer.
<pre xml:space="preserve">
X3CurFRA.txt
X3CurENG.txt
X3CuDEU.txt
X3CurSPA.txt 
X3CurITL.txt 
X3CurPOR.txt 
X3CurNLD.txt 
X3CurDFT.txt
</pre><p>Each text file contains the definition of currencies of a managed language. <br /><br />The "<code>X3CurDFT.txt</code>" file contains the default language as well as the definition of the default currencies.</p><p>• File structure :</p><pre xml:space="preserve">
#FRA
BEF;franc belge;francs belge;centime;centimes
ESP;peseta;pesetas;;
EUR;euro;euros;centime;centimes
DEM;deutsche mark;deutsche marks;pfennig;pfennig
FRF;franc;francs;centime;centimes
FRS;franc suisse;francs suisse;centime;centimes
GBP;livre;livres;penny;pence
GRD;drachme;drachmes;;
ITL;lire;lires;centesimo;centesimi;
JPY;yen;yens;sen;sen
LUF;franc luxembourgeois;francs luxembourgeois;centime;centimes
PTE;escudo;escudos;;
USD;US dollar;US dollars;US cent;US cents
</pre><p>FRA est la langue par défaut. Elle n’est utilisé que dans le fichier <code>X3CurDFT.txt</code>.<br />Les autres lignes définissent les devises pour une langue: <br /></p><pre xml:space="preserve">
Currency; unity in singular; plural unity; decimal in singular; decimal plural
</pre><p><code>Function AmountToWord</code><br /></p><p>Description formula AmountToWord <br /><br />Arguments : <br /><br />- Application key (Format: folder/server/port)<br />- Language, <br />- Currency, <br />- Amount in digit</p><p>Return : Amount in letters in the requested currency and language <br /></p><p>Note : <br /><br />If the language set as parameter to <code>AmountToWorld</code> is not supported, <br />the program will look for the default language in the default currency file. <br /><br />The default language is indicated in file <code>X3CurDFT.txt</code>. <br /><br />Example: #ENG define English as default language. <br /></p><p>Example: </p><pre xml:space="preserve">
AmountToWord("PRODV140;prodsrv;1940 ", "SPA" "EUR", 256.80)
</pre><p><br /><br />Result: <code>doscientos cincuenta y seis euros</code> <br /><br /><br /></p><p><code>Function AmountToDigit</code><br /><br />• Description de la formule AmountToDigit <br />- Arguments : Clé de l'application (dossier/serveur/port : paramètre X3DOS).<br />Langue d’édition,<br />Devise,<br />Montant en chiffre,<br />Flag de restitution des décimales (True = lettre, False = chiffre) <br />- Retour : Chaînes formatée contenant 11 champs. Le premier champ correspond à la valeur de la partie décimale (chiffre ou lettre suivant le Flag), le second champ correspond au « chiffre/lettre » de l’unité du montant, le troisième champ correspond au « chiffre/lettre » des dizaines…. le onzième champ correspond au « chiffre/lettre » des millards.<br />- Remarque : Dans le cas où le flag de restitution des décimales = True, la remarque mentionnée pour la formule AmountToWorld s‘applique également ici.</p><p><strong>Debug U212ltoword:</strong></p><p>Registry : <br /></p><pre xml:space="preserve">
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
U2LTOWORD_TraceMode: ON/OFF
</pre><p>Test program <code>"AmountToWordTest.exe"</code> since PrintServer &gt;= 2.28. <br /><br />AmountToWordTest calls the function <code>AmountToWord()</code> contained in the library <code>U212ltoword.dll</code> in command line.<br /><br /><br /><br />Usage: </p><pre xml:space="preserve">
AmountToWord TU
Usage AmountToWordTest.exe -lang [ENG, FRA, ITA... ] -cur [EUR, USD, ...]  -start [number]   -end [number]
AmountToWordTest.exe -lang FRA -cur EUR -start 3 -end 10
AmountToWord 3.000000 EUR  ENG  three Euros
AmountToWord 4.000000 EUR  ENG  four Euros
AmountToWord 5.000000 EUR  ENG  five Euros
AmountToWord 6.000000 EUR  ENG  six Euros
AmountToWord 7.000000 EUR  ENG  seven Euros
AmountToWord 8.000000 EUR  ENG  eight Euros
AmountToWord 9.000000 EUR  ENG  nine Euros
AmountToWord 10.000000 EUR  ENG  ten Euros
</pre><p><br /></p><div style="page-break-after: always;"></div><h2 id="ParameterssenttothePrintServer" data-magellan-target="ParameterssenttothePrintServer">Parameters sent to the PrintServer</h2><pre xml:space="preserve">
**** Function : SrvImpSuper_newRptJob - [1/17 15:38:10:6] ****
    - Réception d'une nouvelle demande d'impression - JobId : 1 - [Date : 1/17 15:38:10:7]
    - Paramètres du JobId 1 :
      _FormatExport=_29
      _PrinterName=_\\ser-psafo02\SAGEPRINTER
      _PrinterServer=_vcsx3v11.sagefr.adinternal.com:1890
      _PrinterDriver=_KONICA MINOLTA C364SeriesPCL SP
      _PrinterPort=_SECURE,SECURE2
      _PrinterDescriptionEx=_1|000258|000009|||
      _Orientation=_0
      _PrinterCopies=_1
      _PrinterCollate=_0
      _PrinterStartPage=_1
      _PrinterStopPage=_9999
      __REPORT=_TABCOUNTRY.rpt
      __DESTINATION=_1
      __TYPDBA=_2
      __DBDATABASE=_x3v11sql
      __DBUSER=_SUPERV
      __DBPASSWORD=***
      +X3IMP=_vcsx3v11.sagefr.adinternal.com:1890
      __WSTATION=_VCSX3V11.sagefr.adinternal.com
      __CDUSER=_ADMIN
      __ADXSOL=_V11SQL
      __APPLICATION=_SUPERV;vcsx3v11.sagefr.adinternal.com;18111
      __APPRPT=_X3;vcsx3v11.sagefr.adinternal.com;18111
      __RPTLAN=_FRA
      X3DOS=_SUPERV;vcsx3v11.sagefr.adinternal.com;18111;150;FRA
      __JOBLINKED=_
      __REQUETE=_5042306
      _PreVisuOptions=11111111111111111111
      X3CLI=_SEED folder
      X3EDT=_Etat Sage X3 Copyright Sage
      X3ETA=_TABCOUNTRY
      X3TIT=_Pays
      X3OPE=_Administrateur système
      X3USR=_ADMIN
      X3LAN=_FRA
      X3SIT1=_*
      X3SIT2=_z
      X3PRF=_ADMIN
      X3FCT=_ 
      X3SIT=_
      paysdeb=_A
      paysfin=_A
      impselections=_0
</pre><p><a href="images_PrintServer-Destinations-01.png"><br /><img src="../Resources/Images/images_PrintServer-Destinations-01_640x1393.png" alt="Print-server destinations" style="width: 640;height: 1393;" /><br /></a><br /></p><h2 id="FormatExport" data-magellan-target="FormatExport">_FormatExport</h2><pre xml:space="preserve">
_FormatExport=_29
</pre><p>_FormatExport : Export to a specific format. <br /><br />Default format : PDF <br /><br />Main supported formats in PrintServer engine and CrystalReport : RPT, Word/RTF, Excel &amp; PDF</p><pre xml:space="preserve">
CRYSTAL_FORMAT_RPT                    1   // Seagate Crystal Reports (RPT)
CRYSTAL_FORMAT_WORDWIN                3   // Word for Windows
CRYSTAL_FORMAT_RTF                    5   // RTF
CRYSTAL_FORMAT_TEXT                    9   // Text 
CRYSTAL_FORMAT_EXCEL8TAB            28  // Excel 8 étendu
CRYSTAL_FORMAT_PDF                    29  // PDF
</pre><p>A default export format is stored for each destination (PREVIEW, EXCEL, PRINT, etc), in the database. <br /><br />The default format is linked to a destination is stored in table <code>[SCHEMA].[APRINTER]</code>, field <code>"PRTFMT_0"</code> : <br /><br /><br /><br /><a href="images_PrintServer-Destinations-02.png"><img alt="Print-server destinations" width="640" src="../Resources/Images/PrintServer-Destinations-02.png" /></a><br /></p><h2 id="DESTINATION" data-magellan-target="DESTINATION">__DESTINATION</h2><pre xml:space="preserve">
__DESTINATION=_1 
CRYSTAL_DESTINATION_WINDOW: 0, 
CRYSTAL_DESTINATION_PRINTER: 1, 
CRYSTAL_DESTINATION_MAILMAPI: 2, 
CRYSTAL_DESTINATION_FILE: 3, 
CRYSTAL_DESTINATION_MAILVIM: 4, 
CRYSTAL_DESTINATION_NOTES: 5, 
CRYSTAL_DESTINATION_EXCHANGEFOLDER: 6
</pre><h2 id="TYPDBA" data-magellan-target="TYPDBA">__TYPDBA</h2><pre xml:space="preserve">
__TYPDBA=_2 (ODBCCFG_DB_ORACLE: 1, ODBCCFG_DB_SQLSERVER : 2)
</pre><h2 id="Orientation" data-magellan-target="Orientation">_Orientation</h2><pre xml:space="preserve">
-1 = Default orientation
 1 = PORTRAIT
 2 = LANDSCAPE
</pre><h2 id="PaperSize" data-magellan-target="PaperSize">_PaperSize</h2><p>Note: If destination is a Printer (<code>__DESTINATION=1</code>), we dont read this parameter. <br /><br />We read the parameter <code>_PrinterDescriptionEx</code> if it's a real Printer.</p><h2 id="PrinterName" data-magellan-target="PrinterName">_PrinterName</h2><p>Note: Parameter <code>_PrinterName</code>, <code>_PrinterServer</code>, <code>_PrinterPort</code>,  <code>_PrinterDescriptionEx</code>,  <code>_Orientation</code>, <code>_PrinterCopies</code> appears only if the destination is a Printer. <br /><br />For a preview or a file as destination, there is not paramters named <code>_Printer[XXX]</code>. <br /></p><p>Ex:</p><pre xml:space="preserve">
\\ser-psafo02\SAGEPRINTER
</pre><h2 id="PrinterServer" data-magellan-target="PrinterServer">_PrinterServer</h2><p>Ex:</p><pre xml:space="preserve">
vcsx3v11.sagefr.adinternal.com:1890
</pre><h2 id="PrinterDriver" data-magellan-target="PrinterDriver">_PrinterDriver</h2><h2 id="PrinterPort" data-magellan-target="PrinterPort">_PrinterPort</h2><h2 id="PrinterDescriptionEx" data-magellan-target="PrinterDescriptionEx">_PrinterDescriptionEx</h2><pre xml:space="preserve">
parameter _PrinterDescriptionEx=_1|000258|000009||| 
Pattern : duplex|paper source|paper size|paper height|paper width|
</pre><p><b>Duplex : </b>Depending from the printer capability to support duplex mode. <br /><br />Duplex printing means that you can print on both sides of the paper with your printer either automatically <br />or manually by turning the paper over after the first side has printed. <br />To duplex print, your model will need to have the functionality built-in. <br /><br />Simplex printing, on the other hand, only allows for printing on one side of the paper.</p><pre xml:space="preserve">
empty value, 0 or 1
1 = Duplex mode is supported by the printer.
</pre><p><b>Paper source </b><br /></p><pre xml:space="preserve">
-1 : AutoSelect / Default paper source on the printer device.
XX : Cassette 1
XX : Cassette 2
XX : Cassette 3
</pre><p>Value depends of the Printer and its capabilities. <br /><br /><br /></p><p><b>Paper size : </b><br /></p><pre xml:space="preserve">
if value equals -1 or empty = default format paper
1 = letter US
8 = A3
9 = A4
11 = A5
256 = defined by the 3 following parameters
</pre><p>Example A: </p><pre xml:space="preserve">
_PrinterDescriptionEx=_1|000258|000009||| 
Pattern : duplex|paper source|paper size|paper height|paper width|
</pre><p>This pattern significates that : <br /><br />- the Printer can use the Duplex mode, <br />- cassette id 258 : this id is different on each Printer, there is no standard about this.<br />- 09 : paper size A4<br />- The next field are empty but characters | are necessary. There are not read because its a standard and predefined size. </p><p>Example B: </p><pre xml:space="preserve">
_PrinterDescriptionEx=_1|000258|||| 
Pattern : duplex|paper source|paper size|paper height|paper width|
</pre><ul><li>the Printer can use the Duplex mode, </li><li>cassette id 258 : this id is different on each Printer, there is no standard about this.</li><li>Paper size = empty. That printer will use its default paper size.</li><li>paper height = empty value. Even if there would be a value, that wont be read because the previous number &lt;&gt; 256. </li><li>paper width = empty value</li></ul><p>Example C: </p><pre xml:space="preserve">
_PrinterDescriptionEx=_1|000258|256|15840|12240| 
Pattern : duplex|paper source|paper size|paper height|paper width|
</pre><ul><li>duplex = 1. the Printer can use the Duplex mode, </li><li>paper source = 258. This cassette id is different and specific to each Printer. </li><li>paper size = 256. Means paper size is defined by the 3 following parameters. <br /></li><li>paper height = 15840 twips</li><li>paper width = 12240 twips
Most measurement in Crystal Reports are in twips. A twip is 1/20 of a point or 1/1440 of an inch. 
There are aproximately 567 twip in a centimeter. 
This means a standard 8.1/2 x 11 inch sheet of a paper is 12240 x 15840 twips,
or 21.6 cm x 27.9 cm</li></ul><p>Full range of values :</p><pre xml:space="preserve">
1  = Letter 8 1/2 x 11 in
2  = Letter Small 8 1/2 x 11 in
3  = Tabloid 11 x 17 in
4  = Ledger 17 x 11 in
5  = Legal 8 1/2 x 14 in
6  = Statement 5 1/2 x 8 1/2 in
7  = Executive 7 1/4 x 10 1/2 in
8  = A3 297 x 420 mm
9  = A4 210 x 297 mm
10 = A4 Small 210 x 297 mm
11 = A5 148 x 210 mm 
12 = B4 (JIS) 250 x 354
13 = B5 (JIS) 182 x 257 mm
14 = Folio 8 1/2 x 13 in
15 = Quarto 215 x 275 mm
16 = 10x14 in
17 = 11x17 in
18 = Note 8 1/2 x 11 in
19 = Envelope #9 3 7/8 x 8 7/8
20 = Envelope #10 4 1/8 x 9 1/2
21 = Envelope #11 4 1/2 x 10 3/8
22 = Envelope #12 4 \276 x 11
23 = Envelope #14 5 x 11 1/2
24 = C size sheet
25 = D size sheet
26 = E size sheet
27 = Envelope DL 110 x 220mm
28 = Envelope C5 162 x 229 mm
29 = Envelope C3  324 x 458 mm 
30 = Envelope C4  229 x 324 mm
31 = Envelope C6  114 x 162 mm
32 = Envelope C65 114 x 229 mm
33 = Envelope B4  250 x 353 mm 
34 = Envelope B5  176 x 250 mm
35 = Envelope B6  176 x 125 mm
36 = Envelope 110 x 230 mm 
37 = Envelope Monarch 3.875 x 7.5 in
38 = 6 3/4 Envelope 3 5/8 x 6 1/2 in
39 = US Std Fanfold 14 7/8 x 11 in
40 = German Std Fanfold 8 1/2 x 12 in
41 = German Legal Fanfold 8 1/2 x 13 in
</pre><p>See source file C:\Program Files (x86)\Windows Kits\10\Include\10.0.17763.0\um\wingdi.h from Microsoft <a href="https://docs.microsoft.com/en-us/windows/win32/intl/paper-sizes">wingdi.h</a> for full details. <br /><br />See <a href="https://docs.microsoft.com/en-us/windows/win32/intl/paper-sizes">https://docs.microsoft.com/en-us/windows/win32/intl/paper-sizes</a> <br /></p><p><b>paper size|paper height|paper width</b> <br /></p><p>"paper size|paper height|paper width" are read if the "source" value = 256</p><pre xml:space="preserve">
see function void ImpPrinter_SendParameterToServer( ... ) for more details
</pre><p>Example : <br /><br /><img src="../Resources/Images/images_PrintServer-Printer-01.png" /><br /></p><pre xml:space="preserve">
Pattern : duplex|paper source|paper size|paper height|paper width|
ZEBRA   |000004|000256|000508|001680| 
</pre><p>It is important to configure the default parameters correctly to be able to use the Printer, if we cannot use any customized settings : <br /><br /><img src="../Resources/Images/images_PrintServer-Printer-02.png" /><br /></p><pre xml:space="preserve">
Pattern : duplex|paper source|paper size|paper height|paper width|
ECT   |000004|||| 
The value "paper size" is empty, so the PrintServer will use the default parameters for the printer and driver.
</pre><p>The parameter _PrinterDescriptionEx is automatically filled by the Printer an its driver when the printer is created.<br />The PrintServer request the printer and its driver and the result is created in table <code>APRINTDES</code>. <br /><br />See fields <code>[APRINTDES].[PRTDES_0]</code> and <code>[APRINTDES].[PRTDESEX_0]</code></p><p>Exemple of one entry, table APRINTDES: </p><pre xml:space="preserve">
[X3].[APRINTDES], [UPDTICK_0] [int], [COD_0] [nvarchar](10), [NUM_0] [int],[PRTDES_0] [nvarchar](250), [PRTDES_1] [nvarchar](250), [CREUSR_0] [nvarchar](5),    [UPDUSR_0] [nvarchar](5),   [CREDATTIM_0] [datetime],   [UPDDATTIM_0] [datetime],   [AUUID_0] [binary](16), [PRTDESEX_0] [nvarchar](100),   [ROWID] [numeric](38, 0),
1    IMPRIM  1   5C005C00730061006700650069006D0070005C004C0049004C00410053000000/*00740000006500200064006500200050007200/*0074002C004C006F00000001040006.,00-,1F430/)!070100090000000000640001000F005802010001005802030000004100340000000000000     XPSB    XPSB    2015-07-24 17:16:25.000 2015-07-24 17:16:25.000 <binary>   3|000257|000009|||  29
</binary></pre><p>Note the field PRTDESEX_0 and its value : 3|000257|000009|||<br /> <br /></p><h2 id="PrinterCopies" data-magellan-target="PrinterCopies">_PrinterCopies</h2><p>Number of copies of the document to print. <br /><br />Default value = 1 <br /></p><h2 id="PrinterCollate" data-magellan-target="PrinterCollate">_PrinterCollate</h2><p>Default value = 0 <br /></p><p>Collated printing refers to how prints are arranged as they print, and is useful if you are printing more than one large document that needs to be kept in the right order. <br /><br />When a file is too big and needs to be printed across several pages, collated printing will give you page after page and sheet of paper after sheet of paper, while respecting the original series of the pages in the document.<br /><br />Collating documents creates consistency, for example, if you have a document that is five pages long and you wanted to print multiple copies, collating enables it to print pages 1,2,3,4 and 5 in the correct order and then repeat this again if you need more than one copy.<br /></p><h2 id="PrinterStartPage" data-magellan-target="PrinterStartPage">_PrinterStartPage</h2><p>First page to print <br /><br />Default value = 1<br /></p><h2 id="PrinterStopPage" data-magellan-target="PrinterStopPage">_PrinterStopPage</h2><p>Default value = 9999<br /></p><br /></div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#PrintServerPresentationandOperationGuide"> Print Server Presentation and Operation Guide
</a>
                                                    </li>
                                                    <li><a href="#InstallationUninstallation">Installation / Uninstallation</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Prerequisites">Prerequisites</a>
                                                        </li>
                                                        <li><a href="#Installation">Installation</a>
                                                        </li>
                                                        <li><a href="#Uninstallation">Uninstallation</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Configuration">Configuration</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Startupsetup">Startup setup</a>
                                                        </li>
                                                        <li><a href="#ParametersforthedescriptionoftheattachedSAFEX3solutions">Parameters for the description of the attached SAFE X3 solutions</a>
                                                        </li>
                                                        <li><a href="#Advancedsettings">Advanced settings</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Serverstartupstop">Server startup / stop</a>
                                                    </li>
                                                    <li><a href="#Monitoring">Monitoring</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Monitoringwindow">Monitoring window</a>
                                                        </li>
                                                        <li><a href="#Activitylogfileandexceptionlogfile">Activity log file and exception log file</a>
                                                        </li>
                                                        <li><a href="#WindowsEventsViewer">Windows Events Viewer</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Technicalarchitecture">Technical architecture</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Principles">Principles</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Printermanagementanderrorlists">Printer management and error lists</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Errorcodesandmessages">Error codes and messages</a>
                                                        </li>
                                                        <li><a href="#Printservererrorcodes">Print server error codes</a>
                                                        </li>
                                                        <li><a href="#Errorcodesinthecachemanagementmodule">Error codes in the cache management module</a>
                                                        </li>
                                                        <li><a href="#ErrorcodesfortheWindowsservicemanagementmodule">Error codes for the Windows service management module</a>
                                                        </li>
                                                        <li><a href="#ErrorcodesoftheSAFEX3solutionsmanagementmodule">Error codes of the SAFE X3 solutions management module</a>
                                                        </li>
                                                        <li><a href="#ErrorcodesintheODBCmanagementmodule">Error codes in the ODBC management module</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Supportandtroubleshooting">Support and troubleshooting</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Printermanagement">Printer management</a>
                                                        </li>
                                                        <li><a href="#Cannotdetectpreviousinstalledversionafterasetupcrash">Cannot detect previous installed version after a setup crash</a>
                                                        </li>
                                                        <li><a href="#NoinstalledPrinterNohayimpresorasinstaldasPasdimprimanteinstall%C3%A9e">No installed Printer/ No hay impresoras instaldas / Pas d'imprimante installée</a>
                                                        </li>
                                                        <li><a href="#Activationofthelogfiles">Activation of the log files</a>
                                                        </li>
                                                        <li><a href="#EnablelogsinSAPVSStudioCrystalReport">Enable logs in SAP VS Studio Crystal Report</a>
                                                        </li>
                                                        <li><a href="#FontsizereducedwhenexportingtoPDF">Font size reduced when exporting to PDF</a>
                                                        </li>
                                                        <li><a href="#ChinesecharactersnotcorrectlydisplayedinPDF">Chinese characters not correctly displayed in PDF</a>
                                                        </li>
                                                        <li><a href="#SpecialfontsembeddedinPDFdocuments">Special fonts embedded in PDF documents</a>
                                                        </li>
                                                        <li><a href="#UserfunctionLibrariesU212LTextdllandU212ltoword">User function Libraries U212LText.dll and U212ltoword</a>
                                                        </li>
                                                        <li><a href="#U212LTextdll">U212LText.dll</a>
                                                        </li>
                                                        <li><a href="#ParameterssenttothePrintServer">Parameters sent to the PrintServer</a>
                                                        </li>
                                                        <li><a href="#FormatExport">_FormatExport</a>
                                                        </li>
                                                        <li><a href="#DESTINATION">__DESTINATION</a>
                                                        </li>
                                                        <li><a href="#TYPDBA">__TYPDBA</a>
                                                        </li>
                                                        <li><a href="#Orientation">_Orientation</a>
                                                        </li>
                                                        <li><a href="#PaperSize">_PaperSize</a>
                                                        </li>
                                                        <li><a href="#PrinterName">_PrinterName</a>
                                                        </li>
                                                        <li><a href="#PrinterServer">_PrinterServer</a>
                                                        </li>
                                                        <li><a href="#PrinterDriver">_PrinterDriver</a>
                                                        </li>
                                                        <li><a href="#PrinterPort">_PrinterPort</a>
                                                        </li>
                                                        <li><a href="#PrinterDescriptionEx">_PrinterDescriptionEx</a>
                                                        </li>
                                                        <li><a href="#PrinterCopies">_PrinterCopies</a>
                                                        </li>
                                                        <li><a href="#PrinterCollate">_PrinterCollate</a>
                                                        </li>
                                                        <li><a href="#PrinterStartPage">_PrinterStartPage</a>
                                                        </li>
                                                        <li><a href="#PrinterStopPage">_PrinterStopPage</a>
                                                        </li>
                                                    </ul>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">23 January 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>