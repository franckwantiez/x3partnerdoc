<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="Api asyrsarea" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> Api asyrsarea
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/Images/doc.css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript"><![CDATA[


function onload(){
	window.focus();
	window[window.history.pushState ? "onpopstate" : "onhashchange"] = function(event){ windows.focus(); };
}


]]></script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Change language">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="Apiasyrsarea" data-magellan-target="Apiasyrsarea"> Api asyrsarea
</h1>
                                                <p><strong>The version 7 administration platform includes a storage area that manages <a href="administration-reference_documents.html">documents</a>. These documents are stored in the mongodb database, and the storage is logically organized in <a href="administration-reference_storage-volumes-management.html">volumes</a>. A set of APIs is available to access these documents from a Sage X3 Warehousing script. They are described as follows.</strong>
                                                </p>
                                                <p>These APIs are all located in the library called ASYRSAREA. They access the <a href="administration-reference_documents.html">document</a> entity that is described <a href="#datamodel">below</a>.</p>
                                                <p>The different APIs available are the following:</p>
                                                <table>
                                                    <tr>
                                                        <td><a href="#datamodel">Data structure of documents</a>
                                                        </td>
                                                        <td><a href="#list">List documents</a>
                                                        </td>
                                                        <td><a href="#readall">Download a document</a>
                                                        </td>
                                                        <td><a href="#writeall">Upload a document</a>
                                                        </td>
                                                        <td><a href="#remove">Remove a document</a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <h1 id="Datastructureofdocuments" data-magellan-target="Datastructureofdocuments"><a id="datamodel">Data structure of documents</a>
                                                </h1>
                                                <p>The properties in the document entity are the following:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="40%">Description</th>
                                                        <th width="40%">Data type</th>
                                                    </tr>
                                                    <tr>
                                                        <td>documentType</td>
                                                        <td>Document type</td>
                                                        <td>String containing the mime type (for example, "application/ms-word").</td>
                                                    </tr>
                                                    <tr>
                                                        <td>documentDate</td>
                                                        <td>Document date</td>
                                                        <td>Date (year, month, day)</td>
                                                    </tr>
                                                    <tr>
                                                        <td>fileName</td>
                                                        <td>File name</td>
                                                        <td>String containing a file name. This is <b>not a unique key</b> for the document.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>isReadOnly</td>
                                                        <td />
                                                        <td>Binary</td>
                                                    </tr>
                                                    <tr>
                                                        <td>content</td>
                                                        <td>The document by itself</td>
                                                        <td>Binary content of the file.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>className</td>
                                                        <td>Class name is used for Word documents that have been generated from a Word link: the class name is the class connected as a data source to the Word document.</td>
                                                        <td>String</td>
                                                    </tr>
                                                    <tr>
                                                        <td>x3Keys</td>
                                                        <td>Key value is used for Word documents in Word reporting only: it defines the current record used to populate the Word document.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>representationName</td>
                                                        <td>Representation used for Word documents called from a link.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>volume</td>
                                                        <td>[Volume](../administration-reference/storage-volumes-management.md) assigned to the document.</td>
                                                        <td>Reference to a <b>storageVolumes</b> entity (UUID).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>teams</td>
                                                        <td>[Teams](../administration-reference/teams.md) having access to the document.</td>
                                                        <td>Array of references to <b>team</b> entities(UUIDs).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>owner</td>
                                                        <td>[Owner](../administration-reference/users.md) of the document.</td>
                                                        <td>Reference to a <b>user's</b> entity (UUID).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>tags</td>
                                                        <td>[Tags](../administration-reference/tags.md) associated with the document.</td>
                                                        <td>Array of references to <b>documentTags</b> entities (UUIDs).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>endpoint</td>
                                                        <td>[Endpoint](../administration-reference/endpoints.md) from which the Word document has been filled.</td>
                                                        <td>Reference to an <b>EndPoints</b> entity (UUID).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>$creUser</td>
                                                        <td>Login of the [user](../administration-reference/users.md) that created the document.</td>
                                                        <td>String</td>
                                                    </tr>
                                                    <tr>
                                                        <td>$updUser</td>
                                                        <td>Login of the [user](../administration-reference/users.md) that last modified the document.</td>
                                                        <td>String</td>
                                                    </tr>
                                                    <tr>
                                                        <td>$creDate</td>
                                                        <td>Creation date.</td>
                                                        <td>Date/time</td>
                                                    </tr>
                                                    <tr>
                                                        <td>$updDate</td>
                                                        <td>Last modification date</td>
                                                        <td>Date/time</td>
                                                    </tr>
                                                    <tr>
                                                        <td>$uuid</td>
                                                        <td>Unique identifier.</td>
                                                        <td>UUID in canonical representation.</td>
                                                    </tr>
                                                </table>
                                                <p>When an entity is a reference (through a UUID) to another entity, you can with the "dot" notation, access properties of the entity in the 'where' clause. This allows you to give access to the linked properties. When a property is an array, the system will consider the condition as true if at least a member of the array has the right value.</p>
                                                <p>You can have access to the following properties:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="40%">Description</th>
                                                        <th width="40%">Data type</th>
                                                    </tr>
                                                    <tr>
                                                        <td>volume.code</td>
                                                        <td>The code of the volume.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>volume.description</td>
                                                        <td>Description of the volume.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>volume.storageType</td>
                                                        <td>Type of storage (MongoDB or file).</td>
                                                        <td>enumeration ("db_file" or "file").</td>
                                                    </tr>
                                                    <tr>
                                                        <td>volume.path</td>
                                                        <td>Path associated with the volume.</td>
                                                        <td>String</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.login</td>
                                                        <td>User's login.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.title</td>
                                                        <td>User's title.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.firstName</td>
                                                        <td>User's first name.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.lastName</td>
                                                        <td>User's last name.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.active</td>
                                                        <td>Flag user active.</td>
                                                        <td>Boolean</td>
                                                    </tr>
                                                    <tr>
                                                        <td>user.email</td>
                                                        <td>User's email.</td>
                                                        <td>Char</td>
                                                    </tr>
                                                </table>
                                                <h1 id="ListofavolumeLIST" data-magellan-target="ListofavolumeLIST"><a id="list">List of a volume (LIST)</a>
                                                </h1>
                                                <p>This function returns a list of properties associated with documents in the storage area that fulfills some conditions. The properties are given in an array of character strings, and the return is a matrix of strings (every row being a document definition, with the columns corresponding to the properties requested). Additional filters can be given (list of properties associated to values). The properties available in this API are those listed in the Data structure definition.</p>
                                                <h2 id="Parameters" data-magellan-target="Parameters">Parameters</h2>
                                                <p>The parameters are as follows:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="20%">Type and dimension</th>
                                                        <th>Contents</th>
                                                    </tr>
                                                    <tr>
                                                        <td>FILTERS</td>
                                                        <td>Char</td>
                                                        <td>Filter that has to be expressed in api1 syntax.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>EXPECTED_PROPS</td>
                                                        <td>Value Array of Char.</td>
                                                        <td>List of properties that will have to be returned at list execution.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>FUTURE</td>
                                                        <td>Value Integer.</td>
                                                        <td><b>1</b> if the list is called in 'wait' mode, <b>0</b> if called in 'future' mode.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESHEAD</td>
                                                        <td>Variable Clbfile.</td>
                                                        <td>http header answer.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>VALUES</td>
                                                        <td>Variable Char matrix.</td>
                                                        <td>Result of the list execution.</td>
                                                    </tr>
                                                </table>
                                                <p>The return of the function is the HTTP status (<b>200</b> if everything is OK).</p>
                                                <h2 id="Example" data-magellan-target="Example">Example</h2><pre xml:space="preserve"><code>CODECODE CODEsh
# Let's list the volume called STD
# and select only the pdf documents that are in read-only, that have been created by JOHNDOE user
# and that are dated from less than 2 months
# Returns the number of lines filled (and [V]CST_ANOTDEFINED (negative value) if an error occurs
Funprog LIST_MY_PDF(VALUES)
Variable Char VALUES()(1..,1..)
Local Clbfile FILTERS(0)
Local Char PROPERTY(20), EXPECTED_PROPS(20)(1..10)
Local Integer FUTURE,OK, COLNUMBER,I
Local Clbfile RESHEAD(0)
# Filters assignment
  FILTERS =" documentType eq 'application/pdf'"
  FILTERS+=" and volume.code eq 'STD'"
  FILTERS+=" and isReadOnly eq true"
  FILTERS+=" and $creUser eq 'JOHNDOE'"
  FILTERS+=" and $creDate gt'"+format$("D:YYYY[-]MM[-]DD",addmonth(date$,-2))+"'" 
# Properties to be listed : the list can be modified here by using all the columns except content of course
# If the number of columns exceeds the second dimension of VALUES, we stop
  COLNUMBER=0
  For PROPERTY="description", "documentType", "documentDate", "fileName", "isReadOnly", "className",
&amp;                "x3Keys", "representationName", "$uuid"
    Break (COLNUMBER&gt;=dim(VALUES,2))
    COLNUMBER+=1 : EXPECTED_PROPS(COLNUMBER)=PROPERTY
  Next
# Let's assign the future mode (0=wait to get the data)
  FUTURE=0
# It is time to call the API
  OK=Func ASYRSAREA.LIST(FILTERS, EXPECTED_PROPS, FUTURE, RESHEAD, VALUES)
# If OK is not 200, return an error
# RESHEAD is ignored here
  If OK&lt;&gt;200
    End [V]CST_ANOTDEFINED
  Endif
# Count the number of lines returned (stop when a line where all the field are empty is found)
  For I=1 to dim(VALUES,1)
    Break sum(VALUES(I,1..COLNUMBER)="")
  Next I
End I-1</code></pre>
                                                <h1 id="DowloadadocumentREADALL" data-magellan-target="DowloadadocumentREADALL"><a id="readall">Dowload a document (READALL)</a>
                                                </h1>
                                                <p>This function reads a binary document in a BLOB variable from the storage area. The key of the document must be given as a UUID.</p>
                                                <h2 id="Parameters1" data-magellan-target="Parameters1">Parameters</h2>
                                                <p>The parameters are as follows:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="20%">Type and dimension</th>
                                                        <th>Contents</th>
                                                    </tr>
                                                    <tr>
                                                        <td>ID</td>
                                                        <td>Value Char.</td>
                                                        <td>UUID of the document to read.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>FUTURE</td>
                                                        <td>Value Integer.</td>
                                                        <td><b>1</b> if the document creation is called in 'wait' mode, <b>0</b> if called in 'future' mode.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESHEAD</td>
                                                        <td>Variable Clbfile.</td>
                                                        <td>HTTP header answer.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>BLOB_DOC</td>
                                                        <td>Value Blbfile.</td>
                                                        <td>The document to be uploaded.</td>
                                                    </tr>
                                                </table>
                                                <p>The return of the function is the HTTP status (<b>200</b> if everything is OK, <b>403</b> if the document doesn't exist).</p>
                                                <h2 id="Example1" data-magellan-target="Example1">Example</h2><pre xml:space="preserve"><code>CODECODE CODEsh
# Let's search for a document called "journal.log" created today in the "LOG" volume
# If at least one document exists, read it
# Limit the number of documents read to the dimension of MYDOC variable
Local Integer OK
Local Blbfile MYDOC(0)(1..10)
  OK=func GET_DOC("journal.log","LOG",MYDOC)
  If OK=1
    # The document has been found and is unique
  Elsif OK&gt;1
    # If OK&gt;dim(MYDOC), all documents have not been read and the MYDOC array contains the first documents found
    # If OK&lt;=dim(MYDOC), several documents have been found, MYDOC(1..OK) contains them all
  Elsif OK=0
    # The document wasn't found
  Else
    # An error occurred
  Endif
...
# The corresponding funprog 
Funprog GET_DOC(NAME,VOLUME, DOCUMENT)
Value Char NAME()
Value Char VOLUME()
Variable Blbfile DOCUMENT()(1..)
Local Clbfile FILTERS(0)
Local Clbfile RESHEAD(0)
Local Char ID(36)
Local Char EXPECTED_PROPS(20)(1..1)
Local Integer I, OK, K
# Let's list at most the maximum number of document expected + 1
# in order to give the indication that documents weren't read
Local Char VALUES(36)(1..dim(DOCUMENT)+1,1..1)
# First, let's list the documents to get their uuid
# Filters assignment
  FILTERS="fileName eq '"+NAME+"'"
  FILTERS-="and documentDate eq'"+format$("D:4Y[-]2M[-]2D",date$)+"'"
  FILTERS-="and volume.code eq'"+VOLUME+"'"
# Property assignment: we need only the UUID
  EXPECTED_PROPS(1)="$uuid"
# Let's call the list API
  OK=Func ASYRSAREA.LIST(FILTERS, EXPECTED_PROPS, 0, RESHEAD, VALUES)
# If OK is not 200, return an error
# RESHEAD is ignored here
  If OK&lt;&gt;200
    End -1 : # An error occured
  Endif
# Let's count the number of documents found
# Count is limited to VALUES dimension: when an empty string is found, no more document is there
  I=find("",VALUES,"")
# If at least a document was found, get them
  If I&gt;1
    For K=1 To min(I-1,dim(DOCUMENT))
      OK = func ASYRSAREA.READALL(VALUES(K), 0, RESHEAD, DOCUMENT(K))
      Break (OK&lt;&gt;200)
    Next K
    If OK&lt;&gt;200
      End -1
    Endif
  Endif
End I-1
End</code></pre>
                                                <h1 id="UploadadocumentWRITEALL" data-magellan-target="UploadadocumentWRITEALL"><a id="writeall">Upload a document (WRITEALL)</a>
                                                </h1>
                                                <p>This function writes in the storage area a binary document given by a BLOB variable. The key of the document can be given (as an UUID) if a document has to be replaced; if a new document must be created, and if no UUID must be given.</p>
                                                <h2 id="Parameters2" data-magellan-target="Parameters2">Parameters</h2>
                                                <p>The parameters are as follows:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="20%">Type and dimension</th>
                                                        <th>Contents</th>
                                                    </tr>
                                                    <tr>
                                                        <td>BLOB_DOC</td>
                                                        <td>Value Blbfile.</td>
                                                        <td>The document to be uploaded.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>DESCRIPTION</td>
                                                        <td>Value Char.</td>
                                                        <td>The description of the document.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>FILE_NAME</td>
                                                        <td>Value Char.</td>
                                                        <td>The file name associated with the document.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>CONTENT_TYPE</td>
                                                        <td>Value Char.</td>
                                                        <td>A content type (usually a mime type) describing the format of the document.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>PROPS_COD</td>
                                                        <td>Value Array of Char.</td>
                                                        <td>List of properties that also have to be assigned.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>PROPS_VAL</td>
                                                        <td>Value Array of Char.</td>
                                                        <td>List of the values to be assigned to the properties.<br />The values must be expressed as formulas made with constants. This means that a string value must be presented between double quotes in the constant. <b>Examples:</b><ul><li>A string value must be defined as ' "myvalue" '.</li><li>A boolean value must be defined as 'true' or "true".</li><li>A numeric value must be defined as '3.14' or "3.14".</li></ul> </td>
                                                    </tr>
                                                    <tr>
                                                        <td>ID</td>
                                                        <td>Variable Char.</td>
                                                        <td>UUID of the document to be rewritten, empty if a document has to be created. If a document is created, the UUID of the document is returned.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>VOLUME</td>
                                                        <td>Value Char.</td>
                                                        <td>The volume to be used (STD by default).</td>
                                                    </tr>
                                                    <tr>
                                                        <td>FUTURE</td>
                                                        <td>Value Integer.</td>
                                                        <td><b>1</b> if the document creation is called in 'wait' mode, <b>0</b> if called in 'future' mode.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESHEAD</td>
                                                        <td>Variable Clbfile.</td>
                                                        <td>HTTP header answer.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESBODY</td>
                                                        <td>Variable Char Clbfile.</td>
                                                        <td>Result of the upload.</td>
                                                    </tr>
                                                </table>
                                                <p>The return of the function is the HTTP status (200 if everything is OK).</p>
                                                <h2 id="Example2" data-magellan-target="Example2">Example</h2><pre xml:space="preserve"><code>CODECODE CODEsh
# Create a file containing text
Local Char PROPS_COD(20)(1..2)
Local Char PROPS_VAL(100)(1..2)
Local Clbfile RESHEAD(0), DATA(0), TEXT(0)
Local Char ID(50)
Local Blbfile BYTES(0)
# Let's create a document now
  Raz PROPS_COD, PROPS_VAL
  PROPS_COD(1)="documentDate" : PROPS_VAL(1)='"2014-01-01"'
# The content must be stored in a blob
  TEXT="Example of text"+chr$(10)+" - on several lines"+chr$(10)+' - with accents such as I took a dish "à la carte"'
  OK=STRENCODE(TEXT,BYTES,50) : # Blob containing ascii
# Let's create the document
  ID=''
  OK = func ASYRSAREA.WRITEALL(BYTES,"TEST_"+format$("D:YYYY[-]MM[-]DD[ ]hh[:]mm[:]ss",date$),
&amp;                                "test.txt", "plain/text", PROPS_COD, PROPS_VAL,
&amp;                                ID, 'STD', 0, RESHEAD, DATA)
# If OK is equal to 200, ID contains the UUID of the newly created document</code></pre>
                                                <h1 id="RemoveadocumentREMOVE" data-magellan-target="RemoveadocumentREMOVE"><a id="remove">Remove a document (REMOVE)</a>
                                                </h1>
                                                <p>This function removes a document identified by its UUID from the storage area.</p>
                                                <h2 id="Parameters3" data-magellan-target="Parameters3">Parameters</h2>
                                                <p>The parameters are as follows:</p>
                                                <table>
                                                    <tr>
                                                        <th>Code</th>
                                                        <th width="20%">Type and dimension</th>
                                                        <th>Contents</th>
                                                    </tr>
                                                    <tr>
                                                        <td>ID</td>
                                                        <td>Value Char.</td>
                                                        <td>The document ID (UUID) in character format.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>FUTURE</td>
                                                        <td>Value Integer.</td>
                                                        <td><b>1</b> if the document creation is called in 'wait' mode, <b>0</b> if called in 'future' mode.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESHEAD</td>
                                                        <td>Variable Clbfile.</td>
                                                        <td>HTTP header answer.</td>
                                                    </tr>
                                                    <tr>
                                                        <td>RESBODY</td>
                                                        <td>Variable Char Clbfile.</td>
                                                        <td>Result of the upload.</td>
                                                    </tr>
                                                </table>
                                                <p>The return of the function is the HTTP status (200 if everything is OK).</p>
                                                <h2 id="Example3" data-magellan-target="Example3">Example</h2><pre xml:space="preserve"><code>CODECODE CODEsh
# Delete all documents created by a given user today
Funprog DELETE_A_DOCUMENT(VOLUME,USERID)
Variable Char VALUES()(1..,1..)
Local Clbfile FILTERS(0)
Local Char PROPERTY(20), EXPECTED_PROPS(20)(1)
Local Integer FUTURE,OK, RES,I
Local Clbfile RESHEAD(0)
Local Integer I
# Filters assignment
  FILTERS ="volume.code eq '"+VOLUME+"'"
  FILTERS+=" and $creUser eq '"+USERID+"'"
  FILTERS+=" and $creDate eq '"+format$("D:YYYY[-]MM[-]DD",date$)+"'" 
# The only property we need is the UUID
# If the number of columns exceeds the second dimension of VALUES, we stop
  EXPECTED_PROPS(1)="$uuid"
# Let's assign the future mode (0=wait to get the data)
  FUTURE=0
# Let's now list the documents
  OK=Func ASYRSAREA.LIST(FILTERS, EXPECTED_PROPS, FUTURE, RESHEAD, VALUES)
# Now we can delete all the documents (stopping at the first error)
 For I=1 to maxtab(VALUES)
   OK=Func ASYRAREAD.REMOVE(VALUES(I), FUTURE, RESHEAD, RES)
   Break (OK&lt;&gt;200)
 Next I</code></pre>
                                                <br />
                                            </div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#Apiasyrsarea"> Api asyrsarea
</a>
                                                    </li>
                                                    <li><a href="#Datastructureofdocuments">Data structure of documents</a>
                                                    </li>
                                                    <li><a href="#ListofavolumeLIST">List of a volume (LIST)</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Parameters">Parameters</a>
                                                        </li>
                                                        <li><a href="#Example">Example</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#DowloadadocumentREADALL">Dowload a document (READALL)</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Parameters1">Parameters</a>
                                                        </li>
                                                        <li><a href="#Example1">Example</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#UploadadocumentWRITEALL">Upload a document (WRITEALL)</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Parameters2">Parameters</a>
                                                        </li>
                                                        <li><a href="#Example2">Example</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#RemoveadocumentREMOVE">Remove a document (REMOVE)</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Parameters3">Parameters</a>
                                                        </li>
                                                        <li><a href="#Example3">Example</a>
                                                        </li>
                                                    </ul>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">23 January 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>