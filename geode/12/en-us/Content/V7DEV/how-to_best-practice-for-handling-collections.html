<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="Best Practices - Handling Collections" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> Best Practices - Handling Collections
</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/Images/doc.css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript"><![CDATA[


function onload(){
	window.focus();
	window[window.history.pushState ? "onpopstate" : "onhashchange"] = function(event){ windows.focus(); };
}


]]></script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Change language">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="BestPracticesHandlingCollections" data-magellan-target="BestPracticesHandlingCollections"> Best Practices - Handling Collections
</h1>
                                                <p>The purpose of this document is to provide best practices to handle collections.</p>
                                                <p>Collections of child instances are managed as arrays, with additional technical properties and methods that simplify their management. For persistent classes, the supervisor handles all the code, and no additional line needs to be written.</p>
                                                <h2 id="Insertionanddeletion" data-magellan-target="Insertionanddeletion">Insertion and deletion</h2>
                                                <ul>
                                                    <li>Use the ADDLINE method to add a line.</li>
                                                    <li>Use the ADELLINE method to delete a line.</li>
                                                    <li>Use the <a href="developer-guide_event-addline_before.html">ADDLINE_BEFORE</a>, <a href="developer-guide_event-addline_after.html">ADDLINE_AFTER</a>, <a href="developer-guide_event-adelline_before.html">ADELLINE_BEFORE</a>, and <a href="developer-guide_event-adelline_after.html">ADELLINE_AFTER</a> events to add or delete lines in a specific position.</li>
                                                </ul>
                                                <h2 id="Controlrules" data-magellan-target="Controlrules">Control rules</h2>
                                                <ul>
                                                    <li>A consistency control on a single line must be written at the line level.</li>
                                                    <li>A consistency control on several lines must be written at the parent class level.</li>
                                                </ul>
                                                <h2 id="Propagationrules" data-magellan-target="Propagationrules">Propagation rules</h2>
                                                <ul>
                                                    <li>Propagation within a line must be written at the line level.</li>
                                                    <li>Propagation from the header to the line must be written at the header level.</li>
                                                    <li>Propagation between lines is prohibited. Refer to <a href="how-to_best-practice-for-propagating-updates.html">Best Practices - Propagation Rules</a>.</li>
                                                </ul>
                                                <h2 id="Linecount" data-magellan-target="Linecount">Line count</h2>
                                                <ul>
                                                    <li>The line count property is updated <u>after</u> a new line has been entered.</li>
                                                    <li>If you need to know the number of lines during a control, count them using the ASTALIN property value (which cannot equal [V]CST_ANEWDEL or [V]CST_ADEL).</li>
                                                </ul>
                                                <h2 id="Example" data-magellan-target="Example">Example</h2>
                                                <p>The following example of code summarizes the different concepts mentioned above. Every section of this program can be considered autonomously.</p>
                                                <ul>
                                                    <li>A document called MYDOCUMENT, with a key called NUMDOC, includes a collection called HISTORY that displays the list of users having modified this document. It contains the following properties:<br /><ul><li>The key of the document updated (DOCUMENT_UPD).</li><li>The user code (USER_UPD).</li><li>The last update date/time for the user (CRETIM_UPD).</li><li>The number of updates done by the user (NBTIMES_UPD).</li><li>A percentage of updates per user, computed and displayed when the document is read (PERC_UPD).</li></ul></li>
                                                    <li>The user update history is done by calling a dedicated method, either during the control in CRUD operations (such as the <a href="developer-guide_event-ainsert_control_before.html">AINSERT_CONTROL_BEFORE</a> and <a href="developer-guide_event-aupdate_control_before.html">AUPDATE_CONTROL_BEFORE</a> events), or through a dedicated link called in an edit facet. This method, called UPDATE_HISTORY, performs the following actions:<br /><ul><li>A user line history is added for the current user.</li><li>It keeps up to 10 lines in the history. If an additional line is entered, the oldest line is deleted.</li><li>The lines that record updates older than five years are purged, except for the current user.</li><li>The first line in the history corresponds to the latest update.</li></ul></li>
                                                </ul>
                                                <p>To handle this, the code is created at the document class level.</p><pre xml:space="preserve">#
# The history update is done after all the other controls, and before launching the update or the creation actions.
# The percentage of update number is computed after read (if creation, no history exists)
$METHODS
 Case CURPTH
   When "HISTORY" : # Events on a collection
     Case ACTION
       When "ADDLINE_AFTER"
         Gosub INIT_HISTORY_LINE
     Endcase
   When ""        : # Global events
     Case ACTION
       When "UPDATE_HISTORY"
         Gosub UPDATE_HISTORY
       When "READ_AFTER"
         Gosub COMPUTE_HISTORY
     Endcase
  Endcase
Return
$INIT_HISTORY_LINE
  this.DOCUMENT_UPD = this.APARENT.MYDOC
  this.USER_UPD=this.ACTX.USER
  this.CRETIM_UPD=timestamp$
  this.NBTIMES_UPD=1
Return
# A propagation rule is triggered on the history if document number is changed
$PROPERTIES
 Case CURPRO
   When "NUMDOC"
     Case ACTION
       When "PROPAGATE"
         Gosub PROPAGATE_NUMDOC
     Endcase
  Endcase
Return
# Dedicated method usually called before the creation and the update
# Updates the history lines
# "this" is the current document instance
$UPDATE_HISTORY
Local Integer NUML, TWO_YEARS, OLDLINE, NEWLINE, NBLINES, OK, FIVE_YEARS
Local Decimal TIMESTP
# Inititialize values: current timestamp value in milliseconds, number of days for the last 5 years...
  TIMESTP=val(timestamp$)
  FIVE_YEARS=(date$-gdat$(day(date$),month(date$),year(date$)-5))
  OK=[V]CST_AOK
  OLDLINE=0
# Delete the line that is too old (if it is still present and not associated with the user)
# Compute also in this loop OLDNUM: If not null, the user is already present
  OK=0
  For NUML=1 To maxtab(this.HISTORY)
    If  this.HISTORY(NUML)&lt;&gt;null : # The pointer can be null if a first validation has been done
      If find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
        If this.HISTORY(NUML).USER_UPD=this.ACTX.USER
          OLDLINE=NUML
        Elsif val(this.CRETIME_UPD)+FIVE_YEARS*24*3600*1000&lt;TIMESTP : # Timestamps are in milliseconds
          OK=fmet this.ADELLINE("HISTORY",NUML)
          Break (OK&lt;&gt;[V]CST_AOK)
        Endif
      Endif
    Endif
  Next NUML
# Handle the error
  If OK&lt;&gt;[V]CST_AOK
    ASTATUS=fmet this.ASETERROR("","Cannot delete line from history"-num$(NUML),[V]CST_AERROR)
    Return
  Endif
# Insert a line at the first position of the grid to store the most recent user updating the document
  NEWLINE=fmet this.ADDLINE("HISTORY",[V]CST_AFIRSTPOS)
  If NEWLINE=[V]CST_ANOTDEFINED
    ASTATUS=fmet this.ASETERROR("","Cannot add line in history",[V]CST_AERROR)
    Return
  Endif
# If a line already existed for the customer, update the last line and delete the previous one
  If OLDLINE&lt;&gt;0
    this.HISTORY(NEWLINE).NBTIMES_UPD=this.HISTORY(OLDLINE).NBTIMES_UPD+1
    OK=fmet this.ADELLINE("HISTORY",OLDLINE)
  Endif
# Handle the error
  If OK&lt;&gt;[V]CST_AOK
    ASTATUS=fmet this.ASETERROR("","Cannot delete line from history"-num$(NUML),[V]CST_AERROR)
    Return
  Endif
# Count the number of lines in the collection
  NBLINES=0
  For NUML=1 To maxtab(this.HISTORY)
    If  this.HISTORY(NUML)&lt;&gt;null &amp; find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
      NBLINES+=1
    Endif
  Next NUML
# Delete the line having an index over 10
# Here the technical property AORDER is used
# But the AGETINDBYLINE method could also have been used
  If NBLINES&gt;10
    OK=[V]CST_AOK
    For NUML=1 To maxtab(this.HISTORY)
      If  this.HISTORY(NUML)&lt;&gt;null &amp; find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
        If this.HISTORY(NUML).AORDER&gt;10
          OK=fmet this.ADELLINE("HISTORY",NUML)
          Break (OK&lt;&gt;[V]CST_AOK)
        Endif
      Endif
    Next NUML
  Endif
# Handle the error
  If OK&lt;&gt;[V]CST_AOK
    ASTATUS=fmet this.ASETERROR("","Cannot delete line from history"-num$(NUML),[V]CST_AERROR)
    Return
  Endif
Return
$PROPAGATE_NUMDOC
  For NUML=1 To maxtab(this.HISTORY)
    If  this.HISTORY(NUML)&lt;&gt;null &amp; find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
      this.HISTORY(NUML).DOCUMENT_UPD = this.MYDOC
    Endif
  Next NUML
Return
# Computes the percentage of updates
$COMPUTE_HISTORY
Local Integer NBLINE, TOTLINE
# Count the number of lines in the collection and the total
  NBLINES=0
  For NUML=1 To maxtab(this.HISTORY)
    If  this.HISTORY(NUML)&lt;&gt;null &amp; find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
      NBLINES+=1
      TOTLINE+=this.HISTORY(NUML).NBTIMES_UPD
    Endif
  Next NUML
# Assign the percentages
  For NUML=1 To maxtab(this.HISTORY)
    If  this.HISTORY(NUML)&lt;&gt;null &amp; find(this.HISTORY(NUML).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
      this.HISTORY(NUML).PERC_UPD=ar2(100*this.HISTORY(NUML).NBTIMES_UPD/TOTLINE)
    Endif
  Next NUML
Return</pre>
                                                <p>Refer to the <a href="developer-guide_classes-standard-methods.html">Classes Standard Methods Developer Guide</a> for more information on collections.</p>
                                                <br />
                                            </div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#BestPracticesHandlingCollections"> Best Practices - Handling Collections
</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Insertionanddeletion">Insertion and deletion</a>
                                                        </li>
                                                        <li><a href="#Controlrules">Control rules</a>
                                                        </li>
                                                        <li><a href="#Propagationrules">Propagation rules</a>
                                                        </li>
                                                        <li><a href="#Linecount">Line count</a>
                                                        </li>
                                                        <li><a href="#Example">Example</a>
                                                        </li>
                                                    </ul>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">23 January 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>