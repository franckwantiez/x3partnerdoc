<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="es-es" xml:lang="es-es" class="_Skins_Sage_Skin_SideNav" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta charset="utf-8" />
        <meta name="description" content="Print Server Presentation and Operation Guide" />
        <meta name="module" content="Platform" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title> Print Server Presentation and Operation Guide
  </title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Sage.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/font-awesome.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: #000000 url('../../Skins/Default/Stylesheets/Images/60x60_globe_white-on-transparent_icon.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/TableStyles/NormalRows.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script type="text/javascript">/*<![CDATA[*/


    function onload() {
      window.focus();
      window[window.history.pushState ? "onpopstate" : "onhashchange"] = function (event) { windows.focus(); };
    }


    /*]]>*/</script>
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Atrás" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Saltar a contenido principal</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Cuenta</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Configuración</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Cerrar sesión</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Mostrar panel de navegación" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logotipo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Cuenta</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Configuración</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Cerrar sesión</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Campo de búsqueda" placeholder="Buscar" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filtro:</span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Filtro de búsqueda" title="Todos los archivos" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">Todos los archivos</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Buscar" role="button" tabindex="0"><span class="invisible-label">Enviar búsqueda</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <script type="text/javascript">/*<![CDATA[*/$(document).ready(function(){
			$("#selectlang").appendTo("div.central-account-wrapper");
		});/*]]>*/</script>
                                    <div id="selectlang" class="headerlang">
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Language_toggle mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie select-language-button" title="Cambiar idioma">
                                                    <div>
                                                        <div role="img" class="button-icon-wrapper" aria-label="Cambiar idioma">
                                                            <div class="button-icon"> </div>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="sage-header-title">
                                        <img id="sage-header-logo" src="../Resources/Images/Sage_logo_green.svg" alt="Sage" /><span id="sage-header-product-name"><span id="sage-header-product"><span class="mc-variable Sage-Product.ProductName variable">X3 Warehousing</span></span></span>
                                    </div>
                                    <section class="sage-topic-body sage-layout-two-columns">
                                        <div class="sage-layout-topic-main">
                                            <div role="main" id="mc-main-content">
                                                <h1 id="PrintServerPresentationandOperationGuide" data-magellan-target="PrintServerPresentationandOperationGuide"> Print Server Presentation and Operation Guide
  </h1>
                                                <!-- Public -->
                                                <p>The SAFE X3 print server processes the print requests coming from the different entities of one or more SAFE X3
    solutions in a concurrent manner.</p>
                                                <p>Depending on global system availability, each print request saved at the server level is addressed in a dedicated
    print process.</p>
                                                <p>The entity that has submitted a request can ask the print server to either recover its current status, modify
    certain attributes, or delete it at any moment.</p>
                                                <p>The following table shows the different sections of this document: </p>
                                                <table bgcolor="white" style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0">
                                                    <tr class="TableStyle-NormalRows-Body-Body2">
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#installation/unistallation">Installation / Uninstallation</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#configuration">Configuration</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#server%20startup/stop">Server startup / stop</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#monitoring">Monitoring</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#technical%20architecture">Technical architecture</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyE-Column1-Body2"><a href="#printer%20management">Printer management and error lists</a>
                                                        </td>
                                                        <td class="TableStyle-NormalRows-BodyD-Column1-Body2"><a href="#printer%20support%20and%20troubleshooting">Support and troubleshooting</a>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <div style="page-break-after: always;">
                                                </div>
                                                <h1 id="InstallationUninstallation" data-magellan-target="InstallationUninstallation"><a id="installation/unistallation">Installation / Uninstallation</a>
                                                </h1>
                                                <h2 id="Prerequisites" data-magellan-target="Prerequisites">Prerequisites</h2>
                                                <p>Before starting the installation of a print server, check the <a href="prerequisites_print-server-on-windows.html">configuration requirements</a>.</p>
                                                <h2 id="Installation" data-magellan-target="Installation">Installation</h2>
                                                <p>The installation program allows you to place the executable files, libraries, and other resources necessary for the
    correct execution of the Print Server in the folder of your choosing. The following tree structure is then created
    in the installation folder:</p>
                                                <ul>
                                                    <li><b>Root folder</b>: Contains all the server binary codes.</li>
                                                    <li><b>Config folder</b>: Contains a set of XML files: <code>adxeditionserverconfig.xml</code>, <code>adxeditionserversolutions.xml</code> and <code>AdxOdbcConfig.xml</code>. 
      These XML files are automatically updated and maintained by the the Administration Console and used:
      <ul><li><b>During server startup:</b> startup parameters.</li><li><b>Upon automatic creation of the ODBC data source:</b> external descriptions of the ODBC pilots.</li><li><b>During the implementation cycle:</b> description parameters for the SAFE X3 solutions attached to the server.</li></ul></li>
                                                    <li><b>Data folder</b>: Contains all the internal server cache files. It stores, among others, the Crystal Report reports coming from the SAFE X3 applications attached to the server.</li>
                                                    <li><b>Log folder</b>: Contains:
      <ul><li>The activity log and the exception log (<code>*.log</code>).</li><li>The recovery files used after an unexpected server shutdown (<code>*.bin</code>).</li><li>The report for the server shutdown (<code>_AdxSrvShutdown_Inf.htm</code>).</li></ul></li>
                                                    <li><b>Lan folder</b>: Contains the localization files. If required, these files are updated during patch list installation.</li>
                                                    <li><b>Temp folder</b>: Collects the temporary files. It must be emptied regularly, depending on its volume. <b>Note:</b> The server has to be stopped when emptying the folder.</li>
                                                    <li><b>Redist folder</b>: Contains setups of components used by the Print Server, like Microsft ODBC SQL, Oracle InstantClient, Oracle SQL Plus, Microsoft .Net Framework or Microsoft Visual C++ Redistribuable.</li>
                                                    <li><b>Tools folder:</b> Contains the server administration components driven by the SAFE X3 administration console, as well as the associated utilities.</li>
                                                </ul>
                                                <h2 id="Uninstallation" data-magellan-target="Uninstallation">Uninstallation</h2>
                                                <p>Before uninstalling the Print Server, you first need to unpublish the SAFE X3 solutions attached to the Print Server by using the SAFE X3 Administration Console. 
    After, you can go to the control panel and click <b>Add/Remove programs</b>.
  </p>
                                                <div style="page-break-after: always;">
                                                </div>
                                                <h1 id="Configuration" data-magellan-target="Configuration"><a id="configuration">Configuration</a>
                                                </h1>
                                                <p>Like the other Server components of an X3 solution, the Print Server is configured using the Administration Console. </p>
                                                <p>Users should not manually modify the configuration files produced and updated by the Administration Console. </p>
                                                <p>For more information, refer to the <a href="prerequisites_console.html">Administration Console</a> documentation.</p>
                                                <h2 id="Startupsetup" data-magellan-target="Startupsetup">Startup setup</h2>
                                                <p>These parameters allow the configuration of the technical execution environment of the Print Server.</p>
                                                <p>They are stored in the <code>adxeditionserverconfig.xml</code> file in the Config folder and include:</p>
                                                <ul><pre>
      &lt;general odbcuserdsn="0" adxsolprf="DEFAULT" lang="ENG" log="0" port="1890" restartrpts="1"
      prefixname="Safe_X3_SE_V2" prefixtitle="Safe_X3_SrvEdt_V2_EDT_" description="Sage X3 PrintServer" user="" pwd=""
      hostname="" installpath="C:\Sage\SafeX3\PRTSRV" /&gt;
    </pre>
                                                    <li><b>lang</b>: Language used by the server to display messages. The server can print multilanguage reports regardless of the operating language code.</li>
                                                    <li><b>port</b>: TCP/IP listening port number number the Print Server uses to listen to incoming connections.</li>
                                                    <li><b>restartrpts</b>: Used to set the default management policy for the Recovery mode when the server quits unexpectedly.</li>
                                                    <li><b>OdbcUserDSN</b>: Create ODBC Datasource System/User while configuring the Print Server. Default: 0 = System DSN. 1 = User DSN. This parameter is available from Print Server 2.25.</li><pre>
      &lt;jobs max="300" purgetime="300" successfuljobsstatusretention="10" failedjobsstatusretention="15" vpalloc="40" /&gt;
    </pre>
                                                    <li><b>max</b>: Maximum number of requests that can be stacked by the Print Server. Default value: 300. This parameter must be adjusted depending on the current maximum load of the Print Server.</li>
                                                    <li><b>purgetime</b>:  Time before automatic deletion of an untreated print request. purgetime is expressed in minutes. To purge a request, the printout must not be in 'execution' mode. 
      It the printout is in 'execution' mode, it has exceeded the limit or given out an error. 
      <b>Note:</b> printings in current execution are not taken into account. They are processed in the purge at the 'processus' level.
    </li>
                                                    <li><b>SuccessfulJobsStatusRetention</b>: Time before automatic deletion of a print status, expressed in minutes. Default value: 0 minutes. 
      To purge a status from the queue, the print process needs to be completed with success status and the timeout expressed has been exceeded. 
      This parameter is available from Print Server 2.29 (2023.10 - 2023 R2).<br /><img src="../Resources/Images/images_PrintServer-Processes-01_640x236.png" alt="Configuration of Print processes" style="width: 640;height: 236;" /><br /></li>
                                                    <li><b>FailedJobsStatusRetention</b>: Time before automatic deletion of a print status, expressed in minutes. Default value: 15 minutes. 
      To purge a status from the queue, the printout must have failed and must not be in 'execution' mode after the declared time has elapsed. 
      This parameter is available from Print Server 2.29 (2023.10 - 2023 R2).<br /><img src="../Resources/Images/images_PrintServer-Processes-02_640x237.png" alt="Configuration of Print processes" style="width: 640;height: 237;" /><br /></li>
                                                    <li><b>vpalloc</b>: Describes how the Print Server uses shared memory segments to exchange data with its print processes. Default value: 40. 
      The maximum size of the shared memory segments must be set during server startup, as you cannot dynamically extend them. 
      If the size allocated at startup is not sufficient for the standard use context, the Print Server displays an error 266. 
      In this case, you need to stop the server, modify the value of vpalloc through the "Administration Console", and restart the server. 
      <b>Note:</b> The default value assigned to this parameter should be high enough to avoid this type of error under normal conditions of use.
    </li>
                                                    <li>These parameters can also be added via Console. To do that, you must select <b>Expert Mode</b> and then select the menu <b>Print processes</b>:<br /><img src="../Resources/Images/images_PrintServer-Processes-03_640x813.png" alt="Configuration of Print processes" style="width: 640;height: 813;" /><br /></li><pre>
      &lt;processes killtime="20" max="5" min="1" maxjobsbyprocess="10" /&gt;
    </pre>
                                                    <li><b>killtime</b>: How long it takes for the Print Server to kill an idle child process. killtime is expressed in minutes. Default value: 20 minutes.</li>
                                                    <li><b>max</b>: Maximum number of print processes the Print Server is authorized to launch in parallel. 
      When the maximum number of processes is reached, the server stacks up the new print requests in the pending request stack. 
      These requests are then processed when one of the processes becomes available. 
      <b>Note:</b> The "max" parameter must be adjusted depending on the average number of requests to be submitted and the global availability desired for the system.
    </li>
                                                    <li><b>maxjobsbyprocess</b>: The maximum number of jobs that a print process can handle before committing suicide. Default value: 10. 
      The definition of this parameter can avoid memory leaks that can cause the SAP Crystal Report engine to stop.
    </li><pre>
      &lt;log number="3" size="2000000" /&gt;
    </pre>
                                                    <li><b>Characteristics of the server activity and exception log files</b>: Corresponds to a series of parameters that activate and, if needed, set a size for the server activity and exception log files. 
      The sizing consists in setting the number of archive volumes for the log files, and their maximum size (in bytes). 
      Each volume is physically associated with a file stored in the Log subfolder of the server. 
      When the current volume has reached its maximum size (or when the server starts), the archive volumes are swapped to free a volume. 
      The current volume is archived in the process.
    </li>
                                                </ul>
                                                <br /><b>Example of the <code>adxeditionserverconfig.xml</code> file</b>:
  <pre xml:space="preserve">
    <code>
      &lt;AdxSrvImp xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>" xmlns:xsd="<a href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a>"&gt;
        &lt;config cap="Default configuration" id="DEFAULT"&gt;
          &lt;general AdxSolPrf="DEFAULT" lang="ENG" log="0" port="1890" restartrpts="1" OdbcUserDSN="0" prefixname="Safe_X3_SE_V2" prefixtitle="Safe_X3_SrvEdt_V2_EDT_" description="Sage X3 PrintServer" user="FranckDep" pwd="" hostname="" installPath="" /&gt;
          &lt;jobs max="300" purgetime="300" SuccessfulJobsStatusRetention="10" FailedJobsStatusRetention="15" vpalloc="40" /&gt;
          &lt;log number="3" size="2000000" /&gt;
        &lt;processes killtime="20" max="5" min="1" maxjobsbyprocess="10" /&gt;
      &lt;/config&gt;
      &lt;/AdxSrvImp&gt;
    </code>
  </pre><h2 id="ParametersforthedescriptionoftheattachedSAFEX3solutions" data-magellan-target="ParametersforthedescriptionoftheattachedSAFEX3solutions">Parameters for the description of the attached SAFE X3 solutions</h2><p>The print server can only process print requests coming from a SAFE X3 technology application that belongs to a published solution.</p><p>The parameters used to describe the SAFE X3 solutions attached to the print server are stored in the <code>adxeditionserversolutions.xml</code> file in the Config subfolder.</p><p>This file is updated by the SAFE X3 administration console after the publication of a solution.</p><p>The tree structure of the file describes a solution profile. This notion is reserved for future use. Currently, only the <code>ADMIN</code> profile code is used.</p><p>Each profile has 1 to <i>n</i> solutions, and each solution contains:</p><ul><li>The applications associated with the solution.</li><li>The parameters for the connection to the SADFSQ file server of the solution, including the authentication mode that needs to be used.</li><li>The parameters for the connection to the database server of the solution.</li></ul><h2 id="Advancedsettings" data-magellan-target="Advancedsettings">Advanced settings</h2><p>To be able to run a print server Windows service with a non-administrator user, you can add or modify the <b>REG_DWORD</b> registry entry with a suitable value:</p><ul><li><b>Availability</b>: EDT.208 or higher.</li><li><b>Description</b>: Controls the Print Server behavior regarding TCP port and ODBC datasource management.</li><li><b>Subkey</b>: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\GENERAL</code><ul><li><b>Entry</b>: AdvancedSrvOpt.</li><li><b>Value Type</b>: REG_DWORD, number.</li><li><b>Valid values range</b>: [0-3].
          <ul><li><b>0</b>: The TCP port is registered in the <code>etc/services</code> file, and the ODBC source is created as a System DSN.</li><li><b>1</b>: The TCP port is no longer registered  in the <code>etc/services</code> file.</li><li><b>2</b>: The ODBC source is created as a User DSN.</li><li><b>3</b>: Combination of values 1 and 2. With this setting, the Print Server Windows service can be run with a non-administrator user. The default value is 0. 
              <b>Note:</b> You must create the registry sub key with value 3 before you configure the component through the administration console in order to allow the Print Server to run with a non-administrator user.
            </li></ul></li></ul></li></ul><br /><p>To be able to turn on debug mode for the Crystal Report U212Ltext.dll embedded functions, you can add or modify the <b>REG_SZ</b> registry entry with a suitable value:</p><ul><li><b>Availability</b>: EDT.102 or higher.</li><li><b>Description</b>: Turns on/off the debug mode for the Crystal Report <code>U212Ltext.dll</code> embedded functions.</li><li><b>Subkey</b>: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\REPORT</code><ul><li><b>Entry</b>: U2LTEXT_TraceMode.</li><li><b>Value Type</b>: REG_SZ, string.</li><li><b>Valid values range</b>: [ON-OFF].
          <ul><li><b>OFF</b>: Debug is turned off.</li><li><b>ON</b>: Debug is turned off, and the trace file is generated in <code>%TEMP%\u212ltext.log</code>.</li></ul></li></ul></li></ul><br /><h1 id="Serverstartupstop" data-magellan-target="Serverstartupstop"><a id="server startup/stop">Server startup / stop</a></h1><p>A Print Server can be started in Console mode or in Windows service mode.</p><p>The function of the server is strictly identical in both modes.</p><p>The only difference is that in Console mode, server activity is displayed on the screen in the Windows panel.</p><p>During the first server configuration from the SAFE Administration Console, the Console automatically creates a Windows Service, associated with the server by default.</p><p>You can start and stop this service from the administration console. You can also use standard tools in the Windows system to administer and control the service.</p><p><b>Note:</b> The Print Server startup options described below are available both in Console and Windows Service modes.</p><ul><li><b>Launch of the server in Recovery mode (<code>/recovery:status</code>):</b> In case a Print Server unexpectedly shuts down during processing, the stack of print requests that are pending or in progress is serialized in a binary file. 
      The content of this file can be reviewed in the shutdown report stored in the log subfolder (<code>_AdxSrvShutdown_Inf.html</code> file). 
      The Recovery mode is used to tell the server to start loading the previously stored stack of requests before starting the listening service. 
      The print requests that were stopped during the involuntary shutdown are automatically recovered and submitted to the print system. 
      When this option is activated, the recovered requests are stored in the activity log of the server. 
      <b>Note:</b> This option can be used to force the Recovery policy set up in the administration console: 
      <ul><li>Set the status value to 1 to force the activation of the Recovery mode.</li><li>Set the status value to 0 to force the deactivation of the Recovery mode.</li></ul></li><li><b>Activation of the log file (<code>/d</code>):</b> This option produces a file (<code>AdxSrvlmp_Trace.log</code>) that logs the activity of the Print Server and of the printing processes that are launched.
      This file is stored in the temporary folder of the Print Server. 
      <b>Note:</b> This option must be used in case of problems to facilitate the analysis and correction of the incidents submitted to the Sage customer care services.
    </li><li><b>Launch in console mode (<code>/noservice</code>):</b> This option is used to force the Print Server to run in Console mode, instead of Windows service mode.</li><li><b>Deactivation of the control and configuration of the ODBC sources (<code>/noodbc</code>):</b> The Print Server uses ODBC data sources to connect to the data servers of the SAFE X3 solutions linked to it. 
      When you launch the server with this option, it does not manage the creation, control and configuration of these data sources. 
      As a result, the user has to create and correctly configure the ODBC data sources, based on the characteristics of the different $$SAFE solutions attached to the server.
    </li><li><b>Launch using a configuration profile different from the default profile (<code>/cfg:cdprofil</code>):</b> Reserved for future use.</li><li><b>Deletion of a previously created Windows service (<code>/rmsvc:cdservice</code>):</b> The Print Server automatically stops after deleting the required service.</li><li><b>Display of the Print Server version (<code>/v</code>):</b> Available in Console mode only.</li></ul><br /><b>Example of a command for server startup and the corresponding output:</b><pre xml:space="preserve">
    AdxSrvImp.exe /noservice /d /verbose /noodbc
  </pre><br /><img src="../Resources/Images/images_PrintServer-Service-02_640x616.png" alt="Launching PrintServer" style="width: 640;height: 616;" /><div style="page-break-after: always;"></div><h1 id="Monitoring" data-magellan-target="Monitoring"><a id="monitoring">Monitoring</a></h1><p>You can follow the server activity by consulting the activity log file, Windows Events Viewer, or by accessing the <b>Print Monitor</b> function available in each SAFE X3 folder. 
    This function is available even if the server has not been started with the <code>/d</code> log file option.
  </p><h2 id="Monitoringwindow" data-magellan-target="Monitoringwindow">Monitoring window</h2><p>Connect to the print monitor function (PSIMP) in Classic mode to display this window. Enter the name and port of the Print Server to display data related to the server activity.</p><br /><img src="../Resources/Images/images_print_server_2017r6_640x583.jpg" alt="PSIMP function" style="width: 640;height: 583;" /><p>From this screen, you can:</p><ul><li>View the server startup parameters.</li><li>View the current TCP/IP sessions.</li><li>View and modify the parameters associated with the requests that are either stacked or in progress.</li></ul><h2 id="MonitoringServiceREST" data-magellan-target="MonitoringServiceREST">Monitoring: Service REST</h2><p>To monitor the Print Server with REST, you need the latest Syracuse Web server.</p><p><b>Note:</b> It is only possible to monitor the Print Server with REST from Print Server 2.29 (2023.10 - 2023 R2) and SyracuseWeb Server 12.0.34 (2023.09 - 2023 R2).</p><p><b>You can monitor the Print Server with REST through the PSIMP page:</b></p><br /><img src="../Resources/Images/images_PrintServer-RESTPrintJobsQueue_480x706.jpg" alt="PSIMP" style="width: 480;height: 706;" /><p><b>Example:</b></p><pre>GET <a href="http://SyracuseHostname:8124/print/PrintServerHostName:1890/$jobs">http://SyracuseHostname:8124/print/PrintServerHostName:1890/$jobs</a></pre><pre xml:space="preserve">
    <code>
    [
      {
        "order": 1,
        "rank": 15,
        "processId": 0,
        "state": "Finished",
        "serverDuration": 883,
        "processDuration": 10,
        "status": "OK",
        "phase": "Printing is completed.",
        "destination": "File",
        "report": "ATABLIST.rpt",
        "application": {
          "folder": "SEED10",
          "host": "FRPO402328.sagefr.adinternal.com",
          "port": "20130"
        },
        "user": "ADMIN",
        "workstation": "FRPO402328.sagefr.adinternal.com",
        "linked": null
      }
    ]
    </code>
  </pre><p>You can also interrogate the REST Web service with a web browser or with Postman.</p><p>To do this, you need to authenticate with <code>admin/admin</code> <a href="http://aws-li-syrinteg.sagex3rd.local:8124">online</a>.</p><p>After anthenticating, you can interrogate the REST webservice.</p><p><b>Example of an interrogations with PrintJobs:</b></p><code>http://aws-x3-indcloud.sagex3rd.local:8124/print/aytrad.sagex3rd.local:1890/$jobs</code><pre>
  "processId": number [0- 65535]. If processId == 0, means the Print process is finished, otherwise, processId &gt; 0
  "state": string ["Finished" / "InProgress" / "Standby"]
  "status": string ["OK" / "Error"]. Current status of the process. "OK" doesn't mean the process is finished. 
  "serverDuration": time elapse since the process was started. This time is incrementing as long as the job or its status are in the list, even if the process is finished.
  "processDuration": processing time for this job
  </pre><h2 id="Activitylogfileandexceptionlogfile" data-magellan-target="Activitylogfileandexceptionlogfile">Activity log file and exception log file</h2><p>The activity log file records saving, submission, termination, and deletion events related to a print request.</p><p>The exception log file records all errors and anomalies detected by the server.</p><p>These log files are activated and set up by the server administration console.</p><p><b>Note</b>: The exception log file automatically inherits the setup of the activity log file. Refer to <a href="#activity-exception">Configuration</a> for more information.</p><h2 id="WindowsEventsViewer" data-magellan-target="WindowsEventsViewer">Windows Events Viewer</h2><p>All the information, warnings and error messages issued by the print server or one of the print processes are displayed in the Windows Events Viewer.</p><div style="page-break-after: always;"></div><h1 id="Technicalarchitecture" data-magellan-target="Technicalarchitecture"><a id="technical architecture">Technical architecture</a></h1><p>The diagram below shows the simplified technical architecture of the print server.</p><img src="../Resources/Images/images_PrintServer-processes_640x1998.png" alt="Technical architecture" style="width: 640;height: 1998;" /><h2 id="Principles" data-magellan-target="Principles">Principles</h2><p>The Print Server is a multiprocessing server which maintains and controls a pool of specialized processes.</p><p>The production of Crystal Report reports is the only function of these processes.</p><p>The server manages the preparation and formatting of all the information necessary for the correct production of printouts and the execution of the print processes.</p><p>The main logical components of the server are described below:</p><ul><li><b>TCP/IP listening service:</b> Whenever a client sets up a TCP/IP connection to the Print Server service, it creates a client thread dedicated to the management of the requests coming from this client. 
      There are as many client threads as there are connected clients.
    </li><li><b>Technological services:</b> <b>Technological services:</b> These services ensure the integrity of the server, and mainly control the access to shared resources. 
      A specialized technical service also manages the creation, configuration, and control of the ODBC data sources (Oracle or SQLServer) necessary for the print processes to access the database servers of the attached SAFE X3 solutions. 
      For Oracle data sources, the Print Server supports versions 9, 10, and 11 of the Oracle Net client, and Wire Protocol type ODBC Oracle drivers. 
      The user account under which the Print Server is launched requires sufficient rights and privileges to create the ODBC system data sources and the Oracle Net aliases. 
      The user can manually create the ODBC data sources by using startup option <code>/noodbc</code>, if required.
    </li><li><b>Basic services:</b> The Print Server processes basic functional services. The main ones are:
      <ul><li>Saving and formatting the parameters associated with a print request.</li><li>Printer selection.</li><li>Printer configuration.</li><li>Monitoring requests in progress.</li></ul></li><li><b>File transfer:</b> Managing a print request coming from a SAFE X3 application often requires to load files stored in this application (for example, the <code>.rpt</code> report file). 
      The Print Server operates with SAFE X3 (SADFSQ) file servers. 
      It establishes a TCP/IP connection with the corresponding application servers associated with it to communicate with them.
    </li><li><b>Print processes:</b> When the Print Server finishes preparing a print request, and depending on system availability, it launches a print process that manages the final production of the report. 
      The main task of this print process is to initialize and call the Crystal Report print engine which produces the requested report. 
      A print process then accesses the Print Server shared memory to determine if the server has pending print requests. 
      If it is the case, it will process the first eligible request. 
      If there are no eligible or pending requests, the print process ends automatically. 
      The maximum number of concurrent print processes for a Print Server can be set up using the SAFE X3 administration console.
    </li><li><b>Shared memory:</b> The Print Server loads several segments of shared memory to exchange information with the print processes that it is able to create. 
      Access to these segments is carried out in an exclusive manner, based on the interprocess synchronization objects of mutual exclusion type.
    </li></ul><div style="page-break-after: always;"></div><h1 id="Printermanagementanderrorlists" data-magellan-target="Printermanagementanderrorlists"><a id="printer management">Printer management and error lists</a></h1><p>The following set of rules make sure the printing operation is carried out correctly:</p><ul><li>If the Print Server is started in Windows service mode, you need to indicate a different startup account from the Local system account so that the Print Server can access one of the printers in your organization. 
      No printer is attached to the Local system Windows account.
    </li><li>At least one printer must be set up on the user account used to start the Print Server (in Console mode or in Windows service mode).</li><br /><img src="../Resources/Images/images_PrintServer-Service-01_480x500.png" style="width: 480;height: 500;" /><br /><li>The Print Server can only address printers that are visible and accessible to the user account with which the server was started (in Console mode or in Windows service mode).</li><li>When printing in PDF format, the parameters relating to the document size are inherited from the default paper size of the printer associated with the user account with which the server was started (in Console mode or in Windows service mode).</li></ul><h2 id="Errorcodesandmessages" data-magellan-target="Errorcodesandmessages">Error codes and messages</h2><p>The message associated with an error code refers to the following:</p><ul><li>The error code.</li><li>The type of message (64: information; 48: warning; 16: error).</li><li>The function the error came from.</li><li>The context (in the form of a character string).</li></ul><p>The error codes generated by the Print Server are referenced below:</p><h3>Print Server error codes</h3><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th width="5%" class="TableStyle-NormalRows-BodyE-Column1-Body2">Code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">251</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Waiting time exceeded when an attempt is made to access a
        shared memory segment.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">252</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">An attempt to access a shared memory segment was stopped.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">253</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Failure during an attempt to access a shared memory segment.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">254</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to release the synchronization object to access a
        shared memory segment.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">255</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to write data in a shared memory segment.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">256</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to read data in a shared memory segment.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">257</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to delete data in a shared memory segment.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">258</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to recover the reference associated with the print
        request number.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">259</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Too many requests in the pending request stack.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">260</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the submission of a file transfer request.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">261</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The SAFE X3 solution description has not been found in the
        solutions description file.<br />Check values for parameters received '__APPLICATION=', '__APPRPT=',
        '__ADXSOL=', '__DBSERVER=', '__DBDATABASE='.<br />Check if this solution is descrived in config `file
        adxeditionserversolutions.xml`
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">262</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The connection to the SAFE X3 file server has failed.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">263</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to open the configuration file of the print server.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">264</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the initialization of the print server
        configuration file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">265</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the analysis of the print server configuration
        file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">266</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The total length of the execution parameters for the report
        is too large. Contact the system administrator.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">267</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the storage of the execution parameters of the
        report. No group memory available.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">268</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the reading of the execution parameters for the
        report.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">269</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the deletion of the execution parameters for
        the report.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">270</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the memory transfer of the execution parameters
        for the report.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">271</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to launch a print process.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">272</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The initialization context for a print process is absent or
        has failed.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">273</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The print request could not be submitted (request not
        ready).</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">274</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The print request could not be submitted (unable to activate
        the thread).</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">275</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error generated by the print engine.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">276</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The command line option is unknown.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">278</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unknown error.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">279</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error upon log file initialization.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">280</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error upon opening the "Recovery" files.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">281</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to recover a Web preview request.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">282</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to recover an already faulty request.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">283</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error upon reading the "Recovery" files.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">284</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error upon saving a "Recovery" request.</td></tr></table><h3>Error codes in the cache management module</h3><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th width="5%" class="TableStyle-NormalRows-BodyE-Column1-Body2">Code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">181</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Root folder for the cache is not found.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">182</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">"Application" folder not found.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">183</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to access the registry database.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">184</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Sage X3 server type unknown.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">185</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Transfer type not supported.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">186</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">File type unknown.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">187</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error upon access/transfer with SAFE X3 (SADFSQ) file
        server.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">188</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the conversion of a character string in
        Unicode.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">189</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the creation of the cache structure.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">190</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The current session of the cache manager is not initialized.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">191</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error on opening a local file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">192</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The file server requested does not exist.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">193</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to open the local file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">194</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to open the server file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">196</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The local file requested does not exist.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">199</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to establish a connection with the distant server.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">200</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error in the reading/writing of the file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">201</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to compare the Timestamps.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">202</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the conversion of a Timestamp to the system
        date.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">203</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error upon deletion of an "Archive" type folder.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">204</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error upon restoration of an "Archive" type folder.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">205</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The server archive files could not be found.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">239</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unknown error.</td></tr></table><h3>Error codes for the Windows service management module</h3><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th width="5%" class="TableStyle-NormalRows-BodyE-Column1-Body2">Code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">361</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to open the "Service Control Manager".</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">362</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to open the requested service.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">363</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to delete the service.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">364</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to stop the service.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">365</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to stop the service. Number of attempts exceeded.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">366</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to start the service.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">367</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to start the service. Number of attempts exceeded.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">368</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to perform the operation. The service is already
        started or in the process of being started.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">369</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The service already exists.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">370</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to create the service.</td></tr></table><h3>Error codes of the SAFE X3 solutions management module</h3><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th width="5%" class="TableStyle-NormalRows-BodyE-Column1-Body2">Code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">231</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to determine the installation folder for the 'SAFE X3
        Solutions' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">232</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to open the 'SAFE X3 Solutions' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">233</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to start the analysis of the 'SAFE X3 Solutions'
        file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">234</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">An error has occurred during the analysis of the "SAFE X3
        solutions" file.</td></tr></table><h3>Error codes in the ODBC management module</h3><table style="mc-table-style: url('../Resources/TableStyles/NormalRows.css');" class="TableStyle-NormalRows" cellspacing="0"><tr class="TableStyle-NormalRows-Body-Body2"><th width="5%" class="TableStyle-NormalRows-BodyE-Column1-Body2">Code</th><th class="TableStyle-NormalRows-BodyD-Column1-Body2">Explanation</th></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">311</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to determine the installation folder for the 'SAFE X3
        ODBC Description' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">312</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to open the 'SAFE X3 ODBC Description' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">313</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to start the analysis of the 'SAFE X3 ODBC
        Description' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">314</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">An error has occurred during the analysis of the "SAFE X3
        ODBC Description" file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">315</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The driver description has not been found in the "SAFE X3
        ODBC Description' file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">316</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the deletion/creation operation for the ODBC
        data sources.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">317</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Error during the creation of an ODBC data source.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">318</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the call to an ODBC configuration API.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">319</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to open the "TnsNames.ora" file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">320</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to read the "TnsNames.ora" file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">321</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to update the "TnsNames.ora" file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">322</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to recover the installation information for the
        Oracle*Net client.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">323</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to find the Oracle*Net "Tnsnames.ora" configuration
        file.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">324</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Unable to allocate a temporary file to backup the Oracle*Net
        "Tnsnames.ora" file.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">325</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unexpected error during the configuration of an ODBC source.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">326</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">Error during the call to a Sql ODBC API.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">327</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">The connection test for the ODBC data source has failed.
      </td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">328</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The description parameters for the source have errors or are
        incomplete.</td></tr><tr class="TableStyle-NormalRows-Body-Body1"><td class="TableStyle-NormalRows-BodyE-Column1-Body1">329</td><td class="TableStyle-NormalRows-BodyD-Column1-Body1">Unable to create the ODBC data source.</td></tr><tr class="TableStyle-NormalRows-Body-Body2"><td class="TableStyle-NormalRows-BodyE-Column1-Body2">330</td><td class="TableStyle-NormalRows-BodyD-Column1-Body2">The data source specified does not exist.</td></tr></table><div style="page-break-after: always;"></div><h1 id="Supportandtroubleshooting" data-magellan-target="Supportandtroubleshooting"><a id="printer support and troubleshooting">Support and troubleshooting</a></h1><ul><li><a href="#print-management">Printer management</a></li><li><a href="#cannot-detect-previous-installed-version-after-a-setup-crash">Cannot detect previous installed version after a setup crash</a></li><li><a href="#no-installed-printer">No installed Printer</a></li><li><a href="#activation-of-the-log-files">Activation of the log files</a></li><li><a href="#enable-logs-in-sap-vs-studio-crystal-report">Enable logs in SAP VS Studio Crystal Report</a></li><li><a href="#font-size-reduced-when-exporting-to-pdf">Font size reduced when exporting to PDF</a></li><li><a href="#chinese-characters-not-correctly-displayed-in-pdf">Chinese characters not correctly displayed in PDF</a></li><li><a href="#special-fonts-embedded-in-pdf-documents">Special fonts embedded in PDF documents</a></li><li><a href="#user-function-libraries-u212ltextdll-and-u212ltoword">User function Libraries U212LText.dll and U212ltoword</a></li><li><a href="#parameters-sent-to-the-print-server">Parameters sent to the Print Server</a></li></ul><h2 id="Printermanagement" data-magellan-target="Printermanagement"><a id="#print-management">Printer management</a></h2>

  The following rules must be observed for the Print Server to be able to print correctly:
  <ul><li>In case the Print Server is started in Windows Service mode, it is absolutely necessary to specify a boot account other than the Local System account so that the Publisher can address one of the printers in your organization. 
    By default, no printer is attached to the Local System Windows account.
  </li><li>The user account under which the Print Server has been started in Console mode or in Windows Service mode must at least have a printer configured.</li><li>The Print Server can only send printers visible and accessible by the user account under which the server was started whether in Console mode or Windows Service mode.</li><li>In case of printing with generation of a document in PDF format, document size settings will be inherited from the default printer paper size associated with the user account under which the Print Server was started whether the Print Server is running in Console mode or Windows Service mode.</li></ul><h2 id="Cannotdetectpreviousinstalledversionafterasetupcrash" data-magellan-target="Cannotdetectpreviousinstalledversionafterasetupcrash"><a id="#cannot-detect-previous-installed-version-after-a-setup-crash">Cannot detect previous installed version after a setup crash</a></h2><p>When a Print Server setup crashes, it sometimes cannot detect the previous version anymore.</p><p>When that happens, we need to restore registry entries.</p><p>To restore registry entries, a file needs to be created and executed with the following content:</p><pre xml:space="preserve">
    Windows Registry Editor Version 5.00

    [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Sage Safe X3 V2 Print Server]
    "DisplayName"="Sage Safe X3 V2 Print Server"
    "UninstallString"="\"C:\\Program Files\\Java\\jre1.8.0_77\\bin\\javaw.exe\" -jar \"D:\\Sage\\SafeX3\\PRTSRV\\uninstaller\\uninstaller.jar\""
    "DisplayVersion"="EDT.226"
    "Publisher"="Sage"
    "DisplayIcon"="D:\\Sage\\SafeX3\\PRTSRV\\Uninstaller\\UninstallerIcon.ico"
  </pre><h2 id="NoinstalledPrinter" data-magellan-target="NoinstalledPrinter"><a id="#no-installed-printer">No installed Printer</a></h2><p>By default, no printer is attached to the Windows account Local System.</p><p>In case the Print Server is started in Windows Service mode, it is essential to specify a startup account different from the Local system account so that the Print Server can address one of the printers in your organization.</p><p>The user account under which the Print Server has been started in either Console mode or Windows Service mode must at least have a printer configured.</p><h2 id="Activationofthelogfiles" data-magellan-target="Activationofthelogfiles"><a id="#activation-of-the-log-files">Activation of the log files</a></h2><p>All errors are logged in the application log of the Windows Event Viewer, even if the Print Server trace mode has not been enabled.</p><p>If an issue cannot be reproduced, the customer needs to activate traces, play the issue, and send SAGE the traces.</p><ul><li><b>"/d"</b>: This option is used to produce a file that logs the activity of the Print Server and of the launched printing processes. 
    The file is named <code>AdxSrvlmp_Trace.log</code> and the resulting log file is stored in the temporary folder of the Print Server: <code>rootPrinterDirectory\Temp</code>.
    </li></ul><p><b>Example:</b></p><pre>
    C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\AdxSrvImp_Trace.log
    C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\RPT_Trace_ZTESTKO_CrDll_SBELU92.log
    </pre><p><b>Example to modify the Print Server service:</b></p><pre>
    sc config "Safe_X3_SE_V2DEFAULT" binPath= "\"c:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\AdxSrvImp.exe\" /d"
    [SC] ChangeServiceConfig réussite(s)
    </pre><p><b>Example to modify the arguments in Service:</b></p><img src="../Resources/Images/images_PrintServer-ServiceAddTraces_360x702.png" alt="Add traces" style="width: 360;height: 702;" /><p><b>Note:</b> In this case, the debug mode will be effective only for the first time you launch the service.</p><p><b>Excerpt of the <code>C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\AdxSrvImp_Trace.log</code> file:</b></p><br /><pre xml:space="preserve">
    **** Function : SrvImpSuper_newRptJob - [3/20 12:53:52:750] ****
        - Receipt of a new print request - JobId : 1 - [Date : 3/20 12:53:52:750]
        - JobId Settings 1 :
          _FormatExport=_28
          __REPORT=_TABCOUNTRY.rpt
          __DESTINATION=_3
          __TYPDBA=_2
          __DBDATABASE=_v12026x3
          __DBUSER=_SEED
          __DBPASSWORD=***
          +X3IMP=_matrixw19sql.sagex3rd.local:1890
          __wJobID=_SEED-9945-20230320125352-28
          __WSTATION=_MATRIXW19SQL.sagex3rd.local
          __CDUSER=_ADMIN
          __ADXSOL=_V12026X3
          __APPLICATION=_SEED;matrixw19sql.sagex3rd.local;20100
          __APPRPT=_X3;matrixw19sql.sagex3rd.local;20100
          __RPTLAN=_ENG
          X3DOS=_SEED;matrixw19sql.sagex3rd.local;20100;150;ENG
          __RUNTIME=_MATRIXW19SQL.sagex3rd.local;20100
          __JOBLINKED=_
          __REQUETE=_2322986
          _PreVisuOptions=11111111111111111111
          _Orientation=_0
          _PaperSize=_1
          X3CLI=_SEED folder
          X3EDT=_Report Sage Copyright
          X3ETA=_TABCOUNTRY
          X3TIT=_Country
          X3OPE=_System Administrator
          X3USR=_ADMIN
          X3LAN=_ENG
          X3SIT1=_*
          X3SIT2=_z
          X3PRF=_ADMIN
          X3FCT=_ 
          X3SIT=_
          paysdeb=_ 
          paysfin=_zzzzzzzzzz
          impselections=_0
  </pre><b>Excerpt of the <code>C:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp\RPT_Trace_TABCOUNTRY_CrDll_SEED1.log</code> file:</b><br /><pre xml:space="preserve">
     File destination: preparing Crystal Report
     Issue file: c:\Sage\SafeX3\PRTSRV\Temp\SEED-9945-20230320125352-28_
     Excel format, data only: preparing Crystal Report
     CrystalReport start process Document -  3/20/2023 12:53:54 PM
     File destination: processing by Crystal Report
     ** Stage: CrystalReport Document has been processed - Duration: 00:00:01.7220328
     ** Stage: CrystalReport Document completed - Duration: 00:00:01.7230337
     Dispose CrystalReport Document - 3/20/2023 12:53:54 PM 
     Memory current process : 74 MB / Total Memory: 10399 MB / Free Memory: 907 MB  -  3/20/2023 12:53:55 PM
     Current process CPU usage : 19.983 % CPU  /  Global CPU usage : 48.39094 % CPU 
    End of print process - 3/20/2023 12:53:55 PM
  </pre><h3>Trace mode of UFLs DLLs</h3><p><code>u212ltext.log</code> is generated in <code>Temp</code> folder below the Print Server install path.<br /></p><p><b>Example:</b></p><pre>c:\Sage\SafeX3\EDTV2\EDTSRV\srvedit\Temp</pre><p><b>Notes:</b></p><ul><li><code>U212LText.dll</code> used by the Print Server is stored in <code>C:\Windows\crystal</code>.</li><li>Crytal Report 2016 uses the Dll <code>U212IText.dll</code> located in <code>C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86</code> since Print Server 2.28 (2023.01 - 2023 R1).</li><li>Crytal Report 2020 uses the Dll <code>U212IText.dll</code> located in <code>C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64</code> since Print Server 2.28.</li></ul><p><b>Example of activating the file via key in the registry:</b></p><pre>
  HKEY_LOCAL_MACHINE\SOFTWARE\Adonix\SRVIMP\0,1,5,0\REPORT\U2LTEXT_TraceMode : ON/OFF
  </pre><h3>Modules.exe</h3><p>CR tools allow to see the versions of DLLs/Assemblies loaded in memory. These are used for:</p><ul><li>Checking the version of third-party components.</li><li><b>Log ODBC:</b> If there's an SGBD error, we can use them to obtain more details besides the CRPE simple error.</li><li><b>ProcMon.exe:</b> Details about every running processes. Not easy to use.</li><li><b>Debugger Post-Mortem:</b> Used to exploit a posteriori a crash dump, to locate in the code the line in error (with its stack and all the context of the registers, etc ...)</li><li><b>Enable logs from Sap VS Studio Crystal Report dlls:</b> In certain cases, Crystal Report blocks the print process. When that happens, these logs can help us identify the issue.</li></ul><h2 id="EnablelogsinSAPVSStudioCrystalReport" data-magellan-target="EnablelogsinSAPVSStudioCrystalReport"><a id="#enable-logs-in-sap-vs-studio-crystal-report">Enable logs in SAP VS Studio Crystal Report</a></h2><p>For Crystal Report 2016 and 2020. To use Crystal Reports Designer 2016 and 2020, the Print Server version must be ≥ 2.18.</p><p>To enable logs in Crystal Report, save this file with the <code>.reg</code> extension (for example, with the name <code>enableLog.reg</code>) and execute it.</p><pre xml:space="preserve">
    Windows Registry Editor Version 5.00
    [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
    [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
    "Destinations"=dword:00000003
    "Position"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
    "Destinations"=dword:00000003
    "Position"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
    "Destinations"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    "Position"=dword:00000003
    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
    "Destinations"=dword:00000003
    "Position"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
    "Destinations"=dword:00000003
    "Position"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
    "Destinations"=dword:00000003
    "LogErrorsOnly"=dword:00000000
    "Position"=dword:00000003
  </pre>
  Logs are located in the User Profile TEMP directory: <code>C:\Users\[userId]\AppData\Local\Temp</code>.

  The UserId is the account Id linked to the Print Server service. It is this account that launches the Print processes.
  
  Inside that folder, log files show up with the <code>.glf</code> extension.
  <pre>
  AdxImpNet_bkgrnd_51664_2020_05_06_12_07_24_340_trace.glf
  AdxImpNet_Diagnostics_51664_2020_05_06_12_07_23_199_trace.glf
  AdxImpNet_functions_51664_2020_05_06_12_07_23_205_trace.glf
  </pre><b>How to disable logging:</b><pre>
  Windows Registry Editor Version 5.00
  [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
  [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
  "Destinations"=dword:00000000
  "Position"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
  "Destinations"=dword:00000000
  "Position"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  [HKEY_LOCAL_MACHINE\SOFTWARE\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
  "Destinations"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  "Position"=dword:00000000
  [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging]
  [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.bkgrnd]
  "Destinations"=dword:00000000
  "Position"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.diagnostics]
  "Destinations"=dword:00000000
  "Position"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Logging\crpe.functions]
  "Destinations"=dword:00000000
  "LogErrorsOnly"=dword:00000000
  "Position"=dword:00000000
  </pre><h2 id="FontsizereducedwhenexportingtoPDF" data-magellan-target="FontsizereducedwhenexportingtoPDF"><a id="#font-size-reduced-when-exporting-to-pdf">Font size reduced when exporting to PDF</a></h2><p>When you use some specific fonts like BarCodes (BarcodeEAN13) and export a report to PDF format, the font size can be slightly reduced compared to the size that appears in the Crystal Reports designer and in printed output.</p><p>The CrystalReport PDF export engine can be modified to incorporate a new algorithm that positions characters precisely to prevent truncation from ocurring while maintaining the correct font size. 
  This algorithm can be activated and controlled by two new registry keys. These keys are:</p><ul><li><pre>
  [HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal Reports\Export\Pdf]
  "UsePrecisePositioningForText"=dword:00000001
  </pre></li><li><pre>
  [HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Crystal] Reports\Export\Pdf"
  TruncationAdjustment"=dword:00000002
  </pre></li></ul><p>The <code>UsePrecisePositioningForText</code> key turns on the new functionality when it is set to 1. When this functionality is activated, the <code>ForceLargerFonts</code> key is ignored.</p><p>The <code>TruncationAdjustment</code> key controls a width calculation rounding function in the new algorithm and accepts values between 0 and 10 inclusively.</p><p>The default value of 2 has been tested to sufficiently eliminate most truncation issues. If truncation is still observed, this value can be increased for added granularity.</p><h3>Known Limitations</h3><p>When the <code>UsePrecisePositioningForText</code> key is turned on, there are several side-effects:</p><ul><li>Exporting to PDF may take slightly longer, but no more than 10% longer.</li><li>The exported PDF document will increase in size over the standard outputand Crystal Reports will consume more GDI resources during the export. For more information, check: 
  <ul><li><a href="https://www.arcanadev.com/support/kb/K00000394">ArcanaDev</a></li><li><a href="https://help.jeff-net.com/knowledgebase/article/registry-settings-and-options-for-crystal-reports">Registry Settings and Options for Crystal Reports</a></li><li><a href="https://apps.support.sap.com/sap/support/knowledge/en/2165260">2165260 - List of Registry Keys used in Crystal Reports Master KBA</a></li></ul></li></ul><h2 id="ChinesecharactersnotcorrectlydisplayedinPDF" data-magellan-target="ChinesecharactersnotcorrectlydisplayedinPDF"><a id="#chinese-characters-not-correctly-displayed-in-pdf">Chinese characters not correctly displayed in PDF</a></h2><p>Chinese or arabic characters are not correctly displayed in PDF document generated by the Print Server.</p><p>These characters could come from formula or the database, or be stored in <code>localmenus</code>.</p><img src="../Resources/Images/images_PrintServer-ChineseInPDF.png" /><br /><br /><p><b>Example of a field containing a formula:</b></p><pre>
  textofchapter("SEED;matrixw19;20101",{?X3LAN},1,2)
  </pre><p><a href="https://apps.support.sap.com/sap/support/knowledge/en/1532489">See the SAP Crystal Report for this issue</a></p><p>To fix this issue, please edit your report with Crystal Report Designer, choose the field containing the formula and change the font from <code>Arial</code> to <code>Arial Unicode MS</code>.</p><p>Since Print Server 2.24 (2021.07 - 2021 R3), a new feature avoids all your reports and replaces every text field using <code>Arial</code> and replacing <code>Arial</code> font by <code>Arial Unicode MS</code> automatically.</p><p><b>To activate this feature, pleace edit your registry and this key:</b></p><pre>
    Subkey: HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ADONIX\SRVIMP\0,1,5,0\GENERAL
      - Entry: ForceUnicodeFont
      - Value Type: REG_SZ, string
    Valid values Range: [0-1] or [ON - OFF] 
    0: Conversion feature is turned OFF 
    1: Convert all fields using "Arial" font to "Arial Unicode MS" to avoid any issues with Asian characters
    
    The default font used for unicode is 'Arial Unicode MS',  to change this default font, create or edit this registry key 'UnicodeFont' : 
    Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
    UnicodeFont : "Arial Unicode MS"
    UnicodeFont : "GNU Unifont"
  </pre><p>Since Print Server 2.25 (2022.01 - 2022 R1), you can force every field to use a specific Non Unicode font. <b>To active this feature, please edit your registry and this key:</b></p><pre>
    Add registry parameter:
    Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
    ForceNonUnicodeFont : 1

    Add registry 'NonUnicodeFont' to specify NON UNICODE fonts to use. 
    The default font used for non unicode is 'Courier New',  to change this default font.
    Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
    NonUnicodeFont : "Courier New"
  </pre><br /><img src="../Resources/Images/images_PrintServer-Registry-01_640x492.png" alt="PrintServer registry" style="width: 640;height: 492;" /><div style="page-break-after: always;"></div><h2 id="SpecialfontsembeddedinPDFdocuments" data-magellan-target="SpecialfontsembeddedinPDFdocuments"><a id="#special-fonts-embedded-in-pdf-documents">Special fonts embedded in PDF documents</a></h2><p>If you're using non standard fonts in your reports for BarCodes, specific fonts for icons, bank checks and so on, you need to check the licence and properties of the font.</p><p>The licence determines if the font can be embedded in PDF documents or not.</p><br /><img src="../Resources/Images/images_PrintServer-specialFontEmbeddedPdf_360x509.png" alt="Special fonts" style="width: 360;height: 509;" /><p>To verify the embedded security level of a font, review the font properties.</p><p>If the security level contains No-embedding permissions, then exporting to PDF will not be successful.</p><p>For the utility to allow you to view the embedded security level of a font, download the font properties extension from Microsoft's <a href="www.microsoft.com/typography">web site</a>.</p><p>True Type Fonts (TTF) has embedding permissions that determine if they can be converted into an embedded font format.</p><p>The permissions associated with the embedded security level of a font are as follows:</p><ul><li><b>No-embedding:</b> This does not allow fonts to be embedded. Contact the font vendor to request a possible upgrade to an embeddable font.</li><li><b>Print and preview:</b> This allows fonts to be embedded. However, only within pages that remains static on the client computer. If a page allows fonts to be changed, then editable or installable fonts are required. Examples of a page that allows fonts to be changed are an online Java-based word processor or an email editor.</li><li><b>Editable:</b> This allows fonts to be embedded using a tool such as Microsoft Web Embedding Fonts Tools (WEFT) beyond the limitations of the print and preview permissions.</li><li><b>Installable:</b> This allows fonts to be embedded similar to the "Editable" permissions. Note that installable fonts are not installed in the visitors' fonts folder.</li></ul><p>You can find more information on special fonts in the following links:</p><ul><li><a href="https://apps.support.sap.com/sap/support/knowledge/en/1214944">1214944 - What font types are supported in Crystal Reports?</a>[]()</li><li><a href="https://sandeen.net/GnuMICR/">An open-source licensed Type 1 MICR E13-B font</a></li><li><a href="https://answers.sap.com/questions/11929151/embeding-full-set-of-fonts-when-exporting-to-pdf-f.html">Embeding full set of fonts when exporting to PDF from a Crystal Reports file</a></li><li><a href="https://kenhamady.com/cru/archives/102">Free MICR font (Turn blank security paper into check stock)</a></li><li><a href="https://support.idautomation.com/Barcode-Fonts/Font-is-not-allowed-to-be-embedded-in-document-when-exporting-report-to-PDF-for-Crystal-Designer/_1733">Font is not allowed to be embedded in document when exporting report to PDF for Crystal Designer</a></li></ul><div style="page-break-after: always;"></div><h2 id="UserfunctionLibrariesU212LTextdllandU212ltoword" data-magellan-target="UserfunctionLibrariesU212LTextdllandU212ltoword"><a id="#user-function-libraries-u212ltextdll-and-u212ltoword">User function Libraries U212LText.dll and U212ltoword</a></h2><p>Crystal Report extensions to publish proprietary functions from a SAP Crystal Report form field.</p><p>Depending on the use case, these DLLs are loaded by Crystal Report Designer and/or CRPE .Net.</p><p>They are never directly loaded by the Print Server (AdxSrvImp and AdxImpNet), but called by SAP CR Engine or SAP CR Designer.</p><p><b>Location on the Sage Print Server station:</b></p><pre>
  C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86
  and Print Server &lt;= 2.27. Note: C:\Windows\crystal doesn't exist since Print Server 2.25.
  C:\Windows\crystal
  </pre><p>Directory <code>C:\Windows\crystal</code>, containing <code>U212IText.dll</code>, <code>U212Itoword.dll</code> and <code>u2lbcode.dll</code>, is no more created and used by the Print Server &gt;= 2.28. 
    <b>For Print Server &gt;= 2.28:</b></p><pre>
  C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64
  used by SAP Crystal Reports Designer 2020
  
  C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86
  used by X3 Print Server and SAP Crystal Reports Designer &lt; 2016
  
  C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86
  used by SAP Crystal Reports Designer 2016
  </pre><h3>U212LText.dll</h3><p>Supports <code>menu-local</code> and <code>translatable text</code> fields.</p><p>It is applied to cache-managed resource files.</p><p>These specialized functions allow you to insert or perform specific calculations on data managed by the X3 information systes and can be incorporated into Crystal Reports intended to run in an X3 application.</p><br /><img src="../Resources/Images/images_PrintServer-U212LText_TextOfChapter_640x671.png" style="width: 640;height: 671;" /><p>Behavior of <code>U2LText</code> functions when there is no local menu description:</p><ul><li>If the local menu number or the message number passed as an argument of one of the ad hoc functions of the <code>U2LText</code> does not exist in the <code>menuCdLang</code> description file, the function no longer returns an error, but returns as default an an empty string. A warning message is nevertheless written in the trace file of the DLL.</li></ul><p>Menus are downloaded by the Print Server from the current X3 folderID and stored in its filesytem: <code>c:\\Sage\srvedit\Data\[Folder]_[Hostname]_[Runtime Port]\GEN\ALL\MENL</code>. <b>For example:</b></p><pre>
  C:\Sage\SafeX3\EDTV2\EDTSRVFRDEP\srvedit\Data\SEED_po027493_20192\GEN\ALL\MENL
  </pre><p><b>The <code>dir C:\Sage\SafeX3\EDTV2\EDTSRVFRDEP\srvedit\Data\SEED_po027493_20192\GEN\ALL\MENL</code> file contains the following data:</b></p><pre xml:space="preserve">
    menuarb
    menuaus
    menubra
    menubri
    menuchi
    menueng
    menufra
    menuger
    menuita
    menupol
    menupor
    menus
    menuspa
    textraarb
    textraaus
    textrabra
    textrabri
    textrachi
    textraeng
    textrafra
    textrager
    textraita
    textrapol
    textrapor
    textraspa
  </pre><p><b>Excerpt of the <code>menueng</code> file:</b></p><pre xml:space="preserve">
    1
    NO
    No
    Yes
    |
    2
    RCMAD&gt;<!-- <LVI09XTH+-FG
    Search
    Create
    Change
    Cancel
    Copy
    Next
    Previous
    List
    Validate
    Print
    -->&lt; Previous
    &gt; Last
    X Sel
    Table
    # Code
    Page +
    Page -
    End
    Ex
    |
    3
    123
    Yes / No
    Total / Inquiry
    Object
    |
    4
    DOH
    Decimal
    Octal
    Hexadecimal
    |
    5
    35
    3 ½ inches
    5 ¼ inches
  </pre><h3>Function TextForCode</h3><p>This function returns the label associated with the message number of a SAGE X3 field.</p><p>By default, the description is returned in the connection language.</p><p><b>Parameters:</b></p><ul><li><b>Application key:</b> Key of the application in the form <code>Folder;Server;Port;Version;Language</code>.</li><li><b>Field name:</b> X3 fieldname with the form <code>«{tablename.fieldname}»</code>.</li><li><b>Message number:</b> Value of the message number.</li><li><b>Return:</b> Message label in the requested language.</li></ul><br /><b>Note:</b> The function uses the <code>menus</code> and <code>menu [lang]</code> files as input. <b>For example:</b><pre>
  TextForCode("PRODV140;prodsrv;1940;140;ENG","ACONSULT.MODULE", 8)
  </pre><h3>Function TranslatedTextForCode</h3><p>is function returns the label associated to a message number from an X3 field, in the requested language.</p><p><b>Parameters:</b></p><ul><li><b>Application key:</b> In the form <code>Folder;Server;Port;Version;Language</code>.</li><li><b>Language code:</b> FRA, ENG, SPA, ITA, BRI, POR.</li><li><b>Field name</b>.</li><li><b>Message number</b>.</li></ul><br /><b>For example:</b><pre>
  TranslatedTextForCode("PRODV140;prodsrv ;1940;140","FRA","ACONSULT.MODE", 8)
  </pre><h3>Function TextOfChapter</h3><p>This function returns the label associated with the message number of an X3 local menu, in the requested language.</p><p><b>Parameters:</b></p><ul><li><b>Application key:</b> In the form <code>FOLDER;HOST;PORT;VERSION;LANGUAGE</code>.</li><li><b>Language code:</b> FRA, ENG, SPA, ITA, BRI, POR.</li><li><b>Message number</b>.</li><li><b>Return:</b> Label in the specified language.</li></ul><p><b>For example:</b></p><pre>
  TextOfChapter("PRODV140;prodsrv;1940;140","FRA", 2229, 8)
  </pre><p><b>An example with variables:</b></p><pre>
  textofchapter({?X3DOS},{?X3LAN},1,3)
  </pre><h3>Function X3TranslatedText</h3><p>This function returns the label associated with the alphanumeric key of an application text, in the requested language.</p><p><b>Parameters:</b></p><ul><li><b>Application key:</b> In the form <code>Folder;Server;Port;Version;Language</code>.</li><li><b>Language code:</b>  FRA, ENG, SPA, ITA, BRI, POR.</li><li><b>Text key:</b> Application text key in the form Nom <code>table~Nom champ~Identifiant 1~Identifiant 2~</code>. Please note that the "~" character corresponds to the field separator. It is obligatory.</li><li><b>Return:</b> Text in the specified language.</li></ul><p><b>For example:</b></p><pre>
  X3TranslatedText ("PRODV140;prodsrv ;1940 ","SPA", "PFOOTINV~SHOAXX~50~ ~" )
  </pre><p><b>Example:</b></p><br /><img src="../Resources/Images/images_PrintServer-X3TranslatedText_640x671.png" alt="X3TranslatedText" style="width: 640;height: 671;" /><h3>Debug U212LText:</h3><p><code>U212LText.dll</code> offers support for <code>menu-local</code> and <code>translatable text</code> fields.</p><p>It is applied to cache-managed resource files.</p><p><b>Registry:</b></p><pre>
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
  PrintEngine : 0
  U2LTEXT_TraceMode : OFF
  U2LTOWORD_TraceMode : OFF
  </pre><p><code>U2LTEXT_TraceMode</code> can be set to <code>ON</code> or <code>OFF</code> depending if trace is activated or disabled.</p><p>If trace is activated, the resulting log file name is named <code>U212ltext.log</code> and is generally saved in the temp directory <code>Documents &amp; Settings</code> of the user profile.</p><p><b>Example:</b></p><br /><pre>
  C:\Users\frdepo\AppData\Local\Temp\U212ltext.log
  </pre><p><b>Example of a <code>U212ltext.log</code> file:</b></p><pre>
        *****************************************
        *	Sage® X3 Print Services	*
        *	 U212LText.dll Trace File		*
        *****************************************

  ==&gt; Start Fct [InitForJob] - Id [4]
    - INFORMATION : DLL Version  [EDT.2.999]
    - INFORMATION : DLL Location [C:\windows\crystal\U212LText.dll]
    - INFORMATION : Caller Module Name[Edition Server V5 (220000)]
    - INFORMATION : Caller Module Full Name[C:\Source\X3\print-server224\src\server\bin\Debug\ConsolePrintNet.exe]
    - INFORMATION : Start Time   [3/30 21:33:40:958]
    - WARNING : Unable to find Default Language in General Registry [Software\Adonix\x3\0,1,4,0\]
  </pre><p><b>Note:</b> The Dll file was located in C:\windows\crystal\U212LText.dll until Print Server 2.27.</p><br /><ul><li>UFL Libraries <code>U212IText.dll</code> and <code>U212Itoword.dll</code> are compiled in 64 bits and copied in the following folder from Print Server &gt;= 2.28: <br /><code>C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64</code> (used by SAP CR 2020).</li><li>32 bits UFL Libraries <code>U212IText.dll</code> and <code>U212Itoword.dll</code> are still copied to the folder:<br /><code>C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86</code> (used by X3 Print Server and SAP CR &gt; 2016) and <code>C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win32_x86</code> (used by SAP CR 2016).</li><li>Directory <code>C:\Windows\crystal</code>, containing <code>U212IText.dll</code>, <code>U212Itoword.dll</code> and <code>u2lbcode.dll</code>, is no more created and used by the Print Server &gt;= 2.28. The PrintEngine will use UFL libraries located in <code>C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports for .NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86</code>.</li></ul><h3>U212ltoword.dll</h3><p><b>AmountToWord:</b> Conversion of amounts into letters (multi-language/multi-currency) relies on language/currency description files delivered.</p><p><b>Special Features:</b></p><ul><li>The externalization of currencies for a language is carried out in a local file, as well as a default language and currency in a local file.</li></ul><p><b>The supported languages are:</b></p><ul><li>French</li><li>English</li><li>German</li><li>Spanish</li><li>Italian</li><li>Portuguese</li><li>Dutch</li><li>Russian</li><li>Polish</li></ul><p><b>File location:</b> The <code>U212ltoword.dll</code> library must be placed under <code>C:\Program Files (x86)\SAP BusinessObjects\Crystal Reports</code> for <code>.NET Framework 4.0\Common\SAP BusinessObjects Enterprise XI 4.0\win32_x86</code> of <code>Program Files (x86)</code> installation directory.</p><p>The 8 text files <code>.txt</code> must be placed in the sub-directory <code>lan</code> from the installation directory of the Print Server.</p><pre>
  X3CurFRA.txt
  X3CurENG.txt
  X3CuDEU.txt
  X3CurSPA.txt 
  X3CurITL.txt 
  X3CurPOR.txt 
  X3CurNLD.txt 
  X3CurDFT.txt
  </pre><p>Each text file contains the definition of currencies of a managed language. The <code>X3CurDFT.txt</code> file contains the default language as well as the definition of the default currencies.</p><p><b>File structure:</b></p><pre>
  #FRA
  BEF;franc belge;francs belge;centime;centimes
  ESP;peseta;pesetas;;
  EUR;euro;euros;centime;centimes
  DEM;deutsche mark;deutsche marks;pfennig;pfennig
  FRF;franc;francs;centime;centimes
  FRS;franc suisse;francs suisse;centime;centimes
  GBP;livre;livres;penny;pence
  GRD;drachme;drachmes;;
  ITL;lire;lires;centesimo;centesimi;
  JPY;yen;yens;sen;sen
  LUF;franc luxembourgeois;francs luxembourgeois;centime;centimes
  PTE;escudo;escudos;;
  USD;US dollar;US dollars;US cent;US cents
  </pre><p><b>Note:</b> FRA is the default language. It is only used in the <code>X3CurDFT.txt</code> file. The other lines define the currencies for a language.</p><h3>Function AmountToWord</h3><p>Description of the <b>AmountToWord</b> formula.</p><p><b>Arguments:</b></p><ul><li><b>Application key:</b> With the Format <code>folder/server/port</code>.</li><li><b>Language</b>.</li><li><b>Currency</b>.</li><li><b>Amount in digit</b>.</li><li><b>Return:</b>  Amount in letters in the requested currency and language.</li></ul><p><b>Note:</b> If the language set as parameter to <code>AmountToWorld</code> is not supported, the program will look for the default language in the default currency file. The default language is indicated in file <code>X3CurDFT.txt</code>.</p><p><b>Example:</b></p><pre>
  #ENG define English as default language.
  </pre><p><b>Example:</b></p><pre>
  AmountToWord("PRODV140;prodsrv;1940 ", "SPA" "EUR", 256.80)
  </pre><h3>Function AmountToDigit</h3><p>Description of the <b>AmountToDigit</b> formula.</p><p><b>Arguments:</b></p><ul><li><b>Application key:</b> Folder/server/port - X3DOS parameter.</li><li><b>Print language</b>.</li><li><b>Currency</b>.</li><li><b>Amount in digits</b>.</li><li><b>Decimal display flag</b>: (True  = letter, False = number)</li><li><b>Return</b>: Formatted strings containing 11 fields. The first field corresponds to the value of the decimal part (digit or letter based on the Flag), the second field corresponds to the digit/letter of the amount unit, the third field corresponds to the digit/letter of the tens... The eleventh field corresponds to the digit/letter of the billions.</li></ul><p><b>Note:</b> If the decimal display flag is equal to True, the note for the AmountToWord formula also applies here.</p><h3>Debug U212ltoword</h3><p><b>Registry:</b></p><pre>
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Adonix\SRVIMP\0,1,5,0\REPORT
  U2LTOWORD_TraceMode: ON/OFF
  </pre><img src="../Resources/Images/images_PrintServer-Registry-01_480x492.png" alt="Print-server U2LTOWORD_TraceMode DEBUG" style="width: 480;height: 492;" /><br /><p>If the value of the key <code>U2LTOWORD_TraceMode</code> is <code>ON</code>, DebugMode is activated. </p><p>This means every call to the U212ltoword library, from SAP Crystal Report Designer or from the Print Server calling SAP Crystal Report Engine, will write to a log file named <code>u212lToWord.log</code> localized in the TEMP to the user running the dll.</p><p><b>Example:</b></p><pre>C:\Users\frdepo\AppData\Local\Temp\u212lToWord.log</pre><p><b>Example of the content of <code>u212lToWord.log</code>:</b></p><pre xml:space="preserve">
            *****************************************
            *   Sage® X3 Print Services *
            *    U212LText.dll Trace File       *
            *****************************************
  ==&gt; Start Fct [InitForJob] - Id [2]
      - INFORMATION : DLL Version  [EDT.9.9]
      - INFORMATION : DLL Location [C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64\U212IText.dll]
      - INFORMATION : Caller Module Name[Unknown (0)]
      - INFORMATION : Caller Module Full Name[C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\win64_x64\crw64.exe]
      - INFORMATION : Start Time   [5/15 14:12:19:566]
  ==&gt; End Fct [InitForJob] - Id [2]
  ==&gt; Start Fct "TextForCode" - [5/15 14:12:19:609]
          - Keys : SEED10;frpo402328;20130 (Folder/Host/Port) SEED10/frpo402328/20130
      - Application parameter : [SEED10;frpo402328;20130] with final CdLang [ENG]
      - Application version is : [150]
      - INFORMATION : Before to load Menu [645] from [c:\Sage\SafeX3\PRTSRV\Data\SEED10_frpo402328_20130\GEN\ALL\MENL\menuENG] - [5/15 14:12:19:651]
      - INFORMATION : Statement processed without error. Raw value: 'Invoice' -  UTF8 Value returned: 'Invoice'
  ==&gt; End Fct "TextForCode" -  - [5/15 14:12:19:668]
  ==&gt; Start Fct "TextForCode" - [5/15 14:12:19:681]
      - Application parameter : [SEED10;frpo402328;20130] with final CdLang [ENG]
      - Application version is : [150]
      - INFORMATION : Menu [645] found in cache
      - INFORMATION : Statement processed without error. Raw value: 'Debit note' -  UTF8 Value returned: 'Debit note'
  ==&gt; End Fct "TextForCode" -  - [5/15 14:12:19:737]
  ==&gt; Start Fct [TermForJob] - Id [2]
  ==&gt; Release gpMenu
      - INFORMATION : Stop Time [5/15 14:13:33:962]
  ==&gt; End Fct [TermForJob] - Id [2]
  </pre><p><b>Note:</b> Since Print Server &gt;= 2.28, AmountToWordTest calls the function <code>AmountToWord()</code> contained in the library <code>U212ltoword.dll</code> in the command line:</p><pre>
  AmountToWord TU
  Usage AmountToWordTest.exe -lang [ENG, FRA, ITA... ] -cur [EUR, USD, ...]  -start [number]   -end [number]

  AmountToWordTest.exe -lang FRA -cur EUR -start 3 -end 10

  AmountToWord 3.000000 EUR  ENG  three Euros
  AmountToWord 4.000000 EUR  ENG  four Euros
  AmountToWord 5.000000 EUR  ENG  five Euros
  AmountToWord 6.000000 EUR  ENG  six Euros
  AmountToWord 7.000000 EUR  ENG  seven Euros
  AmountToWord 8.000000 EUR  ENG  eight Euros
  AmountToWord 9.000000 EUR  ENG  nine Euros
  AmountToWord 10.000000 EUR  ENG  ten Euros
  </pre><div style="page-break-after: always;"></div><h2 id="ParameterssenttothePrintServer" data-magellan-target="ParameterssenttothePrintServer"><a id="#parameters-sent-to-the-print-server">Parameters sent to the Print Server</a></h2><pre xml:space="preserve">
**** Function : SrvImpSuper_newRptJob - [1/17 15:38:10:6] ****
    - Réception d'une nouvelle demande d'impression - JobId : 1 - [Date : 1/17 15:38:10:7]
    - Paramètres du JobId 1 :
      _FormatExport=_29
      _PrinterName=_\\ser-psafo02\SAGEPRINTER
      _PrinterServer=_vcsx3v11.sagefr.adinternal.com:1890
      _PrinterDriver=_KONICA MINOLTA C364SeriesPCL SP
      _PrinterPort=_SECURE,SECURE2
      _PrinterDescriptionEx=_1|000258|000009|||
      _Orientation=_0
      _PrinterCopies=_1
      _PrinterCollate=_0
      _PrinterStartPage=_1
      _PrinterStopPage=_9999
      __REPORT=_TABCOUNTRY.rpt
      __DESTINATION=_1
      __TYPDBA=_2
      __DBDATABASE=_x3v11sql
      __DBUSER=_SUPERV
      __DBPASSWORD=***
      +X3IMP=_vcsx3v11.sagefr.adinternal.com:1890
      __WSTATION=_VCSX3V11.sagefr.adinternal.com
      __CDUSER=_ADMIN
      __ADXSOL=_V11SQL
      __APPLICATION=_SUPERV;vcsx3v11.sagefr.adinternal.com;18111
      __APPRPT=_X3;vcsx3v11.sagefr.adinternal.com;18111
      __RPTLAN=_FRA
      X3DOS=_SUPERV;vcsx3v11.sagefr.adinternal.com;18111;150;FRA
      __JOBLINKED=_
      __REQUETE=_5042306
      _PreVisuOptions=11111111111111111111
      X3CLI=_SEED folder
      X3EDT=_Etat Sage X3 Copyright Sage
      X3ETA=_TABCOUNTRY
      X3TIT=_Pays
      X3OPE=_Administrateur système
      X3USR=_ADMIN
      X3LAN=_FRA
      X3SIT1=_*
      X3SIT2=_z
      X3PRF=_ADMIN
      X3FCT=_ 
      X3SIT=_
      paysdeb=_A
      paysfin=_A
      impselections=_0
  </pre><img src="../Resources/Images/images_PrintServer-Destinations-01_640x1393.png" alt="Print-server destinations" style="width: 640;height: 1393;" /><h3>_FormatExport</h3><p>Exports a file to a specific format. By default, the export format is PDF.</p><p>The main supported formats in the Print Server engine and Crystal Report are:</p><ul><li>RPT</li><li>Word/RTF</li><li>Excel</li><li>PDF</li></ul><p>A default export format is stored for each destination (PREVIEW, EXCEL, PRINT, etc) in the database.</p><pre>
    _FormatExport=29
    CRYSTAL_FORMAT_RPT					1	// Seagate Crystal Reports (RPT)
    CRYSTAL_FORMAT_WORDWIN				3	// Word for Windows
    CRYSTAL_FORMAT_RTF					5	// RTF
    CRYSTAL_FORMAT_TEXT					9	// Text 
    CRYSTAL_FORMAT_EXCEL8TAB			28	// Excel 8 étendu
    CRYSTAL_FORMAT_PDF					29	// PDF
  </pre><p>A default export format is stored for each destination (PREVIEW, EXCEL, PRINT, etc) in the database.</p><p>The default format is linked to a destination is stored in table <code>[SCHEMA].[APRINTER]</code>, field <code>PRTFMT_0</code>:</p><br /><img alt="Print-server destinations" src="../Resources/Images/images_PrintServer-Destinations-02_640x777.png" style="width: 640;height: 777;" /><h3>__DESTINATION</h3><pre xml:space="preserve">
  __DESTINATION=_1 
  CRYSTAL_DESTINATION_WINDOW: 0, 
  CRYSTAL_DESTINATION_PRINTER: 1, 
  CRYSTAL_DESTINATION_MAILMAPI: 2, 
  CRYSTAL_DESTINATION_FILE: 3, 
  CRYSTAL_DESTINATION_MAILVIM: 4, 
  CRYSTAL_DESTINATION_NOTES: 5, 
  CRYSTAL_DESTINATION_EXCHANGEFOLDER: 6
  </pre><h3>__TYPDBA</h3><pre xml:space="preserve">
  __TYPDBA=_2 (ODBCCFG_DB_ORACLE: 1, ODBCCFG_DB_SQLSERVER : 2)
  </pre><h3>__DOCUMENT</h3><p>Manages printing attachments.</p><p>One or several files separated by character ";" can be linked to a report.</p><p><b>Example with two attached documents:</b></p><pre xml:space="preserve">
  __DOCUMENT=_c:\\Sage\\LOCAL95\\dossiers\\SEED\\DEC\\ATTACHED1.pdf;c:\\Sage\\LOCAL95\\dossiers\\SEED\\DEC\\ATTACHED2.pdf"
  </pre><p>These files are printed if <code>destination==Printer</code>. Otherwise, the destination is considered as file, and they are copied to a folder specified in the parameter <code>_ExportFile</code>.</p><h3>_ExportFile</h3><p><code>_ExportFile</code> is linked to the parameter <code>__DOCUMENT</code> to indicate a destination folder for attached documents.</p><p>This value is read only if <code>CRYSTAL_DESTINATION_FILE</code> is set to 3. Otherwise, it will be ignored if the destination is a real printer (CRYSTAL_DESTINATION_PRINTER: 1).</p><p><b>Example:</b></p><pre xml:space="preserve">
  _ExportFile="C:\\Sage\\LOCAL95\\dossiers\\SEED\\EINV\\"
  </pre><p><b>Note:</b> Attached documents specified in the parameter <code>__DOCUMENT</code> will be copied to this folder.</p><h3>_Orientation</h3><pre xml:space="preserve">
  -1 = Default orientation
  1 = PORTRAIT
  2 = LANDSCAPE
  </pre><h3>_PaperSize</h3><p>If destination is a Printer (<code>__DESTINATION=1</code>), this parameter will not be read.</p><p>If it's a real Printer, the parameter <code>_PrinterDescriptionEx</code> is required to exist for <code>_PaperSize</code> to be read.</p><p><b>Note:</b> The parameters <code>_PrinterName</code>, <code>_PrinterServer</code>, <code>_PrinterPort</code>,  <code>_PrinterDescriptionEx</code>,  <code>_Orientation</code>, <code>_PrinterCopies</code> appear only if the destination is a Printer.</p><h3>_PrinterName</h3><p>Specifies the IP adress or hostname of the print.</p><p><b>Example:</b></p><pre>
  \\ser-psafo02\SAGEPRINTER
  </pre><h3>_PrinterServer</h3><p>Specifies the hostname and port where SAGE X3 PrintServer software is available.</p><p>The PrintJob will be sent to this PrintServer.</p><p><b>Example:</b></p><pre>
  vcsx3v11.sagefr.adinternal.com:1890
  </pre><h2 id="PrinterDriver" data-magellan-target="PrinterDriver">_PrinterDriver</h2><p>Specifies the name of the Printer as shown in the list of Printers in Windows.</p><p><b>Example:</b></p><pre>
  _PrinterDriver=KONICA MINOLTA C364SeriesPCL SP
  </pre><h2 id="PrinterPort" data-magellan-target="PrinterPort">_PrinterPort</h2><p>Specifies the authentication protocol to use.</p><p><b>Example:</b></p><pre>
  _PrinterPort=SECURE,SECURE2
  </pre><h2 id="PrinterDescriptionEx" data-magellan-target="PrinterDescriptionEx">_PrinterDescriptionEx</h2><p>Specifies the kind of papersize and cassette to use on the Printer.</p><p><b>Example:</b></p><pre>
  parameter _PrinterDescriptionEx=1|000258|000009||| 
  Pattern : duplex|paper source|paper size|paper height|paper width|
  </pre><h4>Duplex</h4><p>Duplex printing means that you can print on both sides of the paper with your printer either automatically or manually by turning the paper over after the first side has printed.</p><p>To duplex print, your model will need to have the functionality built-in.</p><p>Simplex printing, on the other hand, only allows for printing on one side of the paper.</p><pre>
  empty value, 0 or 1
  1 = Duplex mode is supported by the printer.
  </pre><h4>Paper source</h4><p>Value depends of the Printer and its capabilities.</p><pre>
  -1 : AutoSelect / Default paper source on the printer device.
  XX : Cassette 1
  XX : Cassette 2
  XX : Cassette 3
  </pre><h4>Paper size</h4><pre>
    if value equals -1 or empty = default format paper
    1 = letter US
    8 = A3
    9 = A4
    11 = A5
    256 = defined by the 3 following parameters
  </pre><p><b>Example A:</b></p><pre>
  _PrinterDescriptionEx=1|000258|000009||| 
  Pattern : duplex|paper source|paper size|paper height|paper width|
  </pre><p>This pattern means that:</p><ul><li>The Printer can use the Duplex mode.</li><li>Cassette id 258: This id is different for each Printer.</li><li>09: Paper size A4.</li><li>The next field are empty but characters | are necessary. There are not read because its a standard and predefined size.</li></ul><p><b>Example B:</b></p><pre>
  _PrinterDescriptionEx=1|000258|||| 
  Pattern : duplex|paper source|paper size|paper height|paper width|
  </pre><p>This pattern means that:</p><ul><li>The Printer can use the Duplex mode.</li><li>Cassette id 258: This id is different for each Printer.</li><li>Paper size = empty. That printer will use its default paper size.</li><li>Paper height = empty value. Even if there would be a value, that wont be read because the previous number &lt;&gt; 256.</li><li>Paper width = empty value</li></ul><p><b>Example C:</b></p><pre>
  _PrinterDescriptionEx=1|000258|256|15840|12240| 
  Pattern : duplex|paper source|paper size|paper height|paper width|
  </pre><p>This pattern means that:</p><ul><li>The Printer can use the Duplex mode.</li><li>Cassette id 258: This id is different for each Printer.</li><li>paper size = 256. Means paper size is defined by the 3 following parameters.</li><li>paper height = 15840 twips</li><li>paper width = 12240 twips</li></ul><br /><p><b>Note:</b> Most measurement in Crystal Reports are in twips. A twip is 1/20 of a point or 1/1440 of an inch. There are aproximately 567 twip in a centimeter. This means a standard 8.1/2 x 11 inch sheet of a paper is 12240 x 15840 twips, or  21.6 cm x  27.9 cm.</p><p><b>Full range of values:</b></p><pre xml:space="preserve">
  1  = Letter 8 1/2 x 11 in
  2  = Letter Small 8 1/2 x 11 in
  3  = Tabloid 11 x 17 in
  4  = Ledger 17 x 11 in
  5  = Legal 8 1/2 x 14 in
  6  = Statement 5 1/2 x 8 1/2 in
  7  = Executive 7 1/4 x 10 1/2 in
  8  = A3 297 x 420 mm
  9  = A4 210 x 297 mm
  10 = A4 Small 210 x 297 mm
  11 = A5 148 x 210 mm 
  12 = B4 (JIS) 250 x 354
  13 = B5 (JIS) 182 x 257 mm
  14 = Folio 8 1/2 x 13 in
  15 = Quarto 215 x 275 mm
  16 = 10x14 in
  17 = 11x17 in
  18 = Note 8 1/2 x 11 in
  19 = Envelope #9 3 7/8 x 8 7/8
  20 = Envelope #10 4 1/8 x 9 1/2
  21 = Envelope #11 4 1/2 x 10 3/8
  22 = Envelope #12 4 \276 x 11
  23 = Envelope #14 5 x 11 1/2
  24 = C size sheet
  25 = D size sheet
  26 = E size sheet
  27 = Envelope DL 110 x 220mm
  28 = Envelope C5 162 x 229 mm
  29 = Envelope C3  324 x 458 mm 
  30 = Envelope C4  229 x 324 mm
  31 = Envelope C6  114 x 162 mm
  32 = Envelope C65 114 x 229 mm
  33 = Envelope B4  250 x 353 mm 
  34 = Envelope B5  176 x 250 mm
  35 = Envelope B6  176 x 125 mm
  36 = Envelope 110 x 230 mm 
  37 = Envelope Monarch 3.875 x 7.5 in
  38 = 6 3/4 Envelope 3 5/8 x 6 1/2 in
  39 = US Std Fanfold 14 7/8 x 11 in
  40 = German Std Fanfold 8 1/2 x 12 in
  41 = German Legal Fanfold 8 1/2 x 13 in
  </pre><p>More information on paper sizes can be found on the official documentation on the Microsoft <a href="https://docs.microsoft.com/en-us/windows/win32/intl/paper-sizes">site</a>.</p><p><b>Example:</b></p><br /><img src="../Resources/Images/images_PrintServer-Printer-01.png" /><br /><pre>
  Pattern : duplex|paper source|paper size|paper height|paper width|
  ZEBRA   |000004|000256|000508|001680| 
  </pre><p>It is important to configure the default parameters correctly to be able to use the Printer:</p><br /><img src="../Resources/Images/images_PrintServer-Printer-02.png" /><br /><pre>
    Pattern : duplex|paper source|paper size|paper height|paper width|
    ECT   |000004|||| 
    The value "paper size" is empty, so the Print Server will use the default parameters for the printer and driver.
  </pre><p>The parameter _PrinterDescriptionEx is automatically filled by the Printer an its driver when the printer is created.</p><p>The Print Server request the printer and its driver and the result is created in table <code>APRINTDES</code>.</p><p><b>Exemple of one entry of the table <code>APRINTDES</code>:</b></p><pre>

    See fields <code>[APRINTDES].[PRTDES_0]</code> and <code>[APRINTDES].[PRTDESEX_0]</code>
    
    [X3].[APRINTDES], [UPDTICK_0] [int], [COD_0] [nvarchar](10), [NUM_0] [int],[PRTDES_0] [nvarchar](250), [PRTDES_1] [nvarchar](250), [CREUSR_0] [nvarchar](5),	[UPDUSR_0] [nvarchar](5),	[CREDATTIM_0] [datetime],	[UPDDATTIM_0] [datetime],	[AUUID_0] [binary](16),	[PRTDESEX_0] [nvarchar](100),	[ROWID] [numeric](38, 0),
    1	IMPRIM	1	5C005C00730061006700650069006D0070005C004C0049004C00410053000000/*00740000006500200064006500200050007200/*0074002C004C006F00000001040006.,00-,1F430/)!070100090000000000640001000F005802010001005802030000004100340000000000000	 	XPSB	XPSB	2015-07-24 17:16:25.000	2015-07-24 17:16:25.000	&lt;Binary data&gt;	3|000257|000009|||	29
    
  </pre><h3>_PrinterCopies</h3><p>Number of copies of the document to print. Default value = 1.</p><h3>_PrinterCollate</h3><p>Collated printing refers to how prints are arranged as they print, and is useful if you are printing more than one large document that needs to be kept in the right order. Default value = 0.</p><p>When a file is too big and needs to be printed across several pages, collated printing will give you page after page and sheet of paper after sheet of paper, while respecting the original series of the pages in the document.</p><p>Collating documents creates consistency. For example, if you have a document that is five pages long and you wanted to print multiple copies, collating enables it to print pages 1,2,3,4 and 5 in the correct order and then repeat this again if you need more than one copy.</p><h3>_PrinterStartPage</h3><p>First page to print. Default value = 1.</p><h3>_PrinterStopPage</h3><p>Default value = 9999.</p></div>
                                            <div data-mc-conditions="Other.Production only">
                                                <div id="feedback-survey">
                                                    <div class="feedback-question">
                                                        <h4>Did you find this helpful?</h4>
                                                        <p>
                                                            <button class="feedback-button feedback-yes" title="Yes, this article was helpful." alt="Yes, this article was helpful.">Yes</button>&#160;<button class="feedback-button feedback-no" title="No, this article wasn't helpful." alt="No, this article wasn't helpful.">No</button></p>
                                                    </div>
                                                    <div class="feedback-reason no">
                                                        <hr />
                                                        <div class="highlightBox">
                                                            <h4>Sorry about that</h4>
                                                            <p>Why wasn't this helpful? (check all that apply)</p>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option1" value="Couldn't find what I was looking for" data-analytics-label="Could not find" />
                                                                <label for="option1">Couldn't find what I was looking for</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option2" value="Instructions confusing or unclear" data-analytics-label="Confusing or unclear" />
                                                                <label for="option2">Instructions confusing or unclear</label>
                                                            </div>
                                                            <div class="feedback-option">
                                                                <input type="checkbox" class="option no" id="option3" value="Instructions didn't work" data-analytics-label="Did not work" />
                                                                <label for="option3">Instructions didn't work</label>
                                                            </div>
                                                            <div class="feedback-reason no-thanks">
                                                                <p><b>Thanks for your feedback.</b>
                                                                </p>
                                                                <h4>Want to tell us more?</h4>
                                                                <p>Send an email to our authors to leave your feedback.</p>
                                                                <!--email_off-->
                                                                <p><a href="mailto:Sage200TechnicalAuthors@sage.com?subject=Sage 200 feedback" id="feedbackEmailLink" title="Tell us if there's a problem with the information on this page." alt="Tell us if there's a problem with the information on this page." class="sageButton">Email our authors</a>
                                                                </p>
                                                                <!--/email_off-->
                                                                <p>Sorry, but we can't provide technical support from this email address. If you need assistance, then please contact our support team directly.</p>
                                                            </div>
                                                        </div>
                                                        <div id="get-in-touch" class="highlightBox colour-dark-1">
                                                            <h4>Need support?</h4>
                                                            <p>You can contact our support team on <b>0845 111 5555</b>, 9am-5pm Monday-Friday.</p>
                                                        </div>
                                                    </div>
                                                    <div class="feedback-reason yes-thanks">
                                                        <hr />
                                                        <h4>Great!</h4>
                                                        <p>Thanks for taking the time to give us some feedback.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sage-layout-topic-panel">
                                            <div class="menu-topic-container" id="menu-on-page">
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_Sage_Menu_Topic_TopNav mc-component">
                                                    <li><a href="#PrintServerPresentationandOperationGuide"> Print Server Presentation and Operation Guide
  </a>
                                                    </li>
                                                    <li><a href="#InstallationUninstallation">Installation / Uninstallation</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Prerequisites">Prerequisites</a>
                                                        </li>
                                                        <li><a href="#Installation">Installation</a>
                                                        </li>
                                                        <li><a href="#Uninstallation">Uninstallation</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Configuration">Configuration</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Startupsetup">Startup setup</a>
                                                        </li>
                                                        <li><a href="#ParametersforthedescriptionoftheattachedSAFEX3solutions">Parameters for the description of the attached SAFE X3 solutions</a>
                                                        </li>
                                                        <li><a href="#Advancedsettings">Advanced settings</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Serverstartupstop">Server startup / stop</a>
                                                    </li>
                                                    <li><a href="#Monitoring">Monitoring</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Monitoringwindow">Monitoring window</a>
                                                        </li>
                                                        <li><a href="#MonitoringServiceREST">Monitoring: Service REST</a>
                                                        </li>
                                                        <li><a href="#Activitylogfileandexceptionlogfile">Activity log file and exception log file</a>
                                                        </li>
                                                        <li><a href="#WindowsEventsViewer">Windows Events Viewer</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Technicalarchitecture">Technical architecture</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Principles">Principles</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Printermanagementanderrorlists">Printer management and error lists</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Errorcodesandmessages">Error codes and messages</a>
                                                        </li>
                                                    </ul>
                                                    <li><a href="#Supportandtroubleshooting">Support and troubleshooting</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Printermanagement">Printer management</a>
                                                        </li>
                                                        <li><a href="#Cannotdetectpreviousinstalledversionafterasetupcrash">Cannot detect previous installed version after a setup crash</a>
                                                        </li>
                                                        <li><a href="#NoinstalledPrinter">No installed Printer</a>
                                                        </li>
                                                        <li><a href="#Activationofthelogfiles">Activation of the log files</a>
                                                        </li>
                                                        <li><a href="#EnablelogsinSAPVSStudioCrystalReport">Enable logs in SAP VS Studio Crystal Report</a>
                                                        </li>
                                                        <li><a href="#FontsizereducedwhenexportingtoPDF">Font size reduced when exporting to PDF</a>
                                                        </li>
                                                        <li><a href="#ChinesecharactersnotcorrectlydisplayedinPDF">Chinese characters not correctly displayed in PDF</a>
                                                        </li>
                                                        <li><a href="#SpecialfontsembeddedinPDFdocuments">Special fonts embedded in PDF documents</a>
                                                        </li>
                                                        <li><a href="#UserfunctionLibrariesU212LTextdllandU212ltoword">User function Libraries U212LText.dll and U212ltoword</a>
                                                        </li>
                                                        <li><a href="#ParameterssenttothePrintServer">Parameters sent to the Print Server</a>
                                                        </li>
                                                        <li><a href="#PrinterDriver">_PrinterDriver</a>
                                                        </li>
                                                        <li><a href="#PrinterPort">_PrinterPort</a>
                                                        </li>
                                                        <li><a href="#PrinterDescriptionEx">_PrinterDescriptionEx</a>
                                                        </li>
                                                    </ul>
                                                </ul>
                                            </div>
                                        </div>
                                    </section>
                                    <button class="go-to-top">
                                        <!-- icon and label are inserted -->
                                    </button>
                                    <section class="sage-footer colour-dark-1" id="footer" role="contentinfo">
                                        <div class="row">
                                            <div class="small-6 medium-3 columns">
                                                <h5>Site links</h5>
                                                <p><a href="../Sitemap.htm" class="MCXref xref">Sitemap</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage links</h5>
                                                <p><a href="https://my.sage.co.uk/public/help.aspx" target="_blank" class="external">Sage Support Hub</a>
                                                </p>
                                                <p><a href="https://communities.sage.co.uk/product_support_community/" class="external" target="_blank" title="Your place to get product support from other customers and Sage experts" alt="Your place to get product support from other customers and Sage experts">Product support community</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/gdpr/" class="external" target="_blank">General Data Protection Regulation</a>
                                                </p>
                                                <p><a href="https://www.sage.com/en-gb/legal/" class="external" target="_blank">Legal information</a>
                                                </p>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Page info</h5>
                                                <p>Page updated: <span class="mc-variable Dates.DateFileSaved variable">26 febrero 2024</span></p>
                                                <!-- script moves last published date to here -->
                                                <div id="last-published-footer">
                                                </div>
                                            </div>
                                            <div class="small-6 medium-3 columns">
                                                <h5>Sage media</h5>
                                                <p><a href="https://www.facebook.com/sageuk" target="_blank" alt="Find us on Facebook" title="Find us on Facebook"><i class="fa fa-lg fa-facebook" aria-hidden="true"></i></a>&#160;
						<a href="https://www.linkedin.com/company/sage-software" target="_blank" alt="Find us on LinkedIn" title="Find us on LinkedIn"><i class="fa fa-lg fa-linkedin" aria-hidden="true"></i></a>&#160;
						<a href="https://twitter.com/sageuk/" target="_blank" alt="Find us on Twitter" title="Find us on Twitter"><i class="fa fa-lg fa-twitter" aria-hidden="true"></i></a>&#160;
						<a href="https://www.youtube.com/user/SageUKOfficial" target="_blank" alt="Find us on YouTube" title="Find us on YouTube"><i class="fa fa-lg fa-youtube" aria-hidden="true"></i></a></p>
                                            </div>
                                        </div>
                                    </section>
                                    <!-- Skin type scripts -->
                                    <script type="text/javascript" src="../Resources/Scripts/SideNav-template.js" data-mc-conditions="Other.HTML5-SideNav">
                                    </script>
                                    <!-- Google Analytics -->
                                    <div data-mc-conditions="Other.Production only">
                                        <!-- Google analytics script -->
                                        <!-- Copy and paste full HTML of tracking code here for Global site tag (gtag.js) -->
                                        <!-- Remember to edit 'async' parameter to read async="" -->
                                        <!-- Analytics for events -->
                                        <script type="text/javascript" src="../Resources/Scripts/google-analytics-events.js">
                                        </script>
                                    </div>
                                    <!-- cookies -->
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.js">
                                    </script>
                                    <script src="../Resources/Scripts/jquery.cookiesdirective.sage.config.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>